<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <meta name="robots" content="noindex,nofollow,noarchive" />
    <meta name="referrer" content="no-referrer" />

    <script>
      MathJax = {
        chtml: {
          displayAlign: "left",
          displayIndent: "1em",
        },
      };
    </script>

    

    <link rel="icon" href="favicon.ico" sizes="any" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
      integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c"
    />
    <link rel="stylesheet" href="style.css" />

    <title>第05回 3I-プログラミング3</title>
  </head>

  <body>
    <div class="openbtn"><span></span><span></span><span></span></div>
    <nav id="g-nav">
      <div id="g-nav-list">
        <!-- ---------------------------------------- -->
         <ul>
<li><a href="#連絡" id="toc-連絡"><span
class="toc-section-number">1</span> 連絡</a>
<ul>
<li><a href="#情報提供" id="toc-情報提供"><span
class="toc-section-number">1.1</span> 情報提供</a></li>
<li><a href="#ここまでの流れ" id="toc-ここまでの流れ"><span
class="toc-section-number">1.2</span> ここまでの流れ</a></li>
</ul></li>
<li><a href="#新規タスクの追加" id="toc-新規タスクの追加"><span
class="toc-section-number">2</span> 新規タスクの追加</a>
<ul>
<li><a href="#動作確認" id="toc-動作確認"><span
class="toc-section-number">2.1</span> 動作確認</a></li>
<li><a href="#ng-todos配列に対するミュータブルな操作"
id="toc-ng-todos配列に対するミュータブルな操作"><span
class="toc-section-number">2.2</span> NG:
Todos配列に対するミュータブルな操作</a></li>
</ul></li>
<li><a href="#新規タスクの名前設定テキストボックスの追加"
id="toc-新規タスクの名前設定テキストボックスの追加"><span
class="toc-section-number">3</span>
新規タスクの名前設定テキストボックスの追加</a>
<ul>
<li><a href="#ユーザによるui操作と状態更新の対応付け"
id="toc-ユーザによるui操作と状態更新の対応付け"><span
class="toc-section-number">3.1</span>
ユーザによるUI操作と状態更新の対応付け</a></li>
<li><a href="#ラベルタグの設定" id="toc-ラベルタグの設定"><span
class="toc-section-number">3.2</span> ラベルタグの設定</a></li>
</ul></li>
<li><a href="#優先度を設定するラジオボタンの追加"
id="toc-優先度を設定するラジオボタンの追加"><span
class="toc-section-number">4</span>
優先度を設定するラジオボタンの追加</a>
<ul>
<li><a href="#補足-onchange属性の設定"
id="toc-補足-onchange属性の設定"><span
class="toc-section-number">4.1</span> 補足: onChange属性の設定</a></li>
<li><a href="#補足-mapを使用せずにラジオボタンを構成する例"
id="toc-補足-mapを使用せずにラジオボタンを構成する例"><span
class="toc-section-number">4.2</span> 補足:
mapを使用せずにラジオボタンを構成する例</a></li>
<li><a href="#ラジオボタンのラベルに任意の値を使用する方法"
id="toc-ラジオボタンのラベルに任意の値を使用する方法"><span
class="toc-section-number">4.3</span>
ラジオボタンのラベルに任意の値を使用する方法</a></li>
</ul></li>
<li><a href="#期限を設定する日時設定uiの追加"
id="toc-期限を設定する日時設定uiの追加"><span
class="toc-section-number">5</span> 期限を設定する日時設定UIの追加</a>
<ul>
<li><a href="#日時情報の更新-uiコード"
id="toc-日時情報の更新-uiコード"><span
class="toc-section-number">5.1</span> 日時情報の更新
(UI→コード)</a></li>
<li><a href="#日時情報の更新-コードui"
id="toc-日時情報の更新-コードui"><span
class="toc-section-number">5.2</span> 日時情報の更新
(コード→UI)</a></li>
<li><a href="#truthyな値とfalsyな値"
id="toc-truthyな値とfalsyな値"><span
class="toc-section-number">5.3</span>
「truthyな値」と「falsyな値」</a></li>
</ul></li>
<li><a href="#バリデーション" id="toc-バリデーション"><span
class="toc-section-number">6</span> バリデーション</a>
<ul>
<li><a href="#補足-react-hook-form-と-zod"
id="toc-補足-react-hook-form-と-zod"><span
class="toc-section-number">6.1</span> 補足: React Hook Form と
Zod</a></li>
</ul></li>
<li><a href="#既存todoの-完了未完了-の切り替え"
id="toc-既存todoの-完了未完了-の切り替え"><span
class="toc-section-number">7</span> 既存Todoの 完了/未完了
の切り替え</a>
<ul>
<li><a href="#ng実装ミュータブルな操作でオブジェクト配列の要素を変更"
id="toc-ng実装ミュータブルな操作でオブジェクト配列の要素を変更"><span
class="toc-section-number">7.1</span>
NG実装：ミュータブルな操作でオブジェクト配列の要素を変更</a></li>
<li><a href="#完了済みのタスクを削除するボタンの追加"
id="toc-完了済みのタスクを削除するボタンの追加"><span
class="toc-section-number">7.2</span>
完了済みのタスクを削除するボタンの追加</a></li>
</ul></li>
<li><a href="#タスクの個別削除" id="toc-タスクの個別削除"><span
class="toc-section-number">8</span> タスクの個別削除</a></li>
<li><a href="#リファクタリング-コンポーネントに分割"
id="toc-リファクタリング-コンポーネントに分割"><span
class="toc-section-number">9</span> リファクタリング:
コンポーネントに分割</a></li>
<li><a href="#localstorageを利用したデータの永続化"
id="toc-localstorageを利用したデータの永続化"><span
class="toc-section-number">10</span>
LocalStorageを利用したデータの永続化</a>
<ul>
<li><a href="#localstorage-とは" id="toc-localstorage-とは"><span
class="toc-section-number">10.1</span> LocalStorage とは</a></li>
<li><a href="#localstorage-を利用した保存機能の実装"
id="toc-localstorage-を利用した保存機能の実装"><span
class="toc-section-number">10.2</span> LocalStorage
を利用した保存機能の実装</a></li>
</ul></li>
<li><a href="#reactアプリを-github-pages-にデプロイする手順"
id="toc-reactアプリを-github-pages-にデプロイする手順"><span
class="toc-section-number">11</span> Reactアプリを GitHub Pages
にデプロイする手順</a>
<ul>
<li><a href="#準備" id="toc-準備"><span
class="toc-section-number">11.1</span> 準備</a></li>
<li><a href="#初回設定" id="toc-初回設定"><span
class="toc-section-number">11.2</span> 初回設定</a></li>
<li><a href="#github-pages-の設定" id="toc-github-pages-の設定"><span
class="toc-section-number">11.3</span> GitHub Pages の設定</a></li>
<li><a href="#index.html-の編集と-404.html-の追加"
id="toc-index.html-の編集と-404.html-の追加"><span
class="toc-section-number">11.4</span> index.html の編集と 404.html
の追加</a></li>
<li><a href="#各種設定ファイルの変更"
id="toc-各種設定ファイルの変更"><span
class="toc-section-number">11.5</span> 各種設定ファイルの変更</a></li>
<li><a href="#発行-publish" id="toc-発行-publish"><span
class="toc-section-number">11.6</span> 発行 Publish</a></li>
</ul></li>
<li><a href="#課題1" id="toc-課題1"><span
class="toc-section-number">12</span> 課題1</a></li>
</ul> 
        <!-- ---------------------------------------- -->
      </div>
    </nav>

    <header class="markdown-body">
      <p>2024-3I プログラミング3 第05回 講義資料</p>
      <p>2024年10月31日（木）1・2時限 ハロウィン🎃</p>
    </header>

    <main class="markdown-body">
      <!-- ---------------------------------------- -->
      <h1 data-number="1" id="連絡"><span
      class="header-section-number">1</span> 連絡</h1>
      <h2 data-number="1.1" id="情報提供"><span
      class="header-section-number">1.1</span> 情報提供</h2>
      <ul>
      <li><a
      href="https://news.yahoo.co.jp/articles/f752a2040e8bc9603576f174a12e7a05ec670f84">「次の電車間に合う？」がわかる運行掲示板、学生が1万円で作った！大学に設置、職員にも好評</a><span
      class="citation" data-cites="Yahoo">@Yahoo</span>!News
      <ul>
      <li>技術的には皆さんでも十分に開発可能だと思います。アイデアは積極的にカタチにして行動していきましょう。</li>
      </ul></li>
      </ul>
      <h2 data-number="1.2" id="ここまでの流れ"><span
      class="header-section-number">1.2</span> ここまでの流れ</h2>
      <p>本科目は学修単位科目です。<strong>1回の授業あたり、皆さんが「4時間相当の授業時間外学習」をすることを前提</strong>
      としたボリュームと展開速度となっています。1週間の間隔をあけての90分だけの取り組みで理解・習得できる内容ではないので注意してください。</p>
      <p>初回授業から後期中間試験ぐらいまでの授業の流れ</p>
      <ol type="1">
      <li>モダンTypeScript基礎学習のための環境構築
      <strong><em>済</em></strong></li>
      <li>TypeScript基礎学習 <strong><em>済</em></strong>
      <ul>
      <li>React / Next.js
      開発に関連する文法や機能だけを集中的に学びました。</li>
      </ul></li>
      <li>Reactを使ったTodoアプリのための環境構築
      <strong><em>済</em></strong></li>
      <li>Todoアプリ開発（Reactによるフロントエンド開発）のチュートリアル
      <strong>← 今回の授業</strong></li>
      <li>Todoアプリのカスタマイズや作り込み →
      <strong><em>課題1</em></strong>
      <ul>
      <li>詳細は<a href="lecture05.html#課題1">こちら</a>を参照。</li>
      </ul></li>
      </ol>
      <h1 data-number="2" id="新規タスクの追加"><span
      class="header-section-number">2</span> 新規タスクの追加</h1>
      <p>現在のTodoリストに「<strong>新しいタスク (Todo)
      を追加する処理</strong>」を実装します。</p>
      <p><code>src/App.tsx</code>
      が、次のようなコードになっていることを前提に解説します。もし、<code>src/App.tsx</code>
      をカスタマイズしている場合は、一旦、退避させて以下のコードを使用して実験してください。</p>
      <div class="sourceCode" id="cb1" data-caption="src/App.tsx"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> { useState } <span class="im">from</span> <span class="st">&quot;react&quot;</span><span class="op">;</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> { Todo } <span class="im">from</span> <span class="st">&quot;./types&quot;</span><span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> { initTodos } <span class="im">from</span> <span class="st">&quot;./initTodos&quot;</span><span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> WelcomeMessage <span class="im">from</span> <span class="st">&quot;./WelcomeMessage&quot;</span><span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> TodoList <span class="im">from</span> <span class="st">&quot;./TodoList&quot;</span><span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">const</span> App <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb1-8"><a href="#cb1-8"></a>  <span class="kw">const</span> [todos<span class="op">,</span> setTodos] <span class="op">=</span> <span class="fu">useState</span><span class="op">&lt;</span>Todo[]<span class="op">&gt;</span>(initTodos)<span class="op">;</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>  <span class="kw">const</span> uncompletedCount <span class="op">=</span> todos<span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb1-10"><a href="#cb1-10"></a>    (todo<span class="op">:</span> Todo) <span class="kw">=&gt;</span> <span class="op">!</span>todo<span class="op">.</span><span class="at">isDone</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>  )<span class="op">.</span><span class="at">length</span><span class="op">;</span> <span class="co">// 未完了タスクの数え上げ</span></span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a>  <span class="cf">return</span> (</span>
<span id="cb1-14"><a href="#cb1-14"></a>    <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;mx-4 mt-10 max-w-2xl md:mx-auto&quot;</span><span class="op">&gt;</span></span>
<span id="cb1-15"><a href="#cb1-15"></a>      <span class="op">&lt;</span>h1 className<span class="op">=</span><span class="st">&quot;mb-4 text-2xl font-bold&quot;</span><span class="op">&gt;</span>TodoApp<span class="op">&lt;/</span>h1<span class="op">&gt;</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>      <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;mb-4&quot;</span><span class="op">&gt;</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>        <span class="op">&lt;</span>WelcomeMessage</span>
<span id="cb1-18"><a href="#cb1-18"></a>          name<span class="op">=</span><span class="st">&quot;寝屋川タヌキ&quot;</span></span>
<span id="cb1-19"><a href="#cb1-19"></a>          uncompletedCount<span class="op">=</span>{uncompletedCount}</span>
<span id="cb1-20"><a href="#cb1-20"></a>        <span class="op">/&gt;</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>      <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>      <span class="op">&lt;</span>TodoList todos<span class="op">=</span>{todos} <span class="op">/&gt;</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>    <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb1-24"><a href="#cb1-24"></a>  )<span class="op">;</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>}<span class="op">;</span></span>
<span id="cb1-26"><a href="#cb1-26"></a></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="im">export</span> <span class="im">default</span> App<span class="op">;</span></span></code></pre></div>
      <p>いまから、このページの下部に「<strong>追加</strong>」というボタンを作成します。そして、<strong>ユーザーがそのボタンを押下したとき</strong>に…</p>
      <ol type="1">
      <li>新しいTodoオブジェクト <code>newTodo</code> を生成する。</li>
      <li>現在のTodo配列 <code>todos</code> の末尾に
      <code>newTodo</code> を追加した<strong>新しいTodo配列</strong>
      <code>newTodos</code> を生成する。
      <ul>
      <li>ここで<a
      href="lecture03.html#要素の追加-イミュータブルな変更">イミュータブルな配列操作</a>を使うことがポイントです。</li>
      </ul></li>
      <li>状態を変更する関数 <code>setTodos</code> に
      <code>newTodos</code> を与える (React的な作法に則って状態を更新)
      <ul>
      <li><code>setTodos</code> は上記プログラムの
      <strong>第08行目</strong> で <code>useState</code>
      によって生成されたものです。</li>
      </ul></li>
      </ol>
      <p>以上の手順でTodoリストを更新し、<span
      class="masked">適切に画面が再レンダリング</span> されるように
      <code>src/App.tsx</code>
      をアップデートしていきます。具体的には、次のように実装します。</p>
      <div class="sourceCode" id="cb2"
      data-caption="src/App.tsx (Todoの追加を実装)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> { useState } <span class="im">from</span> <span class="st">&quot;react&quot;</span><span class="op">;</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">import</span> { Todo } <span class="im">from</span> <span class="st">&quot;./types&quot;</span><span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="im">import</span> { initTodos } <span class="im">from</span> <span class="st">&quot;./initTodos&quot;</span><span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="im">import</span> WelcomeMessage <span class="im">from</span> <span class="st">&quot;./WelcomeMessage&quot;</span><span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="im">import</span> TodoList <span class="im">from</span> <span class="st">&quot;./TodoList&quot;</span><span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="im">import</span> { v4 <span class="im">as</span> uuid } <span class="im">from</span> <span class="st">&quot;uuid&quot;</span><span class="op">;</span> <span class="co">// ◀◀ 追加</span></span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="kw">const</span> App <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb2-9"><a href="#cb2-9"></a>  <span class="kw">const</span> [todos<span class="op">,</span> setTodos] <span class="op">=</span> <span class="fu">useState</span><span class="op">&lt;</span>Todo[]<span class="op">&gt;</span>(initTodos)<span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>  <span class="kw">const</span> uncompletedCount <span class="op">=</span> todos<span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb2-11"><a href="#cb2-11"></a>    (todo<span class="op">:</span> Todo) <span class="kw">=&gt;</span> <span class="op">!</span>todo<span class="op">.</span><span class="at">isDone</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>  )<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb2-13"><a href="#cb2-13"></a></span>
<span id="cb2-14"><a href="#cb2-14"></a>  <span class="co">// 追加: addNewTodo関数の実装</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>  <span class="kw">const</span> addNewTodo <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb2-16"><a href="#cb2-16"></a>    <span class="kw">const</span> newTodo<span class="op">:</span> Todo <span class="op">=</span> {</span>
<span id="cb2-17"><a href="#cb2-17"></a>      id<span class="op">:</span> <span class="fu">uuid</span>()<span class="op">,</span></span>
<span id="cb2-18"><a href="#cb2-18"></a>      name<span class="op">:</span> <span class="st">&quot;新しいタスク&quot;</span><span class="op">,</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>      isDone<span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb2-20"><a href="#cb2-20"></a>      priority<span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb2-21"><a href="#cb2-21"></a>      deadline<span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2024</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">13</span>)<span class="op">,</span></span>
<span id="cb2-22"><a href="#cb2-22"></a>    }<span class="op">;</span></span>
<span id="cb2-23"><a href="#cb2-23"></a>    <span class="co">// スプレッド構文を使って、末尾に新タスクを追加した配列を作成</span></span>
<span id="cb2-24"><a href="#cb2-24"></a>    <span class="kw">const</span> updatedTodos <span class="op">=</span> [<span class="op">...</span>todos<span class="op">,</span> newTodo]<span class="op">;</span></span>
<span id="cb2-25"><a href="#cb2-25"></a>    <span class="fu">setTodos</span>(updatedTodos)<span class="op">;</span> <span class="co">// 作成した配列をtodosにセット</span></span>
<span id="cb2-26"><a href="#cb2-26"></a>  }<span class="op">;</span></span>
<span id="cb2-27"><a href="#cb2-27"></a></span>
<span id="cb2-28"><a href="#cb2-28"></a>  <span class="cf">return</span> (</span>
<span id="cb2-29"><a href="#cb2-29"></a>    <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;mx-4 mt-10 max-w-2xl md:mx-auto&quot;</span><span class="op">&gt;</span></span>
<span id="cb2-30"><a href="#cb2-30"></a>      <span class="op">&lt;</span>h1 className<span class="op">=</span><span class="st">&quot;mb-4 text-2xl font-bold&quot;</span><span class="op">&gt;</span>TodoApp<span class="op">&lt;/</span>h1<span class="op">&gt;</span></span>
<span id="cb2-31"><a href="#cb2-31"></a>      <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;mb-4&quot;</span><span class="op">&gt;</span></span>
<span id="cb2-32"><a href="#cb2-32"></a>        <span class="op">&lt;</span>WelcomeMessage</span>
<span id="cb2-33"><a href="#cb2-33"></a>          name<span class="op">=</span><span class="st">&quot;寝屋川タヌキ&quot;</span></span>
<span id="cb2-34"><a href="#cb2-34"></a>          uncompletedCount<span class="op">=</span>{uncompletedCount}</span>
<span id="cb2-35"><a href="#cb2-35"></a>        <span class="op">/&gt;</span></span>
<span id="cb2-36"><a href="#cb2-36"></a>      <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb2-37"><a href="#cb2-37"></a>      <span class="op">&lt;</span>TodoList todos<span class="op">=</span>{todos} <span class="op">/&gt;</span></span>
<span id="cb2-38"><a href="#cb2-38"></a></span>
<span id="cb2-39"><a href="#cb2-39"></a>      {<span class="co">/* タスク追加関連のUI実装 ここから... */</span>}</span>
<span id="cb2-40"><a href="#cb2-40"></a>      <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;mt-5 space-y-2 rounded-md border p-3&quot;</span><span class="op">&gt;</span></span>
<span id="cb2-41"><a href="#cb2-41"></a>        <span class="op">&lt;</span>h2 className<span class="op">=</span><span class="st">&quot;text-lg font-bold&quot;</span><span class="op">&gt;</span>新しいタスクの追加<span class="op">&lt;/</span>h2<span class="op">&gt;</span></span>
<span id="cb2-42"><a href="#cb2-42"></a>        <span class="op">&lt;</span>button</span>
<span id="cb2-43"><a href="#cb2-43"></a>          <span class="kw">type</span><span class="op">=</span><span class="st">&quot;button&quot;</span></span>
<span id="cb2-44"><a href="#cb2-44"></a>          onClick<span class="op">=</span>{addNewTodo} <span class="co">// ボタンを押下したときの処理</span></span>
<span id="cb2-45"><a href="#cb2-45"></a>          className<span class="op">=</span><span class="st">&quot;rounded-md bg-indigo-500 px-3 py-1 font-bold text-white hover:bg-indigo-600&quot;</span></span>
<span id="cb2-46"><a href="#cb2-46"></a>        <span class="op">&gt;</span></span>
<span id="cb2-47"><a href="#cb2-47"></a>          追加</span>
<span id="cb2-48"><a href="#cb2-48"></a>        <span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb2-49"><a href="#cb2-49"></a>      <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb2-50"><a href="#cb2-50"></a>      {<span class="co">/* ...ここまで */</span>}</span>
<span id="cb2-51"><a href="#cb2-51"></a>      </span>
<span id="cb2-52"><a href="#cb2-52"></a>    <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb2-53"><a href="#cb2-53"></a>  )<span class="op">;</span></span>
<span id="cb2-54"><a href="#cb2-54"></a>}<span class="op">;</span></span>
<span id="cb2-55"><a href="#cb2-55"></a></span>
<span id="cb2-56"><a href="#cb2-56"></a><span class="im">export</span> <span class="im">default</span> App<span class="op">;</span></span></code></pre></div>
      <p>上記のプログラムでは、<strong>新しいタスクを追加するための「addNewTodo」という関数</strong>を
      <strong>第15～26行</strong>
      にアロー関数形式で実装しています。JavaScript (TypeScript) では、<a
      href="https://www.google.com/search?q=プログラム+クロージャとは">クロージャ</a>という仕組みによって
      <span
      class="masked">「関数のなかに定義される関数の内部で、親となる関数が持つ変数にアクセスすることが可能」</span>
      となっています。ここで「<strong>関数
      addNewTodo</strong>」は「<strong>関数App</strong>」の内部で定義されているため、<strong>第24行目</strong>
      のように <strong>addNewTodo関数の外側にある変数</strong>
      <code>todos</code>
      の参照が可能になっています。なお、<strong>Python</strong>
      にもクロージャの仕組みがありますが、<strong>C言語</strong>ではクロージャは利用できません
      (そもそもC言語では、関数内部に関数を定義することができません)。</p>
      <p>UIに関連したものとしては
      <strong>第40行目</strong>～<strong>第49行目</strong>
      にJSX要素を追加しています。特に <strong>第44行目</strong> の
      <code>onClick={addNewTodo}</code>
      によって、ボタンがクリックしたときに <strong>第15行目</strong>
      の「addNewTodo関数」が呼び出されるようになっている点に注目してください。なお、ここで
      <span class="masked"><code>onClick={addNewTodo()}</code></span>
      とすると間違いが多いので注意してください。もし、両者の違いが分からないときは生成AIを使って解決してください。</p>
      <p><strong>(プロンプト例)</strong></p>
      <blockquote>
      <p>TypeScript環境のReactで「Todoアプリ」を開発しています。ボタンを押下したとき
      に <code>addNewTodo</code> という関数 (引数なし)
      を実行したいです。このようなときは、ボタンの属性を
      <code>onClick={addNewTodo}</code>
      のように設定すると習いました。なぜ、<code>onClick={addNewTodo()}</code>
      のように書かないのですか？</p>
      </blockquote>
      <h2 data-number="2.1" id="動作確認"><span
      class="header-section-number">2.1</span> 動作確認</h2>
      <p><code>src/App.tsx</code> を更新・保存して、開発モード
      (<code>npm run dev</code>)
      でアプリを実行してください。以下の図ように「<strong>追加</strong>」ボタンを押下するたびに、<strong>リスト末尾</strong>に「新しいタスク」が追加されていくことが確認できます。</p>
      <figure>
      <img src="figs/05/app_02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>※ 実際の実行画面 (Todoリストの外観)
      は「<strong>TodoListコンポーネント</strong>
      (<code>src/TodoList.tsx</code>)」の実装によって変化します。<a
      href="lecture04.html#演習-宿題-120分">前回講義の宿題</a>として、TodoListコンポーネントをカスタマイズしてもらっているので、実行画面の外観は各々で異なるはずです。</p>
      <p>※ Todoリストの初期値 (<code>src/initTodos.ts</code>) は <a
      href="https://github.com/TakeshiWada1980/Programming3-2024/blob/main/docs/codes/05/code03.ts">こちら<i class="fa-solid fa-person-chalkboard"></i></a>を使用しています。</p>
      <div class="note type-caution">
      <p><strong>注意</strong></p>
      <p>前回講義の<a
      href="lecture04.html#演習-3">演習</a>の一環で、<code>TodoList.tsx</code>
      の内部で次のように <code>todos</code> の
      <strong>並び替え処理</strong> を実装している場合は、、、</p>
      <div class="sourceCode" id="cb3"
      data-caption="src/TodoList.tsx (抜粋・変更前)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">// 優先度順に todos を並び替え</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">const</span> todos <span class="op">=</span> [<span class="op">...</span>props<span class="op">.</span><span class="at">todos</span>]<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a<span class="op">.</span><span class="at">priority</span> <span class="op">-</span> b<span class="op">.</span><span class="at">priority</span>)<span class="op">;</span></span></code></pre></div>
      <p>一時的に、<strong>並び替えを無効</strong>にしておいてください
      (initTodosの順番に表示されるようにしておいてください)。</p>
      <div class="sourceCode" id="cb4"
      data-caption="src/TodoList.tsx (抜粋・変更後)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">// const todos = [...props.todos].sort((a, b) =&gt; a.priority - b.priority);</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">const</span> todos <span class="op">=</span> props<span class="op">.</span><span class="at">todos</span><span class="op">;</span></span></code></pre></div>
      </div>
      <h3 data-number="2.1.1" id="演習-3分"><span
      class="header-section-number">2.1.1</span> 演習
      <i class="fa-solid fa-stopwatch"></i>3分</h3>
      <ul>
      <li>新規タスクをTodoリストの「<strong>末尾</strong>」ではなく「<strong>先頭</strong>」に追加するように変更してください。
      <ul>
      <li><strong>答え</strong> <span
      class="masked"><code>const updatedTodos = [...todos, newTodo]</code>
      を <code>const updatedTodos = [newTodo, ...todos]</code>
      に変更</span></li>
      </ul></li>
      </ul>
      <p>確認後は、元に戻しておいてください
      (「末尾」に新規タスクを追加するように戻しておいてください)。</p>
      <h2 data-number="2.2"
      id="ng-todos配列に対するミュータブルな操作"><span
      class="header-section-number">2.2</span> NG:
      Todos配列に対するミュータブルな操作</h2>
      <p>理解を深めるために<a
      href="lecture03.html#参考-要素の追加と削除-ミュータブルな配列操作">ミュータブルな配列操作</a>を使って
      <code>todos</code> を更新するとどうなるか?
      について実験・確認しておきます。ミュータブルな操作を使って
      <code>addNewTodo</code> を実装した例を以下に示します。特に
      <strong>第09行目</strong> に着目してください。</p>
      <div class="sourceCode" id="cb5"
      data-caption="src/App.tsx (抜粋・Todo追加のNG実装)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">const</span> addNewTodo <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="kw">const</span> newTodo<span class="op">:</span> Todo <span class="op">=</span> {</span>
<span id="cb5-3"><a href="#cb5-3"></a>    id<span class="op">:</span> <span class="fu">uuid</span>()<span class="op">,</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>    name<span class="op">:</span> <span class="st">&quot;新しいタスク&quot;</span><span class="op">,</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>    isDone<span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>    priority<span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>    deadline<span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2024</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">13</span>)<span class="op">,</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>  }<span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  todos<span class="op">.</span><span class="fu">push</span>(newTodo)<span class="op">;</span> <span class="co">// ミュータブルな配列操作 =&gt; ReactではNG</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>  <span class="fu">setTodos</span>(todos)<span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(todos<span class="op">,</span> <span class="kw">null</span><span class="op">,</span> <span class="dv">2</span>))<span class="op">;</span> <span class="co">// todosの内容を表示</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>}<span class="op">;</span></span></code></pre></div>
      <p>上記のように <code>addNewTodo</code>
      を実装すると、「追加」のボタンを押下しても <span
      class="masked">ウェブ画面上にはタスクが追加されない</span>
      ことが確認できます。ただし、<strong>第11行目</strong>
      で行っているのコンソール出力を <strong>デベロッパーツール</strong>
      (<code>[F12]</code> で起動) から確認すると、以下のように
      <strong>内部的には <code>todos</code>
      の末尾に新しいタスクが正常に追加されていること</strong>が確認できます。</p>
      <figure>
      <img src="figs/05/app_01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>つまり、<code>push</code> メソッドなどの
      <strong>ミュータブルな配列操作</strong> で変更した配列を
      <code>setTodos</code> に与えても <span class="masked">React
      は画面の再レンダリングはしない</span>
      ということが確認できました。React は <code>setTodos</code>
      の引数に与えた <strong>オブジェクトの参照</strong>
      (C言語で言えばポインタ、Pythonで言えばオブジェクトID)
      が、前回から変化しているときに
      <strong>変更が生じたと判断して</strong>
      (=<strong>変更を検知して</strong>)
      画面を再レンダリングする、という仕組みなっていることを覚えておいてください。</p>
      <h1 data-number="3"
      id="新規タスクの名前設定テキストボックスの追加"><span
      class="header-section-number">3</span>
      新規タスクの名前設定テキストボックスの追加</h1>
      <p><strong>新規タスクの名前</strong> (=Todoオブジェクトの
      <code>name</code> プロパティ)
      を設定するための「<strong>テキストボックス</strong>」を追加します。参考動画
      (=<a
      href="https://www.youtube.com/watch?v=nRCNL9T3J98">1から簡単なTodoアプリを作ってReactの1歩を踏み出してみよう</a>)
      においては、テキストボックス関連の処理を <span
      class="masked">「useRef」という React Hook</span>
      で実装していましたが、ここでは、あとから
      <strong>バリデーション</strong>
      などの処理を追加するために「useState」を使って実装します。</p>
      <figure>
      <img src="figs/05/app_03.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>なお、アプリ開発の文脈において「バリデーション
      (Validation)」とは
      <strong>データの書式や内容のチェック</strong>、例えば <span
      class="masked">文字数が規定範囲内に収まっているか、文字列が有効なメールアドレス形式になっているかどうか</span>
      といったチェック処理を指します。</p>
      <p>以下に、新規タスクの<strong>名前</strong> (<code>name</code>)
      を設定するための「<strong>テキストボックス</strong>」を実装した例を示します。</p>
      <div class="sourceCode" id="cb6"
      data-caption="src/App.tsx (テキストボックスの追加)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb6-1"><a href="#cb6-1"></a><span class="im">import</span> { useState } <span class="im">from</span> <span class="st">&quot;react&quot;</span><span class="op">;</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="im">import</span> { Todo } <span class="im">from</span> <span class="st">&quot;./types&quot;</span><span class="op">;</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="im">import</span> { initTodos } <span class="im">from</span> <span class="st">&quot;./initTodos&quot;</span><span class="op">;</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="im">import</span> WelcomeMessage <span class="im">from</span> <span class="st">&quot;./WelcomeMessage&quot;</span><span class="op">;</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="im">import</span> TodoList <span class="im">from</span> <span class="st">&quot;./TodoList&quot;</span><span class="op">;</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="im">import</span> { v4 <span class="im">as</span> uuid } <span class="im">from</span> <span class="st">&quot;uuid&quot;</span><span class="op">;</span></span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="kw">const</span> App <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb6-9"><a href="#cb6-9"></a>  <span class="kw">const</span> [todos<span class="op">,</span> setTodos] <span class="op">=</span> <span class="fu">useState</span><span class="op">&lt;</span>Todo[]<span class="op">&gt;</span>(initTodos)<span class="op">;</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>  <span class="kw">const</span> [newTodoName<span class="op">,</span> setNewTodoName] <span class="op">=</span> <span class="fu">useState</span>(<span class="st">&quot;&quot;</span>)<span class="op">;</span> <span class="co">// ◀◀ 追加</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="kw">const</span> uncompletedCount <span class="op">=</span> todos<span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb6-12"><a href="#cb6-12"></a>    (todo<span class="op">:</span> Todo) <span class="kw">=&gt;</span> <span class="op">!</span>todo<span class="op">.</span><span class="at">isDone</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>  )<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb6-14"><a href="#cb6-14"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(todos<span class="op">,</span> <span class="kw">null</span><span class="op">,</span> <span class="dv">2</span>))<span class="op">;</span></span>
<span id="cb6-15"><a href="#cb6-15"></a></span>
<span id="cb6-16"><a href="#cb6-16"></a>  <span class="co">// ▼▼ 追加</span></span>
<span id="cb6-17"><a href="#cb6-17"></a>  <span class="kw">const</span> updateNewTodoName <span class="op">=</span> (e<span class="op">:</span> React<span class="op">.</span><span class="at">ChangeEvent</span><span class="op">&lt;</span><span class="bu">HTMLInputElement</span><span class="op">&gt;</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb6-18"><a href="#cb6-18"></a>    <span class="co">// あとでバリデーションなどの処理をここに追加する</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>    <span class="fu">setNewTodoName</span>(e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">value</span>)<span class="op">;</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>  }<span class="op">;</span></span>
<span id="cb6-21"><a href="#cb6-21"></a></span>
<span id="cb6-22"><a href="#cb6-22"></a>  <span class="kw">const</span> addNewTodo <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb6-23"><a href="#cb6-23"></a>    <span class="kw">const</span> newTodo<span class="op">:</span> Todo <span class="op">=</span> {</span>
<span id="cb6-24"><a href="#cb6-24"></a>      id<span class="op">:</span> <span class="fu">uuid</span>()<span class="op">,</span></span>
<span id="cb6-25"><a href="#cb6-25"></a>      name<span class="op">:</span> newTodoName<span class="op">,</span> <span class="co">// ◀◀ 編集</span></span>
<span id="cb6-26"><a href="#cb6-26"></a>      isDone<span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb6-27"><a href="#cb6-27"></a>      priority<span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb6-28"><a href="#cb6-28"></a>      deadline<span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2024</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">13</span>)<span class="op">,</span></span>
<span id="cb6-29"><a href="#cb6-29"></a>    }<span class="op">;</span></span>
<span id="cb6-30"><a href="#cb6-30"></a>    <span class="kw">const</span> updatedTodos <span class="op">=</span> [<span class="op">...</span>todos<span class="op">,</span> newTodo]<span class="op">;</span></span>
<span id="cb6-31"><a href="#cb6-31"></a>    <span class="fu">setTodos</span>(updatedTodos)<span class="op">;</span></span>
<span id="cb6-32"><a href="#cb6-32"></a>    <span class="fu">setNewTodoName</span>(<span class="st">&quot;&quot;</span>)<span class="op">;</span> <span class="co">// ◀◀ 追加</span></span>
<span id="cb6-33"><a href="#cb6-33"></a>  }<span class="op">;</span></span>
<span id="cb6-34"><a href="#cb6-34"></a></span>
<span id="cb6-35"><a href="#cb6-35"></a>  <span class="cf">return</span> (</span>
<span id="cb6-36"><a href="#cb6-36"></a>    <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;mx-4 mt-10 max-w-2xl md:mx-auto&quot;</span><span class="op">&gt;</span></span>
<span id="cb6-37"><a href="#cb6-37"></a>      <span class="op">&lt;</span>h1 className<span class="op">=</span><span class="st">&quot;mb-4 text-2xl font-bold&quot;</span><span class="op">&gt;</span>TodoApp<span class="op">&lt;/</span>h1<span class="op">&gt;</span></span>
<span id="cb6-38"><a href="#cb6-38"></a>      <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;mb-4&quot;</span><span class="op">&gt;</span></span>
<span id="cb6-39"><a href="#cb6-39"></a>        <span class="op">&lt;</span>WelcomeMessage</span>
<span id="cb6-40"><a href="#cb6-40"></a>          name<span class="op">=</span><span class="st">&quot;寝屋川タヌキ&quot;</span></span>
<span id="cb6-41"><a href="#cb6-41"></a>          uncompletedCount<span class="op">=</span>{uncompletedCount}</span>
<span id="cb6-42"><a href="#cb6-42"></a>        <span class="op">/&gt;</span></span>
<span id="cb6-43"><a href="#cb6-43"></a>      <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb6-44"><a href="#cb6-44"></a>      <span class="op">&lt;</span>TodoList todos<span class="op">=</span>{todos} <span class="op">/&gt;</span></span>
<span id="cb6-45"><a href="#cb6-45"></a></span>
<span id="cb6-46"><a href="#cb6-46"></a>      <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;mt-5 space-y-2 rounded-md border p-3&quot;</span><span class="op">&gt;</span></span>
<span id="cb6-47"><a href="#cb6-47"></a>        <span class="op">&lt;</span>h2 className<span class="op">=</span><span class="st">&quot;text-lg font-bold&quot;</span><span class="op">&gt;</span>新しいタスクの追加<span class="op">&lt;/</span>h2<span class="op">&gt;</span></span>
<span id="cb6-48"><a href="#cb6-48"></a></span>
<span id="cb6-49"><a href="#cb6-49"></a>        {<span class="co">/* テキストボックスの実装 ここから... */</span>}</span>
<span id="cb6-50"><a href="#cb6-50"></a>        <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;flex items-center space-x-2&quot;</span><span class="op">&gt;</span></span>
<span id="cb6-51"><a href="#cb6-51"></a>          <span class="op">&lt;</span>label className<span class="op">=</span><span class="st">&quot;font-bold&quot;</span> htmlFor<span class="op">=</span><span class="st">&quot;newTodoName&quot;</span><span class="op">&gt;</span></span>
<span id="cb6-52"><a href="#cb6-52"></a>            名前</span>
<span id="cb6-53"><a href="#cb6-53"></a>          <span class="op">&lt;/</span>label<span class="op">&gt;</span></span>
<span id="cb6-54"><a href="#cb6-54"></a>          <span class="op">&lt;</span>input</span>
<span id="cb6-55"><a href="#cb6-55"></a>            id<span class="op">=</span><span class="st">&quot;newTodoName&quot;</span></span>
<span id="cb6-56"><a href="#cb6-56"></a>            <span class="kw">type</span><span class="op">=</span><span class="st">&quot;text&quot;</span></span>
<span id="cb6-57"><a href="#cb6-57"></a>            value<span class="op">=</span>{newTodoName}</span>
<span id="cb6-58"><a href="#cb6-58"></a>            onChange<span class="op">=</span>{updateNewTodoName}</span>
<span id="cb6-59"><a href="#cb6-59"></a>            className<span class="op">=</span><span class="st">&quot;grow rounded-md border p-2&quot;</span></span>
<span id="cb6-60"><a href="#cb6-60"></a>            placeholder<span class="op">=</span><span class="st">&quot;2文字以上、32文字以内で入力してください&quot;</span></span>
<span id="cb6-61"><a href="#cb6-61"></a>          <span class="op">/&gt;</span></span>
<span id="cb6-62"><a href="#cb6-62"></a>        <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb6-63"><a href="#cb6-63"></a>        {<span class="co">/* ...ここまで */</span>}</span>
<span id="cb6-64"><a href="#cb6-64"></a></span>
<span id="cb6-65"><a href="#cb6-65"></a>        <span class="op">&lt;</span>button</span>
<span id="cb6-66"><a href="#cb6-66"></a>          <span class="kw">type</span><span class="op">=</span><span class="st">&quot;button&quot;</span></span>
<span id="cb6-67"><a href="#cb6-67"></a>          onClick<span class="op">=</span>{addNewTodo}</span>
<span id="cb6-68"><a href="#cb6-68"></a>          className<span class="op">=</span><span class="st">&quot;rounded-md bg-indigo-500 px-3 py-1 font-bold text-white hover:bg-indigo-600&quot;</span></span>
<span id="cb6-69"><a href="#cb6-69"></a>        <span class="op">&gt;</span></span>
<span id="cb6-70"><a href="#cb6-70"></a>          追加</span>
<span id="cb6-71"><a href="#cb6-71"></a>        <span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb6-72"><a href="#cb6-72"></a>      <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb6-73"><a href="#cb6-73"></a>    <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb6-74"><a href="#cb6-74"></a>  )<span class="op">;</span></span>
<span id="cb6-75"><a href="#cb6-75"></a>}<span class="op">;</span></span>
<span id="cb6-76"><a href="#cb6-76"></a></span>
<span id="cb6-77"><a href="#cb6-77"></a><span class="im">export</span> <span class="im">default</span> App<span class="op">;</span></span></code></pre></div>
      <p>ウェブアプリにおいて「<strong>テキストボックス</strong>」や「<strong>チェックボックス</strong>」「<strong>ラジオボタン</strong>」など入力系UI
      (フォーム入力) には「<code>&lt;input&gt;</code> タグ」を利用します
      (参考: <a
      href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/input">フォーム入力の種類</a>)。そして、React開発においては、一般に
      <code>&lt;input&gt;</code> タグは <span
      class="masked"><code>useRef</code> または <code>useState</code>
      を組み合わせて使用</span> します。</p>
      <p>ここでは「新規タスクの名前」をテキストボックスから得たいので、<strong>第10行目</strong>
      において <code>useState</code> から<span class="masked">「変数
      <code>newTodoName</code>」と「関数
      <code>setNewTodoName</code>」</span> を生成しています (つまり
      <code>newTodoName</code>
      を「<strong>状態</strong>」として扱うように実装しています)。また
      <strong>第10行目</strong> では <code>newTodoName</code> の初期値を
      <strong>空文字</strong> <code>""</code>
      に設定しています。なお、<strong>第10行目</strong> は
      <code>useState&lt;string&gt;("");</code>
      のように<strong>型を明示して初期化することも可能</strong>です
      (型推論が可能なときに型を省略するか、明示するかは (個人開発では)
      自由に決めてください)。</p>
      <h2 data-number="3.1"
      id="ユーザによるui操作と状態更新の対応付け"><span
      class="header-section-number">3.1</span>
      ユーザによるUI操作と状態更新の対応付け</h2>
      <p><strong>第57行目</strong> では、この <code>newTodoName</code>
      の内容がテキストボックスに反映されるように
      <code>&lt;input&gt;</code> タグの <strong>value属性</strong> を
      <code>value={newTodoName}</code> のように設定しています。</p>
      <p>ただし、これだけでは<strong>逆方向の値の反映がされません</strong>。具体的には
      <span
      class="masked">ユーザによるテキストボックスの編集操作が、変数
      <code>newTodoName</code> に対して</span>
      反映されません。これを反映するには、まず <strong>第58行目</strong>
      のように <code>onChange={updateNewTodoName}</code>
      とする必要があります。これにより、<strong>テキストボックスで文字列を編集するたびに</strong>、<strong>第17行目</strong>
      で定義している「updateNewTodoName関数」がコールされるようになります
      (呼び出されるようになります)。この際、コールされる関数には「<code>React.ChangeEvent&lt;HTMLInputElement&gt;</code>
      型の引数」が渡されます。この引数には、型の名前が表すように <span
      class="masked">HTML の Input要素
      の変更イベントに関する各種情報</span> が格納されています。</p>
      <p><strong>第17行目</strong>
      の「updateNewTodoName関数」では、それを <code>e</code>
      という仮引数で受け取って <code>e.target.value</code>
      から「変更された文字列」を取得して、<strong>第19行目</strong>
      で<code>setNewTodoName</code> にセットしています。</p>
      <h3 data-number="3.1.1" id="演習"><span
      class="header-section-number">3.1.1</span> 演習</h3>
      <p><strong>第59行目</strong> のCSSクラスから <code>grow</code>
      を削除するとテキストボックスのスタイリングがどのように変化するか確認してください。</p>
      <h2 data-number="3.2" id="ラベルタグの設定"><span
      class="header-section-number">3.2</span> ラベルタグの設定</h2>
      <p>ここでの実装例では、テキストボックス (インプット要素) に対して
      <strong>ラベルタグ</strong> <code>&lt;label&gt;</code>
      を組み合わせて使用しています。ラベルタグの
      <strong>htmlFor属性</strong> に対して「紐づけたいインプット要素の
      <code>id</code>」を設定すると (例えば、<strong>第51行目</strong>
      のように <code>htmlFor="newTodoName"</code> のように設定すると)
      ラベルをクリックしたときに <span
      class="masked">対応するインプットがアクティブ</span>
      になります。</p>
      <div class="sourceCode" id="cb7"
      data-caption="src/App.tsx (抜粋・再掲)" data-startFrom="50"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript" style="counter-reset: source-line 49;"><span id="cb7-50"><a href="#cb7-50"></a><span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;flex items-center space-x-2&quot;</span><span class="op">&gt;</span></span>
<span id="cb7-51"><a href="#cb7-51"></a>  <span class="op">&lt;</span>label className<span class="op">=</span><span class="st">&quot;font-bold&quot;</span> htmlFor<span class="op">=</span><span class="st">&quot;newTodoName&quot;</span><span class="op">&gt;</span></span>
<span id="cb7-52"><a href="#cb7-52"></a>    名前</span>
<span id="cb7-53"><a href="#cb7-53"></a>  <span class="op">&lt;/</span>label<span class="op">&gt;</span></span>
<span id="cb7-54"><a href="#cb7-54"></a>  <span class="op">&lt;</span>input</span>
<span id="cb7-55"><a href="#cb7-55"></a>    id<span class="op">=</span><span class="st">&quot;newTodoName&quot;</span></span>
<span id="cb7-56"><a href="#cb7-56"></a>    <span class="kw">type</span><span class="op">=</span><span class="st">&quot;text&quot;</span></span>
<span id="cb7-57"><a href="#cb7-57"></a>    value<span class="op">=</span>{newTodoName}</span>
<span id="cb7-58"><a href="#cb7-58"></a>    onChange<span class="op">=</span>{updateNewTodoName}</span>
<span id="cb7-59"><a href="#cb7-59"></a>    className<span class="op">=</span><span class="st">&quot;grow rounded-md border p-2&quot;</span></span>
<span id="cb7-60"><a href="#cb7-60"></a>    placeholder<span class="op">=</span><span class="st">&quot;2文字以上、32文字以内で入力してください&quot;</span></span>
<span id="cb7-61"><a href="#cb7-61"></a>  <span class="op">/&gt;</span></span>
<span id="cb7-62"><a href="#cb7-62"></a><span class="op">&lt;/</span>div<span class="op">&gt;</span></span></code></pre></div>
      <p>些細な工夫ですが、確実に UI/UX の向上に繋がるので
      <code>&lt;input&gt;</code> と <code>&lt;label&gt;</code> は
      <strong>セットで使用すること</strong>
      を意識するようにしてください。</p>
      <figure>
      <img src="figs/05/app_06.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h1 data-number="4" id="優先度を設定するラジオボタンの追加"><span
      class="header-section-number">4</span>
      優先度を設定するラジオボタンの追加</h1>
      <p>新規タスクの<strong>優先度</strong> (<code>priority</code>)
      を設定するための「<strong>ラジオボタン</strong>」を実装する例を以下に示します。</p>
      <figure>
      <img src="figs/05/app_04.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>ラジオボタンには、<strong>第76行目</strong> のように属性を
      <code>type="radio"</code> のように設定した
      <code>&lt;input&gt;</code> タグを使用します。</p>
      <div class="sourceCode" id="cb8"
      data-caption="src/App.tsx (ラジオボタンの追加)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb8-1"><a href="#cb8-1"></a><span class="im">import</span> { useState } <span class="im">from</span> <span class="st">&quot;react&quot;</span><span class="op">;</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="im">import</span> { Todo } <span class="im">from</span> <span class="st">&quot;./types&quot;</span><span class="op">;</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="im">import</span> { initTodos } <span class="im">from</span> <span class="st">&quot;./initTodos&quot;</span><span class="op">;</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="im">import</span> WelcomeMessage <span class="im">from</span> <span class="st">&quot;./WelcomeMessage&quot;</span><span class="op">;</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="im">import</span> TodoList <span class="im">from</span> <span class="st">&quot;./TodoList&quot;</span><span class="op">;</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="im">import</span> { v4 <span class="im">as</span> uuid } <span class="im">from</span> <span class="st">&quot;uuid&quot;</span><span class="op">;</span></span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="kw">const</span> App <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="kw">const</span> [todos<span class="op">,</span> setTodos] <span class="op">=</span> <span class="fu">useState</span><span class="op">&lt;</span>Todo[]<span class="op">&gt;</span>(initTodos)<span class="op">;</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>  <span class="kw">const</span> [newTodoName<span class="op">,</span> setNewTodoName] <span class="op">=</span> <span class="fu">useState</span>(<span class="st">&quot;&quot;</span>)<span class="op">;</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="kw">const</span> [newTodoPriority<span class="op">,</span> setNewTodoPriority] <span class="op">=</span> <span class="fu">useState</span>(<span class="dv">3</span>)<span class="op">;</span> <span class="co">// ◀◀ 追加</span></span>
<span id="cb8-12"><a href="#cb8-12"></a></span>
<span id="cb8-13"><a href="#cb8-13"></a>  <span class="kw">const</span> uncompletedCount <span class="op">=</span> todos<span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb8-14"><a href="#cb8-14"></a>    (todo<span class="op">:</span> Todo) <span class="kw">=&gt;</span> <span class="op">!</span>todo<span class="op">.</span><span class="at">isDone</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>  )<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb8-16"><a href="#cb8-16"></a></span>
<span id="cb8-17"><a href="#cb8-17"></a>  <span class="kw">const</span> updateNewTodoName <span class="op">=</span> (e<span class="op">:</span> React<span class="op">.</span><span class="at">ChangeEvent</span><span class="op">&lt;</span><span class="bu">HTMLInputElement</span><span class="op">&gt;</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="co">// あとでバリデーションなどの処理をここに追加する</span></span>
<span id="cb8-19"><a href="#cb8-19"></a>    <span class="fu">setNewTodoName</span>(e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">value</span>)<span class="op">;</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>  }<span class="op">;</span></span>
<span id="cb8-21"><a href="#cb8-21"></a></span>
<span id="cb8-22"><a href="#cb8-22"></a>  <span class="co">// ▼▼ 追加</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>  <span class="kw">const</span> updateNewTodoPriority <span class="op">=</span> (e<span class="op">:</span> React<span class="op">.</span><span class="at">ChangeEvent</span><span class="op">&lt;</span><span class="bu">HTMLInputElement</span><span class="op">&gt;</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb8-24"><a href="#cb8-24"></a>    <span class="fu">setNewTodoPriority</span>(<span class="bu">Number</span>(e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">value</span>))<span class="op">;</span> <span class="co">// 数値型に変換</span></span>
<span id="cb8-25"><a href="#cb8-25"></a>  }<span class="op">;</span></span>
<span id="cb8-26"><a href="#cb8-26"></a></span>
<span id="cb8-27"><a href="#cb8-27"></a>  <span class="kw">const</span> addNewTodo <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb8-28"><a href="#cb8-28"></a>    <span class="kw">const</span> newTodo<span class="op">:</span> Todo <span class="op">=</span> {</span>
<span id="cb8-29"><a href="#cb8-29"></a>      id<span class="op">:</span> <span class="fu">uuid</span>()<span class="op">,</span></span>
<span id="cb8-30"><a href="#cb8-30"></a>      name<span class="op">:</span> newTodoName<span class="op">,</span></span>
<span id="cb8-31"><a href="#cb8-31"></a>      isDone<span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb8-32"><a href="#cb8-32"></a>      priority<span class="op">:</span> newTodoPriority<span class="op">,</span> <span class="co">// ◀◀ 追加</span></span>
<span id="cb8-33"><a href="#cb8-33"></a>      deadline<span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2024</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">13</span>)<span class="op">,</span></span>
<span id="cb8-34"><a href="#cb8-34"></a>    }<span class="op">;</span></span>
<span id="cb8-35"><a href="#cb8-35"></a>    <span class="kw">const</span> updatedTodos <span class="op">=</span> [<span class="op">...</span>todos<span class="op">,</span> newTodo]<span class="op">;</span></span>
<span id="cb8-36"><a href="#cb8-36"></a>    <span class="fu">setTodos</span>(updatedTodos)<span class="op">;</span></span>
<span id="cb8-37"><a href="#cb8-37"></a>    <span class="fu">setNewTodoName</span>(<span class="st">&quot;&quot;</span>)<span class="op">;</span></span>
<span id="cb8-38"><a href="#cb8-38"></a>    <span class="fu">setNewTodoPriority</span>(<span class="dv">3</span>)<span class="op">;</span> <span class="co">// ◀◀ 追加</span></span>
<span id="cb8-39"><a href="#cb8-39"></a>  }<span class="op">;</span></span>
<span id="cb8-40"><a href="#cb8-40"></a></span>
<span id="cb8-41"><a href="#cb8-41"></a>  <span class="cf">return</span> (</span>
<span id="cb8-42"><a href="#cb8-42"></a>    <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;mx-4 mt-10 max-w-2xl md:mx-auto&quot;</span><span class="op">&gt;</span></span>
<span id="cb8-43"><a href="#cb8-43"></a>      <span class="op">&lt;</span>h1 className<span class="op">=</span><span class="st">&quot;mb-4 text-2xl font-bold&quot;</span><span class="op">&gt;</span>TodoApp<span class="op">&lt;/</span>h1<span class="op">&gt;</span></span>
<span id="cb8-44"><a href="#cb8-44"></a>      <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;mb-4&quot;</span><span class="op">&gt;</span></span>
<span id="cb8-45"><a href="#cb8-45"></a>        <span class="op">&lt;</span>WelcomeMessage</span>
<span id="cb8-46"><a href="#cb8-46"></a>          name<span class="op">=</span><span class="st">&quot;寝屋川タヌキ&quot;</span></span>
<span id="cb8-47"><a href="#cb8-47"></a>          uncompletedCount<span class="op">=</span>{uncompletedCount}</span>
<span id="cb8-48"><a href="#cb8-48"></a>        <span class="op">/&gt;</span></span>
<span id="cb8-49"><a href="#cb8-49"></a>      <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb8-50"><a href="#cb8-50"></a>      <span class="op">&lt;</span>TodoList todos<span class="op">=</span>{todos} <span class="op">/&gt;</span></span>
<span id="cb8-51"><a href="#cb8-51"></a></span>
<span id="cb8-52"><a href="#cb8-52"></a>      <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;mt-5 space-y-2 rounded-md border p-3&quot;</span><span class="op">&gt;</span></span>
<span id="cb8-53"><a href="#cb8-53"></a>        <span class="op">&lt;</span>h2 className<span class="op">=</span><span class="st">&quot;text-lg font-bold&quot;</span><span class="op">&gt;</span>新しいタスクの追加<span class="op">&lt;/</span>h2<span class="op">&gt;</span></span>
<span id="cb8-54"><a href="#cb8-54"></a>        <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;flex items-center space-x-2&quot;</span><span class="op">&gt;</span></span>
<span id="cb8-55"><a href="#cb8-55"></a>          <span class="op">&lt;</span>label className<span class="op">=</span><span class="st">&quot;font-bold&quot;</span> htmlFor<span class="op">=</span><span class="st">&quot;newTodoName&quot;</span><span class="op">&gt;</span></span>
<span id="cb8-56"><a href="#cb8-56"></a>            名前</span>
<span id="cb8-57"><a href="#cb8-57"></a>          <span class="op">&lt;/</span>label<span class="op">&gt;</span></span>
<span id="cb8-58"><a href="#cb8-58"></a>          <span class="op">&lt;</span>input</span>
<span id="cb8-59"><a href="#cb8-59"></a>            id<span class="op">=</span><span class="st">&quot;newTodoName&quot;</span></span>
<span id="cb8-60"><a href="#cb8-60"></a>            <span class="kw">type</span><span class="op">=</span><span class="st">&quot;text&quot;</span></span>
<span id="cb8-61"><a href="#cb8-61"></a>            value<span class="op">=</span>{newTodoName}</span>
<span id="cb8-62"><a href="#cb8-62"></a>            onChange<span class="op">=</span>{updateNewTodoName}</span>
<span id="cb8-63"><a href="#cb8-63"></a>            className<span class="op">=</span><span class="st">&quot;grow rounded-md border p-2&quot;</span></span>
<span id="cb8-64"><a href="#cb8-64"></a>            placeholder<span class="op">=</span><span class="st">&quot;2文字以上、32文字以内で入力してください&quot;</span></span>
<span id="cb8-65"><a href="#cb8-65"></a>          <span class="op">/&gt;</span></span>
<span id="cb8-66"><a href="#cb8-66"></a>        <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb8-67"><a href="#cb8-67"></a></span>
<span id="cb8-68"><a href="#cb8-68"></a>        {<span class="co">/* ラジオボタンの実装 ここから... */</span>}</span>
<span id="cb8-69"><a href="#cb8-69"></a>        <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;flex gap-5&quot;</span><span class="op">&gt;</span></span>
<span id="cb8-70"><a href="#cb8-70"></a>          <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;font-bold&quot;</span><span class="op">&gt;</span>優先度<span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb8-71"><a href="#cb8-71"></a>          {[<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span>]<span class="op">.</span><span class="fu">map</span>((value) <span class="kw">=&gt;</span> (</span>
<span id="cb8-72"><a href="#cb8-72"></a>            <span class="op">&lt;</span>label key<span class="op">=</span>{value} className<span class="op">=</span><span class="st">&quot;flex items-center space-x-1&quot;</span><span class="op">&gt;</span></span>
<span id="cb8-73"><a href="#cb8-73"></a>              <span class="op">&lt;</span>input</span>
<span id="cb8-74"><a href="#cb8-74"></a>                id<span class="op">=</span>{<span class="vs">`priority-</span><span class="sc">${</span>value<span class="sc">}</span><span class="vs">`</span>}</span>
<span id="cb8-75"><a href="#cb8-75"></a>                name<span class="op">=</span><span class="st">&quot;priorityGroup&quot;</span></span>
<span id="cb8-76"><a href="#cb8-76"></a>                <span class="kw">type</span><span class="op">=</span><span class="st">&quot;radio&quot;</span></span>
<span id="cb8-77"><a href="#cb8-77"></a>                value<span class="op">=</span>{value}</span>
<span id="cb8-78"><a href="#cb8-78"></a>                checked<span class="op">=</span>{newTodoPriority <span class="op">===</span> value}</span>
<span id="cb8-79"><a href="#cb8-79"></a>                onChange<span class="op">=</span>{updateNewTodoPriority}</span>
<span id="cb8-80"><a href="#cb8-80"></a>              <span class="op">/&gt;</span></span>
<span id="cb8-81"><a href="#cb8-81"></a>              <span class="op">&lt;</span>span<span class="op">&gt;</span>{value}<span class="op">&lt;/</span>span<span class="op">&gt;</span></span>
<span id="cb8-82"><a href="#cb8-82"></a>            <span class="op">&lt;/</span>label<span class="op">&gt;</span></span>
<span id="cb8-83"><a href="#cb8-83"></a>          ))}</span>
<span id="cb8-84"><a href="#cb8-84"></a>        <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb8-85"><a href="#cb8-85"></a>        {<span class="co">/* ...ここまで */</span>}</span>
<span id="cb8-86"><a href="#cb8-86"></a></span>
<span id="cb8-87"><a href="#cb8-87"></a>        <span class="op">&lt;</span>button</span>
<span id="cb8-88"><a href="#cb8-88"></a>          <span class="kw">type</span><span class="op">=</span><span class="st">&quot;button&quot;</span></span>
<span id="cb8-89"><a href="#cb8-89"></a>          onClick<span class="op">=</span>{addNewTodo}</span>
<span id="cb8-90"><a href="#cb8-90"></a>          className<span class="op">=</span><span class="st">&quot;rounded-md bg-indigo-500 px-3 py-1 font-bold text-white hover:bg-indigo-600&quot;</span></span>
<span id="cb8-91"><a href="#cb8-91"></a>        <span class="op">&gt;</span></span>
<span id="cb8-92"><a href="#cb8-92"></a>          追加</span>
<span id="cb8-93"><a href="#cb8-93"></a>        <span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb8-94"><a href="#cb8-94"></a>      <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb8-95"><a href="#cb8-95"></a>    <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb8-96"><a href="#cb8-96"></a>  )<span class="op">;</span></span>
<span id="cb8-97"><a href="#cb8-97"></a>}<span class="op">;</span></span>
<span id="cb8-98"><a href="#cb8-98"></a></span>
<span id="cb8-99"><a href="#cb8-99"></a><span class="im">export</span> <span class="im">default</span> App<span class="op">;</span></span></code></pre></div>
      <p>はじめに <strong>第11行目</strong>
      で、新規タスクの優先度を「状態」として管理するための
      <code>newTodoPriority</code> と <code>setNewTodoPriority</code>
      を用意していることを確認してください。また、その初期値として <span
      class="masked">「数値型」の <code>3</code></span>
      を設定していることを確認してください。</p>
      <p>そして、ラジオボタンが操作されたタイミングで
      <strong>第23行目</strong> で定義した
      <code>updateNewTodoPriority</code> がコールされて、そのなかで
      <code>setNewTodoPriority</code>
      で状態が更新される仕組みになっていることを確認してください。なお、<code>e.target.value</code>
      で取得される値は <span
      class="masked"><code>&lt;input&gt;</code>タグの種別や属性設定に関係なく常に「文字列型」になること</span>
      に注意してください。そのため <strong>第24行目</strong>
      では、<code>Number</code>
      関数を使って「文字列型」から「数値型」に変換して
      <code>setNewTodoPriority</code> にセットしています。</p>
      <p>Number関数を使用していないと、次のようにエラーとなります。</p>
      <figure>
      <img src="figs/05/vscode_01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <hr />
      <p>JSX部分の「ラジオボタンの実装」は、「テキストボックスの実装」と比較すると<strong>かなり複雑</strong>になっています。次に、以下の点を意識しながら
      <strong>第69行目</strong> ～ <strong>第84行</strong>
      のコードを読解してください。</p>
      <ul>
      <li>前回講義で<a
      href="lecture04.html#todolistコンポーネントのブラッシュアップ">解説</a>したようにJSX構文のなかで
      <code>map</code> を利用するときは <span class="masked">map
      の戻り値となる最外殻の要素には「key属性」</span>
      を設定する必要がありました。そのため <strong>第72行目</strong>
      に「key属性」を設定しています。
      <ul>
      <li>key属性を設定しないとブラウザのコンソールに「<strong>Warning:
      Each child in a list should have a unique “key”
      prop.</strong>」のような警告が表示されます。</li>
      </ul></li>
      <li>テキストボックスを実装したときは <code>&lt;label&gt;</code> と
      <code>&lt;input&gt;</code> を並列に配置しました
      (いわゆる「兄弟」の関係になるように配置しました)
      。一方で、ここでは <span class="masked"><code>&lt;input&gt;</code>
      が <code>&lt;label&gt;</code> の子要素</span> になるように配置
      (いわゆる「親子」の関係になるように配置)しています。このように
      <code>&lt;input&gt;</code> を <code>&lt;label&gt;</code>
      の子要素とすると
      「htmlFor属性」を設定せずに両者の紐づけが可能になります。
      <ul>
      <li>(ラジオボタンの本体ではなく)「1」「2」「3」という文字列のクリックすることでも
      <strong>対応するラジオボタンを選択できること</strong>
      を確認してください。</li>
      <li>ラベルとインプットの対応付けという意味では
      <strong>第74行目</strong>
      の「id属性」は不要です。ただし、一般にインプット要素には「id属性」を与えることが作法であるため、ここでは
      <code>id={`priority-${value}`}</code>
      のように設定しています。</li>
      </ul></li>
      <li>ラジオボタンでは
      <strong>「name属性が同じもの」がグループ化</strong> されて、<span
      class="masked">そのグループのなかで1個のボタンだけが選択できる</span>
      ようになります。そのため <strong>第75行目</strong>
      では各ボタンとも共通で <code>name="priorityGroup"</code>
      を設定しています。ただし、この実装では <code>onChange</code> と
      <code>checked</code>
      で選択を制御しているため、「name属性」を設定していなくともラジオボタンとしての動作をします。ただし、ここでも一般的な作法として「name属性」を設定しています。</li>
      </ul>
      <h2 data-number="4.1" id="補足-onchange属性の設定"><span
      class="header-section-number">4.1</span> 補足:
      onChange属性の設定</h2>
      <p><strong>第23行目</strong> の関数
      <code>updateNewTodoPriority</code>
      を<strong>定義せず</strong>に、<strong>第79行目</strong> の
      <code>onChange</code> に <span
      class="masked">「アロー関数形式」で「優先度を設定する処理」を直接的に記述すること</span>
      も可能です。</p>
      <div class="sourceCode" id="cb9"
      data-caption="src/App.tsx (優先度を設定する処理をonChangeに直接記述)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb9-1"><a href="#cb9-1"></a><span class="op">&lt;</span>input</span>
<span id="cb9-2"><a href="#cb9-2"></a>  id<span class="op">=</span>{<span class="vs">`priority-</span><span class="sc">${</span>value<span class="sc">}</span><span class="vs">`</span>}</span>
<span id="cb9-3"><a href="#cb9-3"></a>  name<span class="op">=</span><span class="st">&quot;priorityGroup&quot;</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="kw">type</span><span class="op">=</span><span class="st">&quot;radio&quot;</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  value<span class="op">=</span>{value}</span>
<span id="cb9-6"><a href="#cb9-6"></a>  checked<span class="op">=</span>{newTodoPriority <span class="op">===</span> value}</span>
<span id="cb9-7"><a href="#cb9-7"></a>  onChange<span class="op">=</span>{(e) <span class="kw">=&gt;</span> <span class="fu">updateNewTodoPriority</span>(e)} <span class="co">// ◀◀ 注目</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="op">/&gt;</span></span></code></pre></div>
      <p>上記のようなテクニックは、Reactでは頻繁に使われるので覚えておいてください。特に処理が短い場合は、こちらの記法が推奨されます。また、ここでは<strong>型推論が有効になるので</strong>、以下のように長々と「型」を記述しなくても良いことも嬉しいです。</p>
      <div class="sourceCode" id="cb10" data-caption="型を明示する例"
      data-startFrom="7"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript" style="counter-reset: source-line 6;"><span id="cb10-7"><a href="#cb10-7"></a>onChange<span class="op">=</span>{(e<span class="op">:</span>React<span class="op">.</span><span class="at">ChangeEvent</span><span class="op">&lt;</span><span class="bu">HTMLInputElement</span><span class="op">&gt;</span>) <span class="kw">=&gt;</span> <span class="fu">updateNewTodoPriority</span>(e)}</span></code></pre></div>
      <h2 data-number="4.2"
      id="補足-mapを使用せずにラジオボタンを構成する例"><span
      class="header-section-number">4.2</span> 補足:
      mapを使用せずにラジオボタンを構成する例</h2>
      <p><code>map</code> を使用せずに <strong>第69行目</strong> ～
      <strong>第84行目</strong> のJSXを記述すると
      (ラジオボタンを実装すると) 次のようになります。</p>
      <div class="sourceCode" id="cb11"
      data-caption="src/App.tsx (抜粋・mapを使用せずにラジオボタンを構成)"
      data-startFrom="66"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript" style="counter-reset: source-line 65;"><span id="cb11-66"><a href="#cb11-66"></a><span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;flex gap-5&quot;</span><span class="op">&gt;</span></span>
<span id="cb11-67"><a href="#cb11-67"></a>  <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;font-bold&quot;</span><span class="op">&gt;</span>優先度<span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb11-68"><a href="#cb11-68"></a>  <span class="op">&lt;</span>label className<span class="op">=</span><span class="st">&quot;flex items-center space-x-1&quot;</span><span class="op">&gt;</span></span>
<span id="cb11-69"><a href="#cb11-69"></a>    <span class="op">&lt;</span>input</span>
<span id="cb11-70"><a href="#cb11-70"></a>      id<span class="op">=</span><span class="st">&quot;priority-1&quot;</span></span>
<span id="cb11-71"><a href="#cb11-71"></a>      name<span class="op">=</span><span class="st">&quot;priorityGroup&quot;</span></span>
<span id="cb11-72"><a href="#cb11-72"></a>      <span class="kw">type</span><span class="op">=</span><span class="st">&quot;radio&quot;</span></span>
<span id="cb11-73"><a href="#cb11-73"></a>      value<span class="op">=</span><span class="st">&quot;1&quot;</span></span>
<span id="cb11-74"><a href="#cb11-74"></a>      checked<span class="op">=</span>{newTodoPriority <span class="op">===</span> <span class="dv">1</span>}</span>
<span id="cb11-75"><a href="#cb11-75"></a>      onChange<span class="op">=</span>{updateNewTodoPriority}</span>
<span id="cb11-76"><a href="#cb11-76"></a>    <span class="op">/&gt;</span></span>
<span id="cb11-77"><a href="#cb11-77"></a>    <span class="op">&lt;</span>span<span class="op">&gt;</span><span class="dv">1</span><span class="op">&lt;/</span>span<span class="op">&gt;</span></span>
<span id="cb11-78"><a href="#cb11-78"></a>  <span class="op">&lt;/</span>label<span class="op">&gt;</span></span>
<span id="cb11-79"><a href="#cb11-79"></a>  <span class="op">&lt;</span>label className<span class="op">=</span><span class="st">&quot;flex items-center space-x-1&quot;</span><span class="op">&gt;</span></span>
<span id="cb11-80"><a href="#cb11-80"></a>    <span class="op">&lt;</span>input</span>
<span id="cb11-81"><a href="#cb11-81"></a>      id<span class="op">=</span><span class="st">&quot;priority-2&quot;</span></span>
<span id="cb11-82"><a href="#cb11-82"></a>      name<span class="op">=</span><span class="st">&quot;priorityGroup&quot;</span></span>
<span id="cb11-83"><a href="#cb11-83"></a>      <span class="kw">type</span><span class="op">=</span><span class="st">&quot;radio&quot;</span></span>
<span id="cb11-84"><a href="#cb11-84"></a>      value<span class="op">=</span><span class="st">&quot;2&quot;</span></span>
<span id="cb11-85"><a href="#cb11-85"></a>      checked<span class="op">=</span>{newTodoPriority <span class="op">===</span> <span class="dv">2</span>}</span>
<span id="cb11-86"><a href="#cb11-86"></a>      onChange<span class="op">=</span>{updateNewTodoPriority}</span>
<span id="cb11-87"><a href="#cb11-87"></a>    <span class="op">/&gt;</span></span>
<span id="cb11-88"><a href="#cb11-88"></a>    <span class="op">&lt;</span>span<span class="op">&gt;</span><span class="dv">2</span><span class="op">&lt;/</span>span<span class="op">&gt;</span></span>
<span id="cb11-89"><a href="#cb11-89"></a>  <span class="op">&lt;/</span>label<span class="op">&gt;</span></span>
<span id="cb11-90"><a href="#cb11-90"></a>  <span class="op">&lt;</span>label className<span class="op">=</span><span class="st">&quot;flex items-center space-x-1&quot;</span><span class="op">&gt;</span></span>
<span id="cb11-91"><a href="#cb11-91"></a>    <span class="op">&lt;</span>input</span>
<span id="cb11-92"><a href="#cb11-92"></a>      id<span class="op">=</span><span class="st">&quot;priority-3&quot;</span></span>
<span id="cb11-93"><a href="#cb11-93"></a>      name<span class="op">=</span><span class="st">&quot;priorityGroup&quot;</span></span>
<span id="cb11-94"><a href="#cb11-94"></a>      <span class="kw">type</span><span class="op">=</span><span class="st">&quot;radio&quot;</span></span>
<span id="cb11-95"><a href="#cb11-95"></a>      value<span class="op">=</span><span class="st">&quot;3&quot;</span></span>
<span id="cb11-96"><a href="#cb11-96"></a>      checked<span class="op">=</span>{newTodoPriority <span class="op">===</span> <span class="dv">3</span>}</span>
<span id="cb11-97"><a href="#cb11-97"></a>      onChange<span class="op">=</span>{updateNewTodoPriority}</span>
<span id="cb11-98"><a href="#cb11-98"></a>    <span class="op">/&gt;</span></span>
<span id="cb11-99"><a href="#cb11-99"></a>    <span class="op">&lt;</span>span<span class="op">&gt;</span><span class="dv">3</span><span class="op">&lt;/</span>span<span class="op">&gt;</span></span>
<span id="cb11-100"><a href="#cb11-100"></a>  <span class="op">&lt;/</span>label<span class="op">&gt;</span></span>
<span id="cb11-101"><a href="#cb11-101"></a><span class="op">&lt;/</span>div<span class="op">&gt;</span></span></code></pre></div>
      <p>重複する部分が多いので <code>map</code>
      を使ってJSXを構成するほうがスマートであることが分かると思います。</p>
      <h2 data-number="4.3"
      id="ラジオボタンのラベルに任意の値を使用する方法"><span
      class="header-section-number">4.3</span>
      ラジオボタンのラベルに任意の値を使用する方法</h2>
      <p>ラジオボタンの「ラベル」を次のように<strong>任意の値</strong>
      (例えば <strong>高・中・低</strong> など)
      を設定したいときの実装例を示します。</p>
      <figure>
      <img src="figs/05/app_07.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>このようにするためには、JSXを次のように変更します。<code>[1,2,3]</code>
      を <code>["高", "中", "低"]</code>
      に変えて、その他、いくつかの属性を変えています。</p>
      <div class="sourceCode" id="cb12"
      data-caption="src/App.tsx (抜粋)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb12-1"><a href="#cb12-1"></a><span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;flex gap-5&quot;</span><span class="op">&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;font-bold&quot;</span><span class="op">&gt;</span>優先度<span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>  {[<span class="st">&quot;高&quot;</span><span class="op">,</span> <span class="st">&quot;中&quot;</span><span class="op">,</span> <span class="st">&quot;低&quot;</span>]<span class="op">.</span><span class="fu">map</span>((value<span class="op">,</span> index) <span class="kw">=&gt;</span> ( <span class="co">// ◀◀ 注目 index を追加</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>    <span class="op">&lt;</span>label key<span class="op">=</span>{value} className<span class="op">=</span><span class="st">&quot;flex items-center space-x-1&quot;</span><span class="op">&gt;</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>      <span class="op">&lt;</span>input</span>
<span id="cb12-6"><a href="#cb12-6"></a>        id<span class="op">=</span>{<span class="vs">`priority-</span><span class="sc">${</span>value<span class="sc">}</span><span class="vs">`</span>}</span>
<span id="cb12-7"><a href="#cb12-7"></a>        name<span class="op">=</span><span class="st">&quot;priorityGroup&quot;</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>        <span class="kw">type</span><span class="op">=</span><span class="st">&quot;radio&quot;</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>        value<span class="op">=</span>{value}</span>
<span id="cb12-10"><a href="#cb12-10"></a>        checked<span class="op">=</span>{newTodoPriority <span class="op">===</span> index <span class="op">+</span> <span class="dv">1</span>} <span class="co">// ◀◀ 注目</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>        onChange<span class="op">=</span>{updateNewTodoPriority}</span>
<span id="cb12-12"><a href="#cb12-12"></a>      <span class="op">/&gt;</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>      <span class="op">&lt;</span>span<span class="op">&gt;</span>{value}<span class="op">&lt;/</span>span<span class="op">&gt;</span></span>
<span id="cb12-14"><a href="#cb12-14"></a>    <span class="op">&lt;/</span>label<span class="op">&gt;</span></span>
<span id="cb12-15"><a href="#cb12-15"></a>  ))}</span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="op">&lt;/</span>div<span class="op">&gt;</span></span></code></pre></div>
      <p>さらに、上記の変更にあわせて関数
      <code>updateNewTodoPriority</code>
      を次のようにします。上記の変更によって <code>e.target.value</code>
      の値が <code>高</code>、<code>中</code>、<code>低</code>
      のいずれかになるので、それを <code>switch</code>
      で振り分けています。</p>
      <div class="sourceCode" id="cb13"
      data-caption="src/App.tsx (抜粋)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">const</span> updateNewTodoPriority <span class="op">=</span> (e<span class="op">:</span> React<span class="op">.</span><span class="at">ChangeEvent</span><span class="op">&lt;</span><span class="bu">HTMLInputElement</span><span class="op">&gt;</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="cf">switch</span> (e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">value</span>) {</span>
<span id="cb13-3"><a href="#cb13-3"></a>    <span class="cf">case</span> <span class="st">&quot;高&quot;</span><span class="op">:</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>      <span class="fu">setNewTodoPriority</span>(<span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>      <span class="cf">break</span><span class="op">;</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>    <span class="cf">case</span> <span class="st">&quot;中&quot;</span><span class="op">:</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>      <span class="fu">setNewTodoPriority</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>      <span class="cf">break</span><span class="op">;</span></span>
<span id="cb13-9"><a href="#cb13-9"></a>    <span class="cf">case</span> <span class="st">&quot;低&quot;</span><span class="op">:</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>      <span class="fu">setNewTodoPriority</span>(<span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>      <span class="cf">break</span><span class="op">;</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>  }</span>
<span id="cb13-13"><a href="#cb13-13"></a>}<span class="op">;</span></span></code></pre></div>
      <p>なお、上記の以外にも <span
      class="masked"><code>value={value}</code> を
      <code>value={index+1}</code></span>
      のようにしてしまうスマートな方法もあります (この方法では、そもそも
      <code>updateNewTodoPriority</code>
      を変更する必要がありません)。</p>
      <h1 data-number="5" id="期限を設定する日時設定uiの追加"><span
      class="header-section-number">5</span>
      期限を設定する日時設定UIの追加</h1>
      <p>新規タスクの<strong>期限</strong> (<code>deadline</code>)
      を設定するための「<strong>日時設定UI</strong>」を実装する例を以下に示します。</p>
      <figure>
      <img src="figs/05/app_05.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>日時設定UIには、属性を <code>type="datetime-local"</code>
      に設定した <code>&lt;input&gt;</code>
      タグを使用します。なお、Chrome において「<strong>2024/10/31 ()
      17:20</strong>」のように<strong>括弧の内部が表示されない</strong>のは仕様
      (バグ?) です。</p>
      <ul>
      <li>新規タスクの期限設定を実装した <code>src/App.tsx</code>
      の全体のコードは<a
      href="https://github.com/TakeshiWada1980/Programming3-2024/blob/main/docs/codes/05/code01.tsx">こちら<i class="fa-solid fa-person-chalkboard"></i></a>を参照してください。</li>
      </ul>
      <h2 data-number="5.1" id="日時情報の更新-uiコード"><span
      class="header-section-number">5.1</span> 日時情報の更新
      (UI→コード)</h2>
      <p><a
      href="lecture04.html#準備-初期データの作成">前回講義</a>で仕様を決めたように「<strong>特に期限を設定しないTodo</strong>」については
      <span class="masked"><code>deadline</code> を
      <code>null</code></span> として扱うものとします。</p>
      <div class="sourceCode" id="cb14"
      data-caption="src/types.ts (再掲)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb14-1"><a href="#cb14-1"></a><span class="im">export type</span> Todo <span class="op">=</span> {</span>
<span id="cb14-2"><a href="#cb14-2"></a>  id<span class="op">:</span> <span class="dt">string</span><span class="op">;</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  name<span class="op">:</span> <span class="dt">string</span><span class="op">;</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>  isDone<span class="op">:</span> <span class="dt">boolean</span><span class="op">;</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>  priority<span class="op">:</span> <span class="dt">number</span><span class="op">;</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>  deadline<span class="op">:</span> <span class="bu">Date</span> <span class="op">|</span> <span class="dt">null</span><span class="op">;</span> <span class="co">// ◀◀ 注目</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>}<span class="op">;</span></span></code></pre></div>
      <p>そのため、<strong>第13行目</strong> (<a
      href="https://github.com/TakeshiWada1980/Programming3-2024/blob/main/docs/codes/05/code01.tsx">全体コード<i class="fa-solid fa-person-chalkboard"></i></a>参照)
      のように、期限を扱う「状態」については
      <code>useState&lt;Date | null&gt;</code> のように
      <strong>型を明示して初期化</strong>
      する必要があります。このように、値が<strong>「Date型」または「null」のどちらかになり得るような型</strong>
      を <span class="masked">Union型 (ユニオン型)</span>
      とよびます。Union型では <strong>初期値から型推論が不可能</strong>
      であるため明示的に型を示す必要があります。</p>
      <div class="sourceCode" id="cb15"
      data-caption="src/App.tsx (抜粋・期限を扱う状態の初期化)"
      data-startFrom="13"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript" style="counter-reset: source-line 12;"><span id="cb15-13"><a href="#cb15-13"></a><span class="kw">const</span> [newTodoDeadline<span class="op">,</span> setNewTodoDeadline] <span class="op">=</span> <span class="fu">useState</span><span class="op">&lt;</span><span class="bu">Date</span> <span class="op">|</span> <span class="dt">null</span><span class="op">&gt;</span>(<span class="kw">null</span>)<span class="op">;</span></span></code></pre></div>
      <p>もし、ここで次のように <strong>型を指定せずに初期化</strong>
      してしまうと、<code>newTodoDeadline</code> は <span
      class="masked">null型の変数 (=値として <code>null</code>
      だけを持つことができる変数)</span>
      になってしまうので注意してください。</p>
      <div class="sourceCode" id="cb16"
      data-caption="src/App.tsx (抜粋・NG実装)" data-startFrom="13"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript" style="counter-reset: source-line 12;"><span id="cb16-13"><a href="#cb16-13"></a><span class="kw">const</span> [newTodoDeadline<span class="op">,</span> setNewTodoDeadline] <span class="op">=</span> <span class="fu">useState</span>(<span class="kw">null</span>)<span class="op">;</span></span></code></pre></div>
      <p>つづいて <strong>第28行目</strong> からは、以下のように
      <strong>日時設定UIでユーザにより値が変更されたとき</strong>
      にコールされる「updateDeadline関数」を定義しています。</p>
      <div class="sourceCode" id="cb17"
      data-caption="src/App.tsx (抜粋)" data-startFrom="28"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript" style="counter-reset: source-line 27;"><span id="cb17-28"><a href="#cb17-28"></a><span class="kw">const</span> updateDeadline <span class="op">=</span> (e<span class="op">:</span> React<span class="op">.</span><span class="at">ChangeEvent</span><span class="op">&lt;</span><span class="bu">HTMLInputElement</span><span class="op">&gt;</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb17-29"><a href="#cb17-29"></a>  <span class="kw">const</span> dt <span class="op">=</span> e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">value</span><span class="op">;</span> <span class="co">// UIで日時が未設定のときは空文字列 &quot;&quot; が dt に格納される</span></span>
<span id="cb17-30"><a href="#cb17-30"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`UI操作で日時が &quot;</span><span class="sc">${</span>dt<span class="sc">}</span><span class="vs">&quot; (</span><span class="sc">${</span><span class="kw">typeof</span> dt<span class="sc">}</span><span class="vs">型) に変更されました。`</span>)<span class="op">;</span></span>
<span id="cb17-31"><a href="#cb17-31"></a>  <span class="fu">setNewTodoDeadline</span>(dt <span class="op">===</span> <span class="st">&quot;&quot;</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>(dt))<span class="op">;</span></span>
<span id="cb17-32"><a href="#cb17-32"></a>}<span class="op">;</span></span></code></pre></div>
      <p>日時設定UIを操作して日時を選択すると
      <code>e.target.value</code> からは <span
      class="masked">「2024-11-30T15:30」のようなISO8601形式の文字列</span>
      が得られます。実際に <strong>第30行目</strong>
      のコンソール出力の内容を確認してください。また、以下の図のように日時設定UIで「<strong>削除</strong>」を選択したときは
      <code>e.target.value</code> からは <strong>空文字</strong>
      (<code>""</code>) が得られます。</p>
      <figure>
      <img src="figs/05/app_08.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>このような「<strong>2024-11-30T15:30形式の文字列</strong>」もしくは「<strong>空文字</strong>」を、<code>Date | null</code>
      型の <code>deadline</code>
      にセットするために、<strong>第31行目</strong> では
      <code>dt === "" ? null : new Date(dt)</code> のように
      <strong>条件演算子</strong> を使った変換をしています。条件演算子
      (三項演算子) については<a
      href="lecture02.html#三項演算子">第02回講義</a>で学習済みです。</p>
      <p>これにより、<code>dt === ""</code>
      が「真」となるとき、<code>newTodoDeadline</code> には
      <code>null</code> がセットされます。また、そうでないときは <span
      class="masked"><code>new Date("2024-11-30T15:30")</code>
      で生成される「Data型オブジェクト」</span>が
      <code>newTodoDeadline</code> にセットされます。<a
      href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Date">Dateクラス</a>は
      <code>"2024-11-30T15:30"</code>
      形式の文字列を使った初期化にも対応しています
      (ただし、ブラウザ互換性などを考慮して、より安全に使用するためには
      <code>new Date(Date.parse(dt))</code>
      とすることが<strong>推奨</strong>されます)。</p>
      <p>なお、空文字 <code>""</code> は、単体で <code>false</code>
      として評価されるため (<span
      class="masked">空文字は「falsyな値」であるため</span>)、<strong>第31行目</strong>は、次のように記述することもできます。</p>
      <div class="sourceCode" id="cb18"
      data-caption="src/App.tsx (抜粋)" data-startFrom="31"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript" style="counter-reset: source-line 30;"><span id="cb18-31"><a href="#cb18-31"></a><span class="fu">setNewTodoDeadline</span>(dt <span class="op">?</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="bu">Date</span><span class="op">.</span><span class="fu">parse</span>(dt)) <span class="op">:</span> <span class="dt">null</span>)<span class="op">;</span></span></code></pre></div>
      <h2 data-number="5.2" id="日時情報の更新-コードui"><span
      class="header-section-number">5.2</span> 日時情報の更新
      (コード→UI)</h2>
      <p>上記とは逆に、<code>Date | null</code> 型の
      <code>deadline</code> から、日時設定UI (日時設定フォーム)
      に値を反映させるために、 <strong>第101行目</strong>
      で以下のように工夫を行なって <strong>value属性</strong>
      を設定しています。</p>
      <div class="sourceCode" id="cb19"
      data-caption="src/App.tsx (抜粋)" data-startFrom="98"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript" style="counter-reset: source-line 97;"><span id="cb19-98"><a href="#cb19-98"></a><span class="op">&lt;</span>input</span>
<span id="cb19-99"><a href="#cb19-99"></a>  <span class="kw">type</span><span class="op">=</span><span class="st">&quot;datetime-local&quot;</span></span>
<span id="cb19-100"><a href="#cb19-100"></a>  id<span class="op">=</span><span class="st">&quot;deadline&quot;</span></span>
<span id="cb19-101"><a href="#cb19-101"></a>  value<span class="op">=</span>{</span>
<span id="cb19-102"><a href="#cb19-102"></a>    newTodoDeadline</span>
<span id="cb19-103"><a href="#cb19-103"></a>      <span class="op">?</span> <span class="fu">dayjs</span>(newTodoDeadline)<span class="op">.</span><span class="fu">format</span>(<span class="st">&quot;YYYY-MM-DDTHH:mm:ss&quot;</span>)</span>
<span id="cb19-104"><a href="#cb19-104"></a>      <span class="op">:</span> <span class="st">&quot;&quot;</span></span>
<span id="cb19-105"><a href="#cb19-105"></a>  }</span>
<span id="cb19-106"><a href="#cb19-106"></a>  onChange<span class="op">=</span>{updateDeadline}</span>
<span id="cb19-107"><a href="#cb19-107"></a>  className<span class="op">=</span><span class="st">&quot;rounded-md border border-gray-400 px-2 py-0.5&quot;</span></span>
<span id="cb19-108"><a href="#cb19-108"></a><span class="op">/&gt;</span></span></code></pre></div>
      <p><code>null</code> は単体で <code>false</code> の扱いになるため
      (<span class="masked"><code>null</code>
      は「falsyな値」であるため</span>)、<code>newTodoDeadline</code> が
      <code>null</code> のときは、value属性に「空文字 <code>""</code>
      」がセットされます。</p>
      <p>一方で <code>newTodoDeadline</code> が <code>null</code>
      以外のときは、<code>dayjs</code>
      を利用してvalue属性に「ISO8601形式
      <code>"YYYY-MM-DDTHH:mm:ss"</code>
      に変換された文字列」がセットされるようにしています (注意:
      ここでは<strong>「秒」まで指定しないと Safari
      では意図した動作をしない可能性</strong>があります)。</p>
      <p>このように「日時」に関しては、<span
      class="masked">コードとUIの間で双方向の型変換</span>
      が必要となり、ブラウザによる挙動の違い
      (対応している日時フォーマットの違い)
      や<strong>タイムゾーン</strong>、使用するライブラリを十分に考慮しながら慎重に実装する必要があります。</p>
      <h2 data-number="5.3" id="truthyな値とfalsyな値"><span
      class="header-section-number">5.3</span>
      「truthyな値」と「falsyな値」</h2>
      <p>JavaScript / TypeScript において、<strong>条件式</strong>
      (<code>if</code>文の条件部分や<a
      href="lecture02.html#三項演算子">条件演算子</a>の条件部分など) で
      <span class="masked">論理値として評価されるとき</span>
      に、<code>true</code>
      と解釈される値を「<strong>truthyな値</strong>」、<code>false</code>
      と解釈される値を「falsyな値」といいます。</p>
      <p>「<strong>falsyな値</strong>」は
      <code>false</code>、<code>""</code>（空文字）、<code>null</code>、<code>undefined</code>、<code>0</code>、<code>-0</code>、<code>0n</code>、<code>NaN</code>で、それ以外は
      「<strong>truthyな値</strong>」となります。</p>
      <p>特に注意すべきは、<code>[]</code> (空配列) や、<code>{}</code>
      (空オブジェクト)、<code>"0"</code> (文字列の0) で、これらは <span
      class="masked">truthyな値</span> となります。</p>
      <ul>
      <li>参考: <code>0n</code> は<a
      href="https://www.google.com/search?q=javascript+bigintとは">BigInt</a>という非常に大きな整数
      (Number型の範囲を超えるような値)
      を扱うためのデータ型における「0」です。</li>
      </ul>
      <h3 data-number="5.3.1" id="定着確認"><span
      class="header-section-number">5.3.1</span> 定着確認</h3>
      <p>定数 <code>hoge</code> に代入される値を答えよ。</p>
      <ul>
      <li><code>const hoge = "" ? "truthyな値" : "falsyな値";</code>
      <ul>
      <li>答え <span
      class="masked"><code>"falsyな値"</code>・偽と解釈</span></li>
      </ul></li>
      <li><code>const hoge = 0.000 ? "truthyな値" : "falsyな値";</code>
      <ul>
      <li>答え <span
      class="masked"><code>"falsyな値"</code>・偽と解釈</span></li>
      </ul></li>
      <li><code>const hoge = "0" ? "truthyな値" : "falsyな値";</code>
      <ul>
      <li>答え <span
      class="masked"><code>"truthyな値"</code>・真と解釈</span></li>
      </ul></li>
      <li><code>const hoge = null ? "truthyな値" : "falsyな値";</code>
      <ul>
      <li>答え <span
      class="masked"><code>"falsyな値"</code>・偽と解釈</span></li>
      </ul></li>
      <li><code>const hoge = [] ? "truthyな値" : "falsyな値";</code>
      <ul>
      <li>答え <span
      class="masked"><code>"truthyな値"</code>・真と解釈</span></li>
      </ul></li>
      <li><code>const hoge = [false] ? "truthyな値" : "falsyな値";</code>
      <ul>
      <li>答え <span
      class="masked"><code>"truthyな値"</code>・真と解釈</span></li>
      </ul></li>
      </ul>
      <p>確認には<a
      href="https://paiza.io/ja/projects/new">paiza.io</a>などを利用してください。</p>
      <h1 data-number="6" id="バリデーション"><span
      class="header-section-number">6</span> バリデーション</h1>
      <p>現状では、新規タスクの「名前」のテキストボックスが空欄であっても、「追加」のボタンを押下すればタスクが追加できてしまいます。ここでは「<strong>2文字以上、32文字以内でテキストボックスに名前が入力されていないとき」はタスクが追加できないように設定</strong>していきます。</p>
      <p>単純には「addNewTodo関数」の先頭に、次のような処理
      (<strong>第02行目～第04行目</strong>)
      を追加すれば、この処理が可能になります。実際に試してみてください。</p>
      <div class="sourceCode" id="cb20"
      data-caption="src/App.tsx (抜粋・バリデーション機能の実装)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">const</span> addNewTodo <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="cf">if</span> (newTodoName<span class="op">.</span><span class="at">length</span> <span class="op">&lt;</span> <span class="dv">2</span> <span class="op">||</span> newTodoName<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">32</span>) {</span>
<span id="cb20-3"><a href="#cb20-3"></a>    <span class="cf">return</span><span class="op">;</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>  }</span>
<span id="cb20-5"><a href="#cb20-5"></a>  <span class="kw">const</span> newTodo<span class="op">:</span> Todo <span class="op">=</span> {</span>
<span id="cb20-6"><a href="#cb20-6"></a>    id<span class="op">:</span> <span class="fu">uuid</span>()<span class="op">,</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>    name<span class="op">:</span> newTodoName<span class="op">,</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>    isDone<span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>    priority<span class="op">:</span> newTodoPriority<span class="op">,</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>    deadline<span class="op">:</span> newTodoDeadline<span class="op">,</span></span>
<span id="cb20-11"><a href="#cb20-11"></a>  }<span class="op">;</span></span>
<span id="cb20-12"><a href="#cb20-12"></a>  <span class="kw">const</span> updatedTodos <span class="op">=</span> [<span class="op">...</span>todos<span class="op">,</span> newTodo]<span class="op">;</span></span>
<span id="cb20-13"><a href="#cb20-13"></a>  <span class="fu">setTodos</span>(updatedTodos)<span class="op">;</span></span>
<span id="cb20-14"><a href="#cb20-14"></a>  <span class="fu">setNewTodoName</span>(<span class="st">&quot;&quot;</span>)<span class="op">;</span></span>
<span id="cb20-15"><a href="#cb20-15"></a>  <span class="fu">setNewTodoPriority</span>(<span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb20-16"><a href="#cb20-16"></a>  <span class="fu">setNewTodoDeadline</span>(<span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb20-17"><a href="#cb20-17"></a>}<span class="op">;</span></span></code></pre></div>
      <p>上記の処理によって、「追加」のボタンを押下しても
      <code>newTodoName</code>
      が条件を満たしていなければタスクが追加できないようになりました。しかし、このままでは
      <strong>UI/UX 的には大きな課題</strong>が残ります
      (ユーザが「<strong>なぜタスクが追加できないのか</strong>」に気づきづらい不親切な
      UI/UX になっている)。</p>
      <p>そこで、条件を満たしていないときは、以下のように<strong>画面上に注意喚起のメッセージを表示</strong>するようにアプリを改良していきます。このために
      <code>newTodoNameError</code> という <strong>文字列型の変数
      (状態)</strong>
      を導入します。そして、テキストボックスに入力されている値が適切であれば、この
      <code>newTodoNameError</code> には空文字 <code>""</code>
      が格納し、そうでないときは <span
      class="masked">不備を指摘する文字列</span>
      を格納するようにします。また、<code>newTodoNameError</code>
      を参照して、不備があるときは <span
      class="masked">「追加」ボタンが押下できない</span>
      ようにします。</p>
      <figure>
      <img src="figs/05/app_09.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <ul>
      <li>このバリデーションを実装した <code>src/App.tsx</code>
      の全体のコードは<a
      href="https://github.com/TakeshiWada1980/Programming3-2024/blob/main/docs/codes/05/code02.tsx">こちら<i class="fa-solid fa-person-chalkboard"></i></a>を参照してください。まずは、コピペして動作を確認することからはじめたほうが分かりやすいと思います。</li>
      </ul>
      <p>特に <strong>第81行目</strong> から <strong>第110行目</strong>
      にかけて大幅に書き換えをしています
      (その他の部分についても編集や追記があるので注意してください)。</p>
      <div class="sourceCode" id="cb21"
      data-caption="src/App.tsx (抜粋)" data-startFrom="81"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript" style="counter-reset: source-line 80;"><span id="cb21-81"><a href="#cb21-81"></a>{<span class="co">/* 編集: ここから... */</span>}</span>
<span id="cb21-82"><a href="#cb21-82"></a><span class="op">&lt;</span>div<span class="op">&gt;</span></span>
<span id="cb21-83"><a href="#cb21-83"></a>  <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;flex items-center space-x-2&quot;</span><span class="op">&gt;</span></span>
<span id="cb21-84"><a href="#cb21-84"></a>    <span class="op">&lt;</span>label className<span class="op">=</span><span class="st">&quot;font-bold&quot;</span> htmlFor<span class="op">=</span><span class="st">&quot;newTodoName&quot;</span><span class="op">&gt;</span></span>
<span id="cb21-85"><a href="#cb21-85"></a>      名前</span>
<span id="cb21-86"><a href="#cb21-86"></a>    <span class="op">&lt;/</span>label<span class="op">&gt;</span></span>
<span id="cb21-87"><a href="#cb21-87"></a>    <span class="op">&lt;</span>input</span>
<span id="cb21-88"><a href="#cb21-88"></a>      id<span class="op">=</span><span class="st">&quot;newTodoName&quot;</span></span>
<span id="cb21-89"><a href="#cb21-89"></a>      <span class="kw">type</span><span class="op">=</span><span class="st">&quot;text&quot;</span></span>
<span id="cb21-90"><a href="#cb21-90"></a>      value<span class="op">=</span>{newTodoName}</span>
<span id="cb21-91"><a href="#cb21-91"></a>      onChange<span class="op">=</span>{updateNewTodoName}</span>
<span id="cb21-92"><a href="#cb21-92"></a>      className<span class="op">=</span>{<span class="fu">twMerge</span>(</span>
<span id="cb21-93"><a href="#cb21-93"></a>        <span class="st">&quot;grow rounded-md border p-2&quot;</span><span class="op">,</span></span>
<span id="cb21-94"><a href="#cb21-94"></a>        newTodoNameError <span class="op">&amp;&amp;</span> <span class="st">&quot;border-red-500 outline-red-500&quot;</span></span>
<span id="cb21-95"><a href="#cb21-95"></a>      )}</span>
<span id="cb21-96"><a href="#cb21-96"></a>      placeholder<span class="op">=</span><span class="st">&quot;2文字以上、32文字以内で入力してください&quot;</span></span>
<span id="cb21-97"><a href="#cb21-97"></a>    <span class="op">/&gt;</span></span>
<span id="cb21-98"><a href="#cb21-98"></a>  <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb21-99"><a href="#cb21-99"></a>  {newTodoNameError <span class="op">&amp;&amp;</span> (</span>
<span id="cb21-100"><a href="#cb21-100"></a>    <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;ml-10 flex items-center space-x-1 text-sm font-bold text-red-500 &quot;</span><span class="op">&gt;</span></span>
<span id="cb21-101"><a href="#cb21-101"></a>      <span class="op">&lt;</span>FontAwesomeIcon</span>
<span id="cb21-102"><a href="#cb21-102"></a>        icon<span class="op">=</span>{faTriangleExclamation}</span>
<span id="cb21-103"><a href="#cb21-103"></a>        className<span class="op">=</span><span class="st">&quot;mr-0.5&quot;</span></span>
<span id="cb21-104"><a href="#cb21-104"></a>      <span class="op">/&gt;</span></span>
<span id="cb21-105"><a href="#cb21-105"></a>      <span class="op">&lt;</span>div<span class="op">&gt;</span>{newTodoNameError}<span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb21-106"><a href="#cb21-106"></a>    <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb21-107"><a href="#cb21-107"></a>  )}</span>
<span id="cb21-108"><a href="#cb21-108"></a><span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb21-109"><a href="#cb21-109"></a>{<span class="co">/* ...ここまで */</span>}</span></code></pre></div>
      <p>このコードのなかで特に注意してほしいのは
      <strong>第99行目</strong> の論理演算子 <code>&amp;&amp;</code>
      を使った処理になります。この処理は、React
      では頻繁に使用されるテクニックで <span
      class="masked">条件付きレンダリング</span> と呼ばれます。</p>
      <p>React のJSX構文のなかで、例えば
      <code>{ hoge &amp;&amp; (&lt;div&gt;こんにちは&lt;/div&gt;)}</code>
      というコードを書くと、変数 <code>hoge</code> が
      <code>false</code>、<code>null</code>、<code>undefined</code>
      のいずれかのときは、<strong>そこに何もレンダリングされません</strong>
      (つまり <code>{...}</code>
      の部分が存在していないのと同等の扱いとなります)。</p>
      <p>一方で、<code>hoge</code> が <strong>truthyな値</strong>
      のときは <code>&lt;div&gt;こんにちは&lt;/div&gt;</code>
      がレンダリングされます。ただし、<strong>falseな値</strong> でも
      <code>0</code> と <code>""</code>
      は例外的に、以下のようになるので注意してください。</p>
      <ul>
      <li><code>hoge</code> が <code>0</code> のときは、<span
      class="masked">数値の「0」がレンダリング</span> されます。</li>
      <li><code>hoge</code> が空文字 <code>""</code>
      のときは<strong>空文字がレンダリング</strong>されます（画面上には何も表示されませんが、DOM上には存在します）</li>
      </ul>
      <p>同様に、<strong>第94行目</strong>
      でもこのテクニックを使用しています。<code>twMerge</code> は<a
      href="lecture04.html#準備-ライブラリのインストール">前回講義</a>でインストールした
      <strong>tailwind-merge ライブラリ</strong>
      から、以下のようにインポートしている関数です。この
      <code>twMerge</code> は <span class="masked">Tailwind CSS
      のクラスを衝突を回避しながら結合する機能を持った関数</span>
      となります。</p>
      <div class="sourceCode" id="cb22"
      data-caption="src/App.tsx (抜粋)" data-startFrom="8"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript" style="counter-reset: source-line 7;"><span id="cb22-8"><a href="#cb22-8"></a><span class="im">import</span> { twMerge } <span class="im">from</span> <span class="st">&quot;tailwind-merge&quot;</span><span class="op">;</span> <span class="co">// ◀◀ 追加</span></span></code></pre></div>
      <p><strong>第92行目</strong>の
      <code>twMerge("grow rounded-md border p-2", newTodoNameError &amp;&amp; "border-red-500 outline-red-500")}</code>
      は、<code>newTodoNameError</code> が「<strong>空文字</strong>
      <code>""</code> のとき」は <span
      class="masked"><code>twMerge("grow rounded-md border p-2")</code></span>
      と等価になります。</p>
      <p>そうでないときは
      <code>twMerge("grow rounded-md border p-2", "border-red-500 outline-red-500")}</code>
      と等価になります。つまり、新規タスクの名前に不備があるとき
      (文字数が 2文字以上32文字以内になっていないとき) <span
      class="masked">テキストボックスの枠を赤線にするクラスを追加する仕組み</span>
      をつくっています。</p>
      <p><code>twMerge</code> の必要性については <a
      href="https://www.youtube.com/watch?v=LMixhEfxI9k">Tailwind
      CSS初心者が絶対ハマる落とし穴</a>@ ムーザルちゃんねる (動画)
      を参考にしてください。</p>
      <h2 data-number="6.1" id="補足-react-hook-form-と-zod"><span
      class="header-section-number">6.1</span> 補足: React Hook Form と
      Zod</h2>
      <p>Reactにおいて、テキストボックスやラジオボタンなどを用いた
      <strong>フォーム処理</strong> には<a
      href="https://www.react-hook-form.com/">ReactHookForm</a>というライブラリが活用できます。このTodoアプリのように入力項目が少ない場合は、現状のように
      useState
      を使ったシンプルな実装で十分ですが、フォームの規模が大きくなるほど
      <strong>ReactHookFormの導入効果</strong> が高まります。</p>
      <p>また、フォームのバリデーションには<a
      href="https://www.google.com/search?q=react+zodとは">zod</a>というライブラリが活用できます。これは、ReactHookFormと組み合わせて使用可能であり、以下ような型安全なバリデーションルールを宣言的に記述できます。TypeScriptとの相性も良く、入力値の型推論も自動的に行われるため、開発効率の向上が期待できます。</p>
      <ul>
      <li>必須項目のチェック</li>
      <li>文字数制限や数値範囲の検証</li>
      <li>メールアドレスや電話番号などの形式チェック</li>
      <li>カスタムバリデーションルールの追加</li>
      </ul>
      <p>フロントエンド開発を目指す人は、これらのライブラリを積極的に利用して<a
      href="lecture05.html#課題1">課題1</a>に取り組んでください。</p>
      <h1 data-number="7" id="既存todoの-完了未完了-の切り替え"><span
      class="header-section-number">7</span> 既存Todoの 完了/未完了
      の切り替え</h1>
      <p>既存の Todo について <code>isDone</code> の
      <code>true</code>/<code>false</code>
      を切り替える機能を実装します。ここでは、次のように
      <strong>チェックボックス</strong> と紐づけて <code>isDone</code>
      の値 (つまり完了/未完了) を切り替えるようにしていきます。</p>
      <figure>
      <img src="figs/05/app_10.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <div class="note type-caution">
      <p>ここからは<strong>意図的に</strong> <code>App.tsx</code>
      <strong>と</strong> <code>TodoList.tsx</code>
      <strong>の全体コードを提供しません</strong>。ここまでの内容を十分に理解し、以降で提供されるコードの断片を「<strong>自分のコードのどこに配置すればよいか？</strong>」を考えながら作業を進めてください。</p>
      </div>
      <p>まずは、<code>src/App.tsx</code> のなかに、次のような
      <code>updateIsDone</code> 関数を追加します。</p>
      <div class="sourceCode" id="cb23"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">const</span> updateIsDone <span class="op">=</span> (id<span class="op">:</span> <span class="dt">string</span><span class="op">,</span> value<span class="op">:</span> <span class="dt">boolean</span>) <span class="kw">=&gt;</span> {<span class="op">...</span>}</span></code></pre></div>
      <p>この関数は、引数で受け取った <code>id</code> と一致する Todo
      について、その <code>isDone</code> プロパティの値を引数
      <code>value</code> の値で上書きするものです。例えば
      <code>updateIsDone("a001",false)</code>
      のように関数をコールしたら、<code>id</code> が <code>a001</code>
      のTodoの <code>isDone</code> を <code>false</code>
      に更新する機能を持たせます。特に、<code>todos</code>
      が変更されたことを <strong>React が確実に検知できるように</strong>
      <span
      class="masked">「<code>map</code>」と「スプレッド構文」を使ってイミュータブルな操作</span>
      で処理するように実装する必要があります。</p>
      <ul>
      <li><a
      href="lecture03.html#イミュータブルなオブジェクト更新">スプレッド構文によるイミュータブルなオブジェクト更新</a><span
      class="citation" data-cites="第03回講義">@第03回講義</span></li>
      </ul>
      <p>次の <code>updateIsDone</code> を <code>src/App.tsx</code>
      のなかの <strong>適切な位置</strong> に追記してください。</p>
      <div class="sourceCode" id="cb24"
      data-caption="src/App.tsx (抜粋・updateIsDone関数の追加) "><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">const</span> updateIsDone <span class="op">=</span> (id<span class="op">:</span> <span class="dt">string</span><span class="op">,</span> value<span class="op">:</span> <span class="dt">boolean</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="kw">const</span> updatedTodos <span class="op">=</span> todos<span class="op">.</span><span class="fu">map</span>((todo) <span class="kw">=&gt;</span> {</span>
<span id="cb24-3"><a href="#cb24-3"></a>    <span class="cf">if</span> (todo<span class="op">.</span><span class="at">id</span> <span class="op">===</span> id) {</span>
<span id="cb24-4"><a href="#cb24-4"></a>      <span class="cf">return</span> { <span class="op">...</span>todo<span class="op">,</span> isDone<span class="op">:</span> value }<span class="op">;</span> <span class="co">// スプレッド構文</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>    } <span class="cf">else</span> {</span>
<span id="cb24-6"><a href="#cb24-6"></a>      <span class="cf">return</span> todo<span class="op">;</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>    }</span>
<span id="cb24-8"><a href="#cb24-8"></a>  })<span class="op">;</span></span>
<span id="cb24-9"><a href="#cb24-9"></a>  <span class="fu">setTodos</span>(updatedTodos)<span class="op">;</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>}<span class="op">;</span></span></code></pre></div>
      <p>次に <code>src/TodoList.tsx</code>
      において、各Todoの情報を表示している UI に
      <strong>チェックボックス</strong> を追加し、そこに
      <code>checked={todo.isDone}</code>
      の属性を設定して「<strong>完了/未完了の状態</strong>
      (<code>isDone</code>プロパティ)」と「<strong>チェックボックスのオンオフ</strong>」を連動させます。</p>
      <p>以下のコードを参考に、<code>src/TodoList.tsx</code>
      のなかでTodoの情報を表示している UI
      に「チェックボックス」を追加してください。</p>
      <div class="sourceCode" id="cb25"
      data-caption="src/TodoList.tsx (抜粋)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb25-1"><a href="#cb25-1"></a><span class="op">&lt;</span>div<span class="op">&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  {todos<span class="op">.</span><span class="fu">map</span>((todo) <span class="kw">=&gt;</span> (</span>
<span id="cb25-3"><a href="#cb25-3"></a>    {<span class="co">/* 略 */</span>}</span>
<span id="cb25-4"><a href="#cb25-4"></a>    <span class="op">&lt;</span>input</span>
<span id="cb25-5"><a href="#cb25-5"></a>      <span class="kw">type</span><span class="op">=</span><span class="st">&quot;checkbox&quot;</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>      checked<span class="op">=</span>{todo<span class="op">.</span><span class="at">isDone</span>} <span class="co">// ◀◀ 注目</span></span>
<span id="cb25-7"><a href="#cb25-7"></a>      className<span class="op">=</span><span class="st">&quot;mr-1.5 cursor-pointer&quot;</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>    <span class="op">/&gt;</span></span>
<span id="cb25-9"><a href="#cb25-9"></a>    {<span class="co">/* 略 */</span>}</span>
<span id="cb25-10"><a href="#cb25-10"></a>  )}</span>
<span id="cb25-11"><a href="#cb25-11"></a><span class="op">&lt;/</span>div<span class="op">&gt;</span></span></code></pre></div>
      <p>これを実装すると、次のように Todo の UI に
      <strong>チェックボックス</strong> がついて、<code>isDone</code>
      の値 (初期値) を反映した <strong>オン/オフ</strong>
      がつきます。ただし、現状では、まだ <span
      class="masked">チェックボックスをクリックしてもオンオフが変化</span>
      しません。</p>
      <p>デベロッパーツールを確認すると、コンソール出力には「<strong>You
      provided a ‘checked’ prop to a form field without an ‘onChange’
      handler. This will render a read-only field. If the field should
      be mutable use ‘defaultChecked’. Otherwise, set either ‘onChange’
      or ‘readOnly’.</strong>」 という警告が表示されています。</p>
      <figure>
      <img src="figs/05/app_10.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p><strong>チェックボックスのクリックによって</strong>、当該Todoの
      <code>isDone</code>
      プロパティを変更して、UI表示も更新するためには、<span
      class="masked">先に定義した「updateIsDone関数」をコールする</span>
      必要があります。</p>
      <p>ただし、<code>updateIsDone</code> 関数は Appコンポーネント
      (<code>src/App.tsx</code>)
      の内部に定義しているため、<code>src/TodoList.tsx</code>
      からは<strong>直接的にコールすることはできません</strong>。このようなとき、React
      では <strong>Props
      を使って親コンポーネントから子コンポーネントに「関数」を渡す</strong>
      ということで解決します。</p>
      <ul>
      <li>「<strong>Props (プロップス) って何?</strong>」という人は<a
      href="lecture04.html#todoアプリの実装">前回講義の内容</a>の復習からはじめてください。</li>
      </ul>
      <p>まずは、<code>src/TodoList.tsx</code> において、Props 経由で
      <code>updateIsDone</code> を受け取れるように
      <strong>Propsの型定義</strong> を次のように変更します。これにより
      <span
      class="masked">文字列型と真偽値型の引数を持ち、戻り値がない関数を
      <code>updateIsDone</code> という名前</span>
      で受け取れるようになります。</p>
      <div class="sourceCode" id="cb26"
      data-caption="src/TodoList.tsx (抜粋)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">type</span> Props <span class="op">=</span> {</span>
<span id="cb26-2"><a href="#cb26-2"></a>  todos<span class="op">:</span> Todo[]<span class="op">;</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>  updateIsDone<span class="op">:</span> (id<span class="op">:</span> <span class="dt">string</span><span class="op">,</span> value<span class="op">:</span> <span class="dt">boolean</span>) <span class="kw">=&gt;</span> <span class="dt">void</span><span class="op">;</span> <span class="co">// ◀◀ 追加</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>}<span class="op">;</span></span></code></pre></div>
      <p>また、ユーザによってチェックボックスが操作されたタイミングで、Props
      経由で受け取った <code>updateIsDone</code>
      をコールするように、チェックボックスの「<strong>onChange属性</strong>」を次のように設定します。ここでは、先に紹介したように<a
      href="lecture05.html#補足-onchange属性の設定">onChangeにアロー関数形式で直接的に処理を記述</a>しています。</p>
      <div class="sourceCode" id="cb27"
      data-caption="src/TodoList.tsx (抜粋)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb27-1"><a href="#cb27-1"></a><span class="op">&lt;</span>input</span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="kw">type</span><span class="op">=</span><span class="st">&quot;checkbox&quot;</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  checked<span class="op">=</span>{todo<span class="op">.</span><span class="at">isDone</span>}</span>
<span id="cb27-4"><a href="#cb27-4"></a>  onChange<span class="op">=</span>{(e) <span class="kw">=&gt;</span> props<span class="op">.</span><span class="fu">updateIsDone</span>(todo<span class="op">.</span><span class="at">id</span><span class="op">,</span> e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">checked</span>)}</span>
<span id="cb27-5"><a href="#cb27-5"></a>  className<span class="op">=</span><span class="st">&quot;mr-1.5 cursor-pointer&quot;</span></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="op">/&gt;</span></span></code></pre></div>
      <p>最後に <code>src/App.tsx</code>
      のなかで、TodoListコンポーネントに対して「updateIsDone関数」を渡すように変更します。</p>
      <div class="sourceCode" id="cb28"
      data-caption="src/App.tsx (抜粋・変更前)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb28-1"><a href="#cb28-1"></a><span class="op">&lt;</span>TodoList todos<span class="op">=</span>{todos}<span class="op">/&gt;</span></span></code></pre></div>
      <div class="sourceCode" id="cb29"
      data-caption="src/App.tsx (抜粋・変更後)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb29-1"><a href="#cb29-1"></a><span class="op">&lt;</span>TodoList todos<span class="op">=</span>{todos} updateIsDone<span class="op">=</span>{updateIsDone} <span class="op">/&gt;</span></span></code></pre></div>
      <p>以上で、チェックボックスを操作して「<strong>既存のTodoの完了/未完了を切り替えること</strong>」が可能になりました。内部的にも
      <code>todos</code> のなかの当該Todoの <code>isDone</code>
      プロパティが変更されています。</p>
      <h2 data-number="7.1"
      id="ng実装ミュータブルな操作でオブジェクト配列の要素を変更"><span
      class="header-section-number">7.1</span>
      NG実装：ミュータブルな操作でオブジェクト配列の要素を変更</h2>
      <p>上記の解説では <code>updateIsDone</code>
      を次のようにスプレッド構文を使用して
      <strong>イミュータブルな操作</strong>
      で処理するように実装しました。</p>
      <div class="sourceCode" id="cb30"
      data-caption="(再掲) updateIsDone関数"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">const</span> updateIsDone <span class="op">=</span> (id<span class="op">:</span> <span class="dt">string</span><span class="op">,</span> value<span class="op">:</span> <span class="dt">boolean</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="kw">const</span> updatedTodos <span class="op">=</span> todos<span class="op">.</span><span class="fu">map</span>((todo) <span class="kw">=&gt;</span> {</span>
<span id="cb30-3"><a href="#cb30-3"></a>    <span class="cf">if</span> (todo<span class="op">.</span><span class="at">id</span> <span class="op">===</span> id) {</span>
<span id="cb30-4"><a href="#cb30-4"></a>      <span class="cf">return</span> { <span class="op">...</span>todo<span class="op">,</span> isDone<span class="op">:</span> value }<span class="op">;</span> <span class="co">// スプレッド構文</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>    } <span class="cf">else</span> {</span>
<span id="cb30-6"><a href="#cb30-6"></a>      <span class="cf">return</span> todo<span class="op">;</span></span>
<span id="cb30-7"><a href="#cb30-7"></a>    }</span>
<span id="cb30-8"><a href="#cb30-8"></a>  })<span class="op">;</span></span>
<span id="cb30-9"><a href="#cb30-9"></a>  <span class="fu">setTodos</span>(updatedTodos)<span class="op">;</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>}<span class="op">;</span></span></code></pre></div>
      <p>これを次のように<strong>ミュータブルな操作</strong>で処理してしまうと意図するように機能しなくなります。実際に書き換えて確かめてください。</p>
      <div class="sourceCode" id="cb31"
      data-caption="(NGな実装) updateIsDone関数"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">const</span> updateIsDone <span class="op">=</span> (id<span class="op">:</span> <span class="dt">string</span><span class="op">,</span> value<span class="op">:</span> <span class="dt">boolean</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="cf">for</span> (<span class="kw">const</span> todo <span class="kw">of</span> todos) {</span>
<span id="cb31-3"><a href="#cb31-3"></a>    <span class="cf">if</span> (todo<span class="op">.</span><span class="at">id</span> <span class="op">===</span> id) {</span>
<span id="cb31-4"><a href="#cb31-4"></a>      todo<span class="op">.</span><span class="at">isDone</span> <span class="op">=</span> value<span class="op">;</span> <span class="co">// オブジェクトを直接変更</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>    }</span>
<span id="cb31-6"><a href="#cb31-6"></a>  }</span>
<span id="cb31-7"><a href="#cb31-7"></a>  <span class="fu">setTodos</span>(todos)<span class="op">;</span></span>
<span id="cb31-8"><a href="#cb31-8"></a>}<span class="op">;</span></span></code></pre></div>
      <p>これは繰返し説明しているように、Reactでは画面の再レンダリングが「<strong>参照の変更を検知すること</strong>」で実行されるためです。上記のような処理では
      <code>setTodos(todos)</code> をコールしても、引数の
      <code>todos</code>
      参照が同じ配列を指したままとなるため、Reactは変更を検知せず再レンダリングは発生しません。</p>
      <h2 data-number="7.2"
      id="完了済みのタスクを削除するボタンの追加"><span
      class="header-section-number">7.2</span>
      完了済みのタスクを削除するボタンの追加</h2>
      <p>完了済みのタスクを一括削除する機能を実装します。<a
      href="lecture03.html#オブジェクト型の配列に対するfilterの適用">第03回講義</a>で学んだ「<strong>filter</strong>」を利用しています。</p>
      <p><code>src/App.tsx</code> に次の
      <code>removeCompletedTodos</code> 関数を追加してください。</p>
      <div class="sourceCode" id="cb32"
      data-caption="src/App.tsx (抜粋)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">const</span> removeCompletedTodos <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="kw">const</span> updatedTodos <span class="op">=</span> todos<span class="op">.</span><span class="fu">filter</span>((todo) <span class="kw">=&gt;</span> <span class="op">!</span>todo<span class="op">.</span><span class="at">isDone</span>)<span class="op">;</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">setTodos</span>(updatedTodos)<span class="op">;</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>}<span class="op">;</span></span></code></pre></div>
      <p>つづいて、<code>removeCompletedTodos</code>
      関数を呼び出すためのボタンを追加してください。</p>
      <div class="sourceCode" id="cb33"
      data-caption="src/App.tsx (抜粋)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb33-1"><a href="#cb33-1"></a><span class="op">&lt;</span>button</span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="kw">type</span><span class="op">=</span><span class="st">&quot;button&quot;</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>  onClick<span class="op">=</span>{removeCompletedTodos}</span>
<span id="cb33-4"><a href="#cb33-4"></a>  className<span class="op">=</span>{</span>
<span id="cb33-5"><a href="#cb33-5"></a>    <span class="st">&quot;mt-5 rounded-md bg-red-500 px-3 py-1 font-bold text-white hover:bg-red-600&quot;</span></span>
<span id="cb33-6"><a href="#cb33-6"></a>  }</span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="op">&gt;</span></span>
<span id="cb33-8"><a href="#cb33-8"></a>  完了済みのタスクを削除</span>
<span id="cb33-9"><a href="#cb33-9"></a><span class="op">&lt;/</span>button<span class="op">&gt;</span></span></code></pre></div>
      <p>「完了済みのタスクを削除」のボタンを押下することで、実際に完了済みタスクの一括削除ができることを確認してください。</p>
      <figure>
      <img src="figs/05/app_11.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h1 data-number="8" id="タスクの個別削除"><span
      class="header-section-number">8</span> タスクの個別削除</h1>
      <p>次のように完了/未完了に関係なく
      <strong>タスクを個別に削除する機能</strong> を実装します。</p>
      <figure>
      <img src="figs/05/app_12.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>まずは <code>src/App.tsx</code> のなかに、次の
      <code>remove</code> 関数を追加してください。これは引数で受け取った
      <code>id</code> に該当する Todo を削除する関数になります。</p>
      <div class="sourceCode" id="cb34"
      data-caption="src/App.tsx (抜粋)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">const</span> remove <span class="op">=</span> (id<span class="op">:</span> <span class="dt">string</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb34-2"><a href="#cb34-2"></a>  <span class="kw">const</span> updatedTodos <span class="op">=</span> todos<span class="op">.</span><span class="fu">filter</span>((todo) <span class="kw">=&gt;</span> todo<span class="op">.</span><span class="at">id</span> <span class="op">!==</span> id)<span class="op">;</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">setTodos</span>(updatedTodos)<span class="op">;</span></span>
<span id="cb34-4"><a href="#cb34-4"></a>}<span class="op">;</span></span></code></pre></div>
      <p>そして、この <code>remove</code> 関数を Props
      として「TodoListコンポーネント」に渡すようにします。</p>
      <div class="sourceCode" id="cb35"
      data-caption="src/App.tsx (抜粋)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb35-1"><a href="#cb35-1"></a><span class="op">&lt;</span>TodoList todos<span class="op">=</span>{todos} updateIsDone<span class="op">=</span>{updateIsDone} remove<span class="op">=</span>{remove} <span class="op">/&gt;</span></span></code></pre></div>
      <p>次に、<code>src/App.tsx</code>
      で、<strong>Propsの型定義</strong> を次のように変更します。</p>
      <div class="sourceCode" id="cb36"
      data-caption="src/TodoList.tsx (抜粋)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">type</span> Props <span class="op">=</span> {</span>
<span id="cb36-2"><a href="#cb36-2"></a>  todos<span class="op">:</span> Todo[]<span class="op">;</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>  updateIsDone<span class="op">:</span> (id<span class="op">:</span> <span class="dt">string</span><span class="op">,</span> value<span class="op">:</span> <span class="dt">boolean</span>) <span class="kw">=&gt;</span> <span class="dt">void</span><span class="op">;</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>  remove<span class="op">:</span> (id<span class="op">:</span> <span class="dt">string</span>) <span class="kw">=&gt;</span> <span class="dt">void</span><span class="op">;</span> <span class="co">// ◀◀ 追加</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>}<span class="op">;</span></span></code></pre></div>
      <p>さらに、個々のTodoを表示するUIに「削除」のボタンを追加し、クリックされたときに、<code>id</code>
      を引数にして <code>remove</code>
      関数をコールするようにします。</p>
      <div class="sourceCode" id="cb37"
      data-caption="src/TodoList.tsx (抜粋)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb37-1"><a href="#cb37-1"></a><span class="op">&lt;</span>button</span>
<span id="cb37-2"><a href="#cb37-2"></a>  onClick<span class="op">=</span>{() <span class="kw">=&gt;</span> props<span class="op">.</span><span class="fu">remove</span>(todo<span class="op">.</span><span class="at">id</span>)}</span>
<span id="cb37-3"><a href="#cb37-3"></a>  className<span class="op">=</span><span class="st">&quot;rounded-md bg-slate-200 px-2 py-1 text-sm font-bold text-white hover:bg-red-500&quot;</span></span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="op">&gt;</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>  削除</span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="op">&lt;/</span>button<span class="op">&gt;</span></span></code></pre></div>
      <h1 data-number="9"
      id="リファクタリング-コンポーネントに分割"><span
      class="header-section-number">9</span> リファクタリング:
      コンポーネントに分割</h1>
      <p>TodoListコンポーネントが肥大化してきたので、個々のTodoを「<strong>TodoItemコンポーネント</strong>
      (<code>src/TodoItem.tsx</code>)」に切り分けます。Reactでは、コンポーネントに分割可能なものは、できるだけコンポーネントに分割するようにしてください。</p>
      <p>実装例を以下に示します。</p>
      <p>まずは、個々のTodo情報を表示するための
      <code>src/TodoItem.tsx</code>
      を新規作成します。ほとんどの部分は、既存の
      <code>src/TodoList.tsx</code>
      から移植して作成できると思います。</p>
      <p><strong>(以下のコードは、必要最低限の情報とUIだけを記述したものです)</strong></p>
      <div class="sourceCode" id="cb38"
      data-caption="src/TodoItem.tsx (新規作成)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb38-1"><a href="#cb38-1"></a><span class="im">import</span> React <span class="im">from</span> <span class="st">&quot;react&quot;</span><span class="op">;</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="im">import</span> { Todo } <span class="im">from</span> <span class="st">&quot;./types&quot;</span><span class="op">;</span></span>
<span id="cb38-3"><a href="#cb38-3"></a></span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="kw">type</span> Props <span class="op">=</span> {</span>
<span id="cb38-5"><a href="#cb38-5"></a>  todo<span class="op">:</span> Todo<span class="op">;</span></span>
<span id="cb38-6"><a href="#cb38-6"></a>  updateIsDone<span class="op">:</span> (id<span class="op">:</span> <span class="dt">string</span><span class="op">,</span> value<span class="op">:</span> <span class="dt">boolean</span>) <span class="kw">=&gt;</span> <span class="dt">void</span><span class="op">;</span></span>
<span id="cb38-7"><a href="#cb38-7"></a>  remove<span class="op">:</span> (id<span class="op">:</span> <span class="dt">string</span>) <span class="kw">=&gt;</span> <span class="dt">void</span><span class="op">;</span></span>
<span id="cb38-8"><a href="#cb38-8"></a>}<span class="op">;</span></span>
<span id="cb38-9"><a href="#cb38-9"></a></span>
<span id="cb38-10"><a href="#cb38-10"></a><span class="kw">const</span> TodoItem <span class="op">=</span> (props<span class="op">:</span> Props) <span class="kw">=&gt;</span> {</span>
<span id="cb38-11"><a href="#cb38-11"></a>  <span class="kw">const</span> todo <span class="op">=</span> props<span class="op">.</span><span class="at">todo</span><span class="op">;</span></span>
<span id="cb38-12"><a href="#cb38-12"></a>  <span class="cf">return</span> (</span>
<span id="cb38-13"><a href="#cb38-13"></a>    <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;flex items-center justify-between&quot;</span><span class="op">&gt;</span></span>
<span id="cb38-14"><a href="#cb38-14"></a>      <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;flex items-center&quot;</span><span class="op">&gt;</span></span>
<span id="cb38-15"><a href="#cb38-15"></a>        <span class="op">&lt;</span>input</span>
<span id="cb38-16"><a href="#cb38-16"></a>          <span class="kw">type</span><span class="op">=</span><span class="st">&quot;checkbox&quot;</span></span>
<span id="cb38-17"><a href="#cb38-17"></a>          checked<span class="op">=</span>{todo<span class="op">.</span><span class="at">isDone</span>}</span>
<span id="cb38-18"><a href="#cb38-18"></a>          onChange<span class="op">=</span>{(e) <span class="kw">=&gt;</span> props<span class="op">.</span><span class="fu">updateIsDone</span>(todo<span class="op">.</span><span class="at">id</span><span class="op">,</span> e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">checked</span>)}</span>
<span id="cb38-19"><a href="#cb38-19"></a>          className<span class="op">=</span><span class="st">&quot;mr-1.5 cursor-pointer&quot;</span></span>
<span id="cb38-20"><a href="#cb38-20"></a>        <span class="op">/&gt;</span></span>
<span id="cb38-21"><a href="#cb38-21"></a>        {todo<span class="op">.</span><span class="at">name</span>}</span>
<span id="cb38-22"><a href="#cb38-22"></a>      <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb38-23"><a href="#cb38-23"></a>      <span class="op">&lt;</span>div<span class="op">&gt;</span></span>
<span id="cb38-24"><a href="#cb38-24"></a>        <span class="op">&lt;</span>button</span>
<span id="cb38-25"><a href="#cb38-25"></a>          onClick<span class="op">=</span>{() <span class="kw">=&gt;</span> props<span class="op">.</span><span class="fu">remove</span>(todo<span class="op">.</span><span class="at">id</span>)}</span>
<span id="cb38-26"><a href="#cb38-26"></a>          className<span class="op">=</span><span class="st">&quot;rounded-md bg-slate-200 px-2 py-1 text-sm font-bold text-white hover:bg-red-500&quot;</span></span>
<span id="cb38-27"><a href="#cb38-27"></a>        <span class="op">&gt;</span></span>
<span id="cb38-28"><a href="#cb38-28"></a>          削除</span>
<span id="cb38-29"><a href="#cb38-29"></a>        <span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb38-30"><a href="#cb38-30"></a>      <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb38-31"><a href="#cb38-31"></a>    <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb38-32"><a href="#cb38-32"></a>  )<span class="op">;</span></span>
<span id="cb38-33"><a href="#cb38-33"></a>}<span class="op">;</span></span>
<span id="cb38-34"><a href="#cb38-34"></a></span>
<span id="cb38-35"><a href="#cb38-35"></a><span class="im">export</span> <span class="im">default</span> TodoItem<span class="op">;</span></span></code></pre></div>
      <p>上記で新規作成した「TodoItemコンポーネント」を、既存の「TodoListコンポーネント」から呼び出すようにします。特に
      <strong>第03行目</strong> と、<strong>第24行目</strong> から
      <strong>第31行目</strong> に注目して読解してください。</p>
      <div class="sourceCode" id="cb39"
      data-caption="src/TodoList.tsx (編集)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb39-1"><a href="#cb39-1"></a><span class="im">import</span> React <span class="im">from</span> <span class="st">&quot;react&quot;</span><span class="op">;</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="im">import</span> { Todo } <span class="im">from</span> <span class="st">&quot;./types&quot;</span><span class="op">;</span></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="im">import</span> TodoItem <span class="im">from</span> <span class="st">&quot;./TodoItem&quot;</span><span class="op">;</span> <span class="co">// ◀◀ 追加</span></span>
<span id="cb39-4"><a href="#cb39-4"></a></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="kw">type</span> Props <span class="op">=</span> {</span>
<span id="cb39-6"><a href="#cb39-6"></a>  todos<span class="op">:</span> Todo[]<span class="op">;</span></span>
<span id="cb39-7"><a href="#cb39-7"></a>  updateIsDone<span class="op">:</span> (id<span class="op">:</span> <span class="dt">string</span><span class="op">,</span> value<span class="op">:</span> <span class="dt">boolean</span>) <span class="kw">=&gt;</span> <span class="dt">void</span><span class="op">;</span></span>
<span id="cb39-8"><a href="#cb39-8"></a>  remove<span class="op">:</span> (id<span class="op">:</span> <span class="dt">string</span>) <span class="kw">=&gt;</span> <span class="dt">void</span><span class="op">;</span></span>
<span id="cb39-9"><a href="#cb39-9"></a>}<span class="op">;</span></span>
<span id="cb39-10"><a href="#cb39-10"></a></span>
<span id="cb39-11"><a href="#cb39-11"></a><span class="kw">const</span> TodoList <span class="op">=</span> (props<span class="op">:</span> Props) <span class="kw">=&gt;</span> {</span>
<span id="cb39-12"><a href="#cb39-12"></a>  <span class="kw">const</span> todos <span class="op">=</span> props<span class="op">.</span><span class="at">todos</span><span class="op">;</span></span>
<span id="cb39-13"><a href="#cb39-13"></a></span>
<span id="cb39-14"><a href="#cb39-14"></a>  <span class="cf">if</span> (todos<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span>) {</span>
<span id="cb39-15"><a href="#cb39-15"></a>    <span class="cf">return</span> (</span>
<span id="cb39-16"><a href="#cb39-16"></a>      <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;text-red-500&quot;</span><span class="op">&gt;</span></span>
<span id="cb39-17"><a href="#cb39-17"></a>        現在、登録されているタスクはありません。</span>
<span id="cb39-18"><a href="#cb39-18"></a>      <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb39-19"><a href="#cb39-19"></a>    )<span class="op">;</span></span>
<span id="cb39-20"><a href="#cb39-20"></a>  }</span>
<span id="cb39-21"><a href="#cb39-21"></a></span>
<span id="cb39-22"><a href="#cb39-22"></a>  <span class="cf">return</span> (</span>
<span id="cb39-23"><a href="#cb39-23"></a>    <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;space-y-2&quot;</span><span class="op">&gt;</span></span>
<span id="cb39-24"><a href="#cb39-24"></a>      {todos<span class="op">.</span><span class="fu">map</span>((todo) <span class="kw">=&gt;</span> (</span>
<span id="cb39-25"><a href="#cb39-25"></a>        <span class="op">&lt;</span>TodoItem</span>
<span id="cb39-26"><a href="#cb39-26"></a>          key<span class="op">=</span>{todo<span class="op">.</span><span class="at">id</span>}</span>
<span id="cb39-27"><a href="#cb39-27"></a>          todo<span class="op">=</span>{todo}</span>
<span id="cb39-28"><a href="#cb39-28"></a>          remove<span class="op">=</span>{props<span class="op">.</span><span class="at">remove</span>}</span>
<span id="cb39-29"><a href="#cb39-29"></a>          updateIsDone<span class="op">=</span>{props<span class="op">.</span><span class="at">updateIsDone</span>}</span>
<span id="cb39-30"><a href="#cb39-30"></a>        <span class="op">/&gt;</span></span>
<span id="cb39-31"><a href="#cb39-31"></a>      ))}</span>
<span id="cb39-32"><a href="#cb39-32"></a>    <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb39-33"><a href="#cb39-33"></a>  )<span class="op">;</span></span>
<span id="cb39-34"><a href="#cb39-34"></a>}<span class="op">;</span></span>
<span id="cb39-35"><a href="#cb39-35"></a></span>
<span id="cb39-36"><a href="#cb39-36"></a><span class="im">export</span> <span class="im">default</span> TodoList<span class="op">;</span></span></code></pre></div>
      <h1 data-number="10"
      id="localstorageを利用したデータの永続化"><span
      class="header-section-number">10</span>
      LocalStorageを利用したデータの永続化</h1>
      <p>現状のTodoアプリは、Todoの追加や削除をしてもブラウザをリロード
      (再読み込み)
      すると初期状態に戻ってしまいます。このままでは、Todoアプリとして実用的に使えないため
      <span class="masked">データの永続化 (Data Persistence)</span>
      の機能が必要となります。「<strong>データの永続化</strong>」とは、簡単に言えば
      <strong>ブラウザをリロードしたとき</strong> や
      <strong>次回アクセスしたとき</strong>
      にも継続的にアプリを利用できるように <span
      class="masked">データや状態を不揮発性の領域に保存すること</span>
      です。</p>
      <p>ウェブアプリにおいて「データの永続化」は、通常、<strong>バックエンド側
      (サーバ側) でデータベース (RDBやNoSQLなど)</strong>
      を利用して実装されます。バックエンドでの実装することで、ユーザは異なるデバイスからアクセスしても
      (ユーザ認証を経たうえで) 継続的にアプリの利用ができます。</p>
      <p>しかし、まだ現時点ではバックエンド開発は学んでいないので、ここではブラウザの「<strong>LocalStorage</strong>」という機能を使って、<strong>フロントエンドでのデータの永続化</strong>
      を実装します。LocalStorage とは、ウェブブラウザに組み込まれている
      <strong>キーバリュー型のストレージ機能</strong> (Pythonの
      <code>dict</code> のようなシンプルな <span
      class="masked">「キー(key)」と「値(Value)」のペアでデータを保存する機能</span>)
      で、ブラウザを終了してもデータが残ることが特徴です。</p>
      <h2 data-number="10.1" id="localstorage-とは"><span
      class="header-section-number">10.1</span> LocalStorage とは</h2>
      <p>LocalStorageは、JavaScriptの <strong>Window.localStorage
      API</strong> を通じて利用可能で、保存可能なデータは <span
      class="masked">文字列 (string型) のみ</span>
      ですが、<strong>約5MB</strong>
      までのデータが保存可能となっています。</p>
      <p>LocalStorageは <strong>ブラウザごとに独立した保存領域</strong>
      を持ちます。例えば、https://hoge777.github.io/react-todo-app/
      にホストされた TodoApp
      に2人のユーザ「寝屋川タヌキ」と「萱島ウサギ」がアクセスした場合、各データは、各ユーザーが使用するデバイスのブラウザに独立して保存されます。そのため、例えば寝屋川タヌキが「高専に侵入」というTodoを追加しても、萱島ウサギは影響を受けません。</p>
      <div class="note type-tips">
      <p><strong>LocalStorage の容量制限</strong></p>
      <p>LocalStorage は、<strong>1オリジンあたり約5MB</strong>
      が一般的な容量制限になっています。ここでの「オリジン」とは「<strong>プロトコル（http/https）</strong>」「<strong>ドメイン</strong>」「<strong>ポート</strong>」の組み合わせを指します。</p>
      <p>例えば、Todoアプリを GitHub Pagaes
      にデプロイするとすれば、次のようになります。</p>
      <ul>
      <li>https://hoge777.github.io/react-todo-app/ の LocalStorage
      は約5MB</li>
      <li>https://hoge777.github.io/portfolio/ は「同じオリジン」なので
      <strong>上記とあわせて約5MB</strong></li>
      <li>https://lofoo123.github.io/ →
      異なるオリジンなので上記とは、別途、約5MB</li>
      </ul>
      <p>また、ローカル環境の開発サーバでホストするとすれば、次のようになります。</p>
      <ul>
      <li>http://localhost:3000/ の LocalStorage は約5MB</li>
      <li>http://localhost:5500/ は異なるオリジン (異なるポート番号)
      なので、上記とは別途約5MB</li>
      </ul>
      </div>
      <h3 data-number="10.1.1" id="定着確認-1"><span
      class="header-section-number">10.1.1</span> 定着確認</h3>
      <ul>
      <li>LocalStorage
      における1オリジンあたりの最大保存容量は約何MBか答えよ。
      <ul>
      <li>答え: <span class="masked">5MB</span></li>
      </ul></li>
      <li>同じデバイスで Edge と Chrome
      を使用しているとき、同一オリジンに対して各ブラウザは「独立したLocalStorageを持つ」か「共通のLocalStorageを持つ」か答えよ。
      <ul>
      <li>答え: <span
      class="masked">独立したLocalStorageを持つ</span></li>
      </ul></li>
      <li>LocalStorage
      に画像などのバイナリデータを保存することは「可能」か「不可能」か答えよ。
      <ul>
      <li>答え: <span
      class="masked">不可能。LocalStorageは文字列（String型）のデータしか保存できない。ただし、Base64などで文字列にエンコードすれば可能である。</span></li>
      </ul></li>
      </ul>
      <h2 data-number="10.2"
      id="localstorage-を利用した保存機能の実装"><span
      class="header-section-number">10.2</span> LocalStorage
      を利用した保存機能の実装</h2>
      <p>現在のTodoアプリに LocalStorage
      を組み込んでデータを永続化するには <code>src/App.tsx</code>
      に次のように実装します (<span
      class="masked"><code>useEffect</code> という Reactの Hook</span>
      の利用が実装のポイントとなります)。</p>
      <p>まずは、実際に動かしてみてください
      (<strong>リロードしてもTodoリストが初期状態に戻ってしまわないこと</strong>確認してください)。</p>
      <div class="sourceCode" id="cb40"
      data-caption="src/App.tsx (データの永続化)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb40-1"><a href="#cb40-1"></a><span class="im">import</span> { useState<span class="op">,</span> useEffect } <span class="im">from</span> <span class="st">&quot;react&quot;</span><span class="op">;</span> <span class="co">// ◀◀ 追加</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="co">// ～ 省略 ～</span></span>
<span id="cb40-3"><a href="#cb40-3"></a></span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="kw">const</span> App <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb40-5"><a href="#cb40-5"></a>  <span class="kw">const</span> [todos<span class="op">,</span> setTodos] <span class="op">=</span> <span class="fu">useState</span><span class="op">&lt;</span>Todo[]<span class="op">&gt;</span>([])<span class="op">;</span> <span class="co">// ◀◀ 編集</span></span>
<span id="cb40-6"><a href="#cb40-6"></a>  <span class="kw">const</span> [newTodoName<span class="op">,</span> setNewTodoName] <span class="op">=</span> <span class="fu">useState</span>(<span class="st">&quot;&quot;</span>)<span class="op">;</span></span>
<span id="cb40-7"><a href="#cb40-7"></a>  <span class="kw">const</span> [newTodoPriority<span class="op">,</span> setNewTodoPriority] <span class="op">=</span> <span class="fu">useState</span>(<span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb40-8"><a href="#cb40-8"></a>  <span class="kw">const</span> [newTodoDeadline<span class="op">,</span> setNewTodoDeadline] <span class="op">=</span> <span class="fu">useState</span><span class="op">&lt;</span><span class="bu">Date</span> <span class="op">|</span> <span class="dt">null</span><span class="op">&gt;</span>(<span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb40-9"><a href="#cb40-9"></a>  <span class="kw">const</span> [newTodoNameError<span class="op">,</span> setNewTodoNameError] <span class="op">=</span> <span class="fu">useState</span>(<span class="st">&quot;&quot;</span>)<span class="op">;</span></span>
<span id="cb40-10"><a href="#cb40-10"></a></span>
<span id="cb40-11"><a href="#cb40-11"></a>  <span class="kw">const</span> [initialized<span class="op">,</span> setInitialized] <span class="op">=</span> <span class="fu">useState</span>(<span class="kw">false</span>)<span class="op">;</span> <span class="co">// ◀◀ 追加</span></span>
<span id="cb40-12"><a href="#cb40-12"></a>  <span class="kw">const</span> localStorageKey <span class="op">=</span> <span class="st">&quot;TodoApp&quot;</span><span class="op">;</span> <span class="co">// ◀◀ 追加</span></span>
<span id="cb40-13"><a href="#cb40-13"></a></span>
<span id="cb40-14"><a href="#cb40-14"></a>  <span class="co">// App コンポーネントの初回実行時のみLocalStorageからTodoデータを復元</span></span>
<span id="cb40-15"><a href="#cb40-15"></a>  <span class="fu">useEffect</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb40-16"><a href="#cb40-16"></a>    <span class="kw">const</span> todoJsonStr <span class="op">=</span> localStorage<span class="op">.</span><span class="fu">getItem</span>(localStorageKey)<span class="op">;</span></span>
<span id="cb40-17"><a href="#cb40-17"></a>    <span class="cf">if</span> (todoJsonStr <span class="op">&amp;&amp;</span> todoJsonStr <span class="op">!==</span> <span class="st">&quot;[]&quot;</span>) {</span>
<span id="cb40-18"><a href="#cb40-18"></a>      <span class="kw">const</span> storedTodos<span class="op">:</span> Todo[] <span class="op">=</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">parse</span>(todoJsonStr)<span class="op">;</span></span>
<span id="cb40-19"><a href="#cb40-19"></a>      <span class="kw">const</span> convertedTodos <span class="op">=</span> storedTodos<span class="op">.</span><span class="fu">map</span>((todo) <span class="kw">=&gt;</span> ({</span>
<span id="cb40-20"><a href="#cb40-20"></a>        <span class="op">...</span>todo<span class="op">,</span></span>
<span id="cb40-21"><a href="#cb40-21"></a>        deadline<span class="op">:</span> todo<span class="op">.</span><span class="at">deadline</span> <span class="op">?</span> <span class="kw">new</span> <span class="bu">Date</span>(todo<span class="op">.</span><span class="at">deadline</span>) <span class="op">:</span> <span class="dt">null</span><span class="op">,</span></span>
<span id="cb40-22"><a href="#cb40-22"></a>      }))<span class="op">;</span></span>
<span id="cb40-23"><a href="#cb40-23"></a>      <span class="fu">setTodos</span>(convertedTodos)<span class="op">;</span></span>
<span id="cb40-24"><a href="#cb40-24"></a>    } <span class="cf">else</span> {</span>
<span id="cb40-25"><a href="#cb40-25"></a>      <span class="co">// LocalStorage にデータがない場合は initTodos をセットする</span></span>
<span id="cb40-26"><a href="#cb40-26"></a>      <span class="fu">setTodos</span>(initTodos)<span class="op">;</span></span>
<span id="cb40-27"><a href="#cb40-27"></a>    }</span>
<span id="cb40-28"><a href="#cb40-28"></a>    <span class="fu">setInitialized</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb40-29"><a href="#cb40-29"></a>  }<span class="op">,</span> [])<span class="op">;</span></span>
<span id="cb40-30"><a href="#cb40-30"></a></span>
<span id="cb40-31"><a href="#cb40-31"></a>  <span class="co">// 状態 todos または initialized に変更があったときTodoデータを保存</span></span>
<span id="cb40-32"><a href="#cb40-32"></a>  <span class="fu">useEffect</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb40-33"><a href="#cb40-33"></a>    <span class="cf">if</span> (initialized) {</span>
<span id="cb40-34"><a href="#cb40-34"></a>      localStorage<span class="op">.</span><span class="fu">setItem</span>(localStorageKey<span class="op">,</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(todos))<span class="op">;</span></span>
<span id="cb40-35"><a href="#cb40-35"></a>    }</span>
<span id="cb40-36"><a href="#cb40-36"></a>  }<span class="op">,</span> [todos<span class="op">,</span> initialized])<span class="op">;</span></span>
<span id="cb40-37"><a href="#cb40-37"></a></span>
<span id="cb40-38"><a href="#cb40-38"></a>  <span class="kw">const</span> uncompletedCount <span class="op">=</span> todos<span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb40-39"><a href="#cb40-39"></a>    (todo<span class="op">:</span> Todo) <span class="kw">=&gt;</span> <span class="op">!</span>todo<span class="op">.</span><span class="at">isDone</span></span>
<span id="cb40-40"><a href="#cb40-40"></a>  )<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb40-41"><a href="#cb40-41"></a></span>
<span id="cb40-42"><a href="#cb40-42"></a>  <span class="co">// ～ 以下、省略 ～</span></span></code></pre></div>
      <p>ここでは <code>useEffect</code> が重要な役割を果たします。</p>
      <p>まず、<strong>第15行目</strong> ～ <strong>第29行目</strong> の
      <code>useEffect(() =&gt; {...}, [])</code> によって
      Appコンポーネントの <span class="masked">初回の実行時のみ
      (ブラウザでリロードされたときは、そのリロードの実行時のみ)</span>
      LocalStorage から Todoデータ をロードして <code>todos</code>
      にセットする仕組みをつくっています。</p>
      <p>また、<strong>第32行目</strong> ～ <strong>第36行目</strong> の
      <code>useEffect(() =&gt; {...}, [todos, initialized])</code>
      によって <code>todos</code> (または <code>initialized</code>)
      に更新があるときに、LocalStorage に <code>todos</code>
      をセーブする仕組みをつくっています。</p>
      <p>じつは、ここまでの解説では、あえて触れていはいなかったのですが、「<strong>Reactによる画面更新のための再レンダリング</strong>」=<span
      class="masked">第04回行目からの App関数 を再実行</span>
      という内部処理になっています。つまり、新規タスクの名前設定用の
      <strong>テキストボックスに1文字入力するたびに</strong>
      Reactにより画面の再レンダリングが実行されますが、その裏側では「<strong>App関数の再実行</strong>」が行なわれています
      (このあたりの仕組みは後述の動画を参照してください)。そのため、<code>useEffect</code>
      を利用しないと <span
      class="masked">テキストボックスに1文字打ち込むたびにTodoデータのロードやセーブが実行</span>
      されてしまいます。ここでは、LocalStorage
      を使っているため頻繁にロードとセーブをしても大きな問題はありません。しかし、一般的なウェブアプリでは
      <strong>ウェブAPIを使ってデータの永続化</strong>
      を行なうため、テキストボックスに１文字打ち込むたびにAPIを叩くような実装にすると、<span
      class="masked">短期間でAPIの利用上限に到達したり、膨大な課金が発生</span>してしまいます。注意してください。</p>
      <p><code>useEffect</code> の理解については <a
      href="https://www.youtube.com/watch?v=4INjmxXaPxU">初心者向け！ReactのuseEffectが何してるのか20分で説明</a>@
      Code Tips (動画) や<a
      href="https://www.google.com/search?q=react+useeffect+解説">ウェブ検索</a>、生成AIを活用してください。</p>
      <p>この他、永続化の処理では「LocalStorageには文字列しか保存できない」という制約に対応するために
      <code>JSON.parse()</code> や <code>JSON.stringify()</code>
      を利用しています。特に、Date型の値は <code>JSON.stringify()</code>
      によって文字型に変換・保存された後、<code>JSON.stringify()</code>
      にはDate型の値に復元されない点に注意してください
      (文字列型として復元されます)。そのため <strong>第21行目</strong>
      のような工夫がされています。</p>
      <p>以上のように、この永続化の処理は様々な工夫が詰められているので、色々と実験したり読み解いたりして理解を深めてください。</p>
      <h1 data-number="11"
      id="reactアプリを-github-pages-にデプロイする手順"><span
      class="header-section-number">11</span> Reactアプリを GitHub Pages
      にデプロイする手順</h1>
      <p>Todoアプリを GitHub Pages にデプロイ
      するための手順について解説します。</p>
      <p>以前に HTML/CSS
      でポートフォリオサイトを作成したときとは違って、<strong>単純に
      GitHub Pages
      の機能を有効化するだけでは「Reactアプリは機能しない」ため注意</strong>
      してください。</p>
      <h2 data-number="11.1" id="準備"><span
      class="header-section-number">11.1</span> 準備</h2>
      <p>VSCodeのターミナルから<a
      href="https://www.npmjs.com/package/gh-pages">gh-pages</a>というパッケージのインストールしてください。開発だけに使用するので
      <code>-D</code> オプションを付けてください。</p>
      <pre><code>npm i -D gh-pages</code></pre>
      <p>また、同様に <span class="citation"
      data-cites="types/node">@types/node</span> という型定義ファイルも
      <code>-D</code> オプションを付けてインストールしてください。</p>
      <pre><code>npm i -D @types/node</code></pre>
      <p>プロジェクトフォルダを GitHub の
      <strong>パブリックリポジトリ</strong>
      として発行してください。既にリポジトリを発行済みの場合は、「コミット」と「同期
      (Push)」を実行しておいてください。</p>
      <figure>
      <img src="figs/05/deploy_01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <figure>
      <img src="figs/05/deploy_02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="11.2" id="初回設定"><span
      class="header-section-number">11.2</span> 初回設定</h2>
      <p>初回のみ必要な処理となります。VSCodeのターミナルから順番に実行してください。</p>
      <pre><code>git checkout --orphan gh-pages
git rm -rf .
git commit --allow-empty -m &quot;Initial gh-pages commit&quot;
git push origin gh-pages
git checkout main</code></pre>
      <p>以上は、<strong>GitHub Pages
      でウェブサイトをホストするための準備作業</strong>
      として一般的に使用される一連のコマンドです。詳細について知りたいときは、生成AIを利用してください。</p>
      <h2 data-number="11.3" id="github-pages-の設定"><span
      class="header-section-number">11.3</span> GitHub Pages の設定</h2>
      <p>ウェブブラウザで「Todoアプリ」のリポジトリに移動して、<strong>以下のように設定されていることを確認</strong>してください。もし、自動的に設定されていない場合は、図のように設定してください。</p>
      <figure>
      <img src="figs/05/deploy_03.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>なお、この時点では、https://xxxx.github.io/react-todo-app/
      にアクセスしても <span class="masked">「404」</span>
      となります。実際に確認してください。</p>
      <h2 data-number="11.4"
      id="index.html-の編集と-404.html-の追加"><span
      class="header-section-number">11.4</span> index.html の編集と
      404.html の追加</h2>
      <p>プロジェクトフォルダの直下にある <code>index.html</code> の
      <code>&lt;head&gt;</code> タグの子要素として、次のような
      <code>&lt;script&gt;</code>
      タグを追加してください。<code>index.html</code> の全体コードは<a
      href="https://github.com/TakeshiWada1980/Programming3-2024/blob/main/docs/codes/05/index.html">こちら<i class="fa-solid fa-person-chalkboard"></i></a>のようになります。</p>
      <div class="sourceCode" id="cb44"
      data-caption="index.html (抜粋)"><pre
      class="sourceCode numberSource html numberLines"><code class="sourceCode html"><span id="cb44-1"><a href="#cb44-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="ot"> type=</span><span class="st">&quot;text/javascript&quot;</span><span class="dt">&gt;</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>  <span class="kw">var</span> pathSegmentsToKeep <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb44-3"><a href="#cb44-3"></a>  <span class="kw">var</span> l <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">location</span><span class="op">;</span></span>
<span id="cb44-4"><a href="#cb44-4"></a>  l<span class="op">.</span><span class="fu">replace</span>(</span>
<span id="cb44-5"><a href="#cb44-5"></a>    l<span class="op">.</span><span class="at">protocol</span> <span class="op">+</span></span>
<span id="cb44-6"><a href="#cb44-6"></a>      <span class="st">&quot;//&quot;</span> <span class="op">+</span></span>
<span id="cb44-7"><a href="#cb44-7"></a>      l<span class="op">.</span><span class="at">hostname</span> <span class="op">+</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>      (l<span class="op">.</span><span class="at">port</span> <span class="op">?</span> <span class="st">&quot;:&quot;</span> <span class="op">+</span> l<span class="op">.</span><span class="at">port</span> <span class="op">:</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb44-9"><a href="#cb44-9"></a>      l<span class="op">.</span><span class="at">pathname</span></span>
<span id="cb44-10"><a href="#cb44-10"></a>        <span class="op">.</span><span class="fu">split</span>(<span class="st">&quot;/&quot;</span>)</span>
<span id="cb44-11"><a href="#cb44-11"></a>        <span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span> <span class="op">+</span> pathSegmentsToKeep)</span>
<span id="cb44-12"><a href="#cb44-12"></a>        <span class="op">.</span><span class="fu">join</span>(<span class="st">&quot;/&quot;</span>) <span class="op">+</span></span>
<span id="cb44-13"><a href="#cb44-13"></a>      <span class="st">&quot;/?/&quot;</span> <span class="op">+</span></span>
<span id="cb44-14"><a href="#cb44-14"></a>      l<span class="op">.</span><span class="at">pathname</span></span>
<span id="cb44-15"><a href="#cb44-15"></a>        <span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb44-16"><a href="#cb44-16"></a>        <span class="op">.</span><span class="fu">split</span>(<span class="st">&quot;/&quot;</span>)</span>
<span id="cb44-17"><a href="#cb44-17"></a>        <span class="op">.</span><span class="fu">slice</span>(pathSegmentsToKeep)</span>
<span id="cb44-18"><a href="#cb44-18"></a>        <span class="op">.</span><span class="fu">join</span>(<span class="st">&quot;/&quot;</span>)</span>
<span id="cb44-19"><a href="#cb44-19"></a>        <span class="op">.</span><span class="fu">replace</span>(<span class="ss">/&amp;/g</span><span class="op">,</span> <span class="st">&quot;~and~&quot;</span>) <span class="op">+</span></span>
<span id="cb44-20"><a href="#cb44-20"></a>      (l<span class="op">.</span><span class="at">search</span> <span class="op">?</span> <span class="st">&quot;&amp;&quot;</span> <span class="op">+</span> l<span class="op">.</span><span class="at">search</span><span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/&amp;/g</span><span class="op">,</span> <span class="st">&quot;~and~&quot;</span>) <span class="op">:</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb44-21"><a href="#cb44-21"></a>      l<span class="op">.</span><span class="at">hash</span></span>
<span id="cb44-22"><a href="#cb44-22"></a>  )<span class="op">;</span></span>
<span id="cb44-23"><a href="#cb44-23"></a><span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span></code></pre></div>
      <p>また、同様に <strong>プロジェクトフォルダの直下</strong> に
      <code>404.html</code> というファイルを新規作成して<a
      href="https://github.com/TakeshiWada1980/Programming3-2024/blob/main/docs/codes/05/404.html">こちら<i class="fa-solid fa-person-chalkboard"></i></a>のコードを貼付けて保存してください。</p>
      <figure>
      <img src="figs/05/deploy_04.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="11.5" id="各種設定ファイルの変更"><span
      class="header-section-number">11.5</span>
      各種設定ファイルの変更</h2>
      <p><code>package.json</code> のなかに <code>"homepage"</code>
      を追加し、さらに <code>"scripts"</code> のなかに
      <code>"predeploy"</code> と <code>"deploy"</code>
      を追加してください。</p>
      <ul>
      <li><code>"homepage"</code> の <code>xxxx</code> の部分は <span
      class="masked">自分のGitHubアカウント</span>
      に書き換えてください。</li>
      </ul>
      <div class="sourceCode" id="cb45"
      data-caption="package.json (抜粋)"><pre
      class="sourceCode numberSource json numberLines"><code class="sourceCode json"><span id="cb45-1"><a href="#cb45-1"></a><span class="er">&quot;homepage&quot;:</span> <span class="er">&quot;https://xxxx.github.io/react-todo-app&quot;,</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="er">&quot;scripts&quot;:</span> <span class="fu">{</span></span>
<span id="cb45-3"><a href="#cb45-3"></a>  <span class="dt">&quot;dev&quot;</span><span class="fu">:</span> <span class="st">&quot;vite&quot;</span><span class="fu">,</span></span>
<span id="cb45-4"><a href="#cb45-4"></a>  <span class="dt">&quot;build&quot;</span><span class="fu">:</span> <span class="st">&quot;tsc -b &amp;&amp; vite build&quot;</span><span class="fu">,</span></span>
<span id="cb45-5"><a href="#cb45-5"></a>  <span class="dt">&quot;lint&quot;</span><span class="fu">:</span> <span class="st">&quot;eslint .&quot;</span><span class="fu">,</span></span>
<span id="cb45-6"><a href="#cb45-6"></a>  <span class="dt">&quot;preview&quot;</span><span class="fu">:</span> <span class="st">&quot;vite preview&quot;</span><span class="fu">,</span></span>
<span id="cb45-7"><a href="#cb45-7"></a>  <span class="dt">&quot;predeploy&quot;</span><span class="fu">:</span> <span class="st">&quot;npm run build&quot;</span><span class="fu">,</span></span>
<span id="cb45-8"><a href="#cb45-8"></a>  <span class="dt">&quot;deploy&quot;</span><span class="fu">:</span> <span class="st">&quot;gh-pages -d dist&quot;</span></span>
<span id="cb45-9"><a href="#cb45-9"></a><span class="fu">}</span><span class="er">,</span></span></code></pre></div>
      <p>設定項目を追加する際は、<strong>カンマ</strong> <code>,</code>
      <strong>等の付け忘れに注意</strong>してください。また、JSONファイルに「コメント」を追加するとビルドエラーになる可能性があるので注意してください。</p>
      <figure>
      <img src="figs/05/deploy_05.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p><code>vite.config.ts</code>
      を以下のように編集してください。</p>
      <div class="sourceCode" id="cb46"
      data-caption="vite.config.ts"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb46-1"><a href="#cb46-1"></a><span class="im">import</span> { defineConfig } <span class="im">from</span> <span class="st">&quot;vite&quot;</span><span class="op">;</span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="im">import</span> react <span class="im">from</span> <span class="st">&quot;@vitejs/plugin-react&quot;</span><span class="op">;</span></span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="im">import</span> path <span class="im">from</span> <span class="st">&quot;path&quot;</span><span class="op">;</span> <span class="co">// ◀◀ 追加</span></span>
<span id="cb46-4"><a href="#cb46-4"></a></span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="kw">const</span> repositoryName <span class="op">=</span> <span class="st">&quot;react-todo-app&quot;</span><span class="op">;</span> <span class="co">// ◀◀ 追加</span></span>
<span id="cb46-6"><a href="#cb46-6"></a></span>
<span id="cb46-7"><a href="#cb46-7"></a><span class="im">export</span> <span class="im">default</span> <span class="fu">defineConfig</span>({</span>
<span id="cb46-8"><a href="#cb46-8"></a>  plugins<span class="op">:</span> [<span class="fu">react</span>()]<span class="op">,</span></span>
<span id="cb46-9"><a href="#cb46-9"></a>  <span class="co">// ▼▼ 追加 ここから ▼▼</span></span>
<span id="cb46-10"><a href="#cb46-10"></a>  base<span class="op">:</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">NODE_ENV</span> <span class="op">===</span> <span class="st">&quot;production&quot;</span> <span class="op">?</span> <span class="vs">`/</span><span class="sc">${</span>repositoryName<span class="sc">}</span><span class="vs">/`</span> <span class="op">:</span> <span class="st">&quot;/&quot;</span><span class="op">,</span></span>
<span id="cb46-11"><a href="#cb46-11"></a>  build<span class="op">:</span> {</span>
<span id="cb46-12"><a href="#cb46-12"></a>    rollupOptions<span class="op">:</span> {</span>
<span id="cb46-13"><a href="#cb46-13"></a>      input<span class="op">:</span> {</span>
<span id="cb46-14"><a href="#cb46-14"></a>        main<span class="op">:</span> path<span class="op">.</span><span class="fu">resolve</span>(<span class="bu">__dirname</span><span class="op">,</span> <span class="st">&quot;index.html&quot;</span>)<span class="op">,</span></span>
<span id="cb46-15"><a href="#cb46-15"></a>        <span class="dv">404</span><span class="op">:</span> path<span class="op">.</span><span class="fu">resolve</span>(<span class="bu">__dirname</span><span class="op">,</span> <span class="st">&quot;404.html&quot;</span>)<span class="op">,</span></span>
<span id="cb46-16"><a href="#cb46-16"></a>      }<span class="op">,</span></span>
<span id="cb46-17"><a href="#cb46-17"></a>    }<span class="op">,</span></span>
<span id="cb46-18"><a href="#cb46-18"></a>  }<span class="op">,</span></span>
<span id="cb46-19"><a href="#cb46-19"></a>  <span class="co">// ▲▲ 追加 ここまで ▲▲</span></span>
<span id="cb46-20"><a href="#cb46-20"></a>  server<span class="op">:</span> {</span>
<span id="cb46-21"><a href="#cb46-21"></a>    port<span class="op">:</span> <span class="dv">3000</span><span class="op">,</span></span>
<span id="cb46-22"><a href="#cb46-22"></a>    strictPort<span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb46-23"><a href="#cb46-23"></a>    open<span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb46-24"><a href="#cb46-24"></a>  }<span class="op">,</span></span>
<span id="cb46-25"><a href="#cb46-25"></a>})<span class="op">;</span></span></code></pre></div>
      <p>一旦、ここまでの内容で「コミット」と「同期
      (Push)」をしておいてください。以上で設定は終わりです。</p>
      <h2 data-number="11.6" id="発行-publish"><span
      class="header-section-number">11.6</span> 発行 Publish</h2>
      <p>ここからは、<strong>Todoアプリを書き換えて、その内容を GitHub
      Pages に反映したいとき</strong>、<span
      class="masked">その都度、実行する必要がある処理</span>
      になります。</p>
      <p>VSCodeのターミナルから以下のコマンドを実行してください。</p>
      <pre><code>npm run predeploy</code></pre>
      <p>このコマンドは実質的に <code>npm run build</code>
      と同じです。エラーがあれば修正してください。</p>
      <p>特にエラーがなければ、以下のコマンドを実行してください。</p>
      <pre><code>npm run deploy</code></pre>
      <p>以下のように「<strong>Published</strong>」と出力されたらデプロイが
      <strong>成功</strong>🎉 (完了) です。</p>
      <pre><code>PS C:\Users\xxxx\Documents\react-todo-app&gt; npm run deploy

&gt; react-todo-app@0.0.0 predeploy
&gt; npm run build


&gt; react-todo-app@0.0.0 build
&gt; tsc -b &amp;&amp; vite build

vite v5.4.9 building for production...
✓ 69 modules transformed.
dist/index.html                  1.58 kB │ gzip:  0.77 kB
dist/404.html                    1.92 kB │ gzip:  0.82 kB
dist/assets/main-wUGgSDZ4.css    8.60 kB │ gzip:  2.30 kB
dist/assets/main-DWqE2Lov.js   232.21 kB │ gzip: 76.33 kB
✓ built in 1.64s

&gt; react-todo-app@0.0.0 deploy
&gt; gh-pages -d dist

Published</code></pre>
      <p>ウェブブラウザから
      <strong>https://xxxx.github.io/react-todo-app/</strong>
      にアクセスしてTodoアプリが利用できることを確認してください。</p>
      <figure>
      <img src="figs/05/deploy_06.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>なお、<a
      href="https://www.google.com/search?q=react-router-domとは">react-router-dom</a>を使った
      <strong>ルーティング</strong> を導入したReactアプリを GitHub Pages
      でホストする場合は、さらにひと工夫が求められます。これについては個別に訊いてくれれば個別にレクチャします
      (<a
      href="https://github.com/TakeshiWada1980/Programming3-2024/blob/main/docs/codes/05/main.tsx">main.tsx</a>,<a
      href="https://github.com/TakeshiWada1980/Programming3-2024/blob/main/docs/codes/05/Router.tsx">Router.tsx</a>)。</p>
      <h1 data-number="12" id="課題1"><span
      class="header-section-number">12</span> 課題1</h1>
      <p>以上で、(フロントエンドだけで処理が完結するような) React
      を使った Todoアプリ
      の「<strong>チュートリアル</strong>」は完了です。</p>
      <p>このチュートリアルで学んだことをベースとして
      <strong>オリジナルのTodoアプリ</strong> を開発して、GitHub Pages
      にデプロイし、その URL
      を提出してください。提出するURLは「リポジトリのURL
      (https://github.com/xxxx/react-todo-app)」ではなく、「<strong>Todoアプリをホストしている
      GitHub Pages のURL</strong>
      (<strong>https://xxxx.github.io/react-todo-app</strong>)」としてください。</p>
      <p><br />
      </p>
      <ul>
      <li><strong><em>提出期限</em></strong> : <strong>11月27日 (水)
      23時</strong></li>
      <li><strong><em>提出先</em></strong> : Google Classroom
      (次回の講義でアナウンスします)</li>
      <li><strong><em>採点</em></strong> :
      「7点」を標準として「10点満点」で評価します。学年末の成績評価の際には「重み」が付けられます。
      <ul>
      <li>参考: <a
      href="https://takeshiwada1980.github.io/react-todo-app-demo/">Todoアプリのサンプル</a>
      …ギリギリ合格水準のレベルの6点😨</li>
      <li>参考: <a
      href="https://takeshiwada1980.github.io/react-todo-app-demo/2">Todoアプリのサンプル</a>
      …ここまでつくれたら素晴らしい！9点🎉</li>
      </ul></li>
      <li><strong><em>取り組み時間の目安</em></strong> :
      <strong>16時間以上</strong> ( <code>useEffect</code>
      の理解などの基礎学習の時間を含む)。本科目は「学修単位科目」かつ「筆記試験がない科目」です。課題には十分な時間をかけて取り組んでください。</li>
      <li><strong><em>アドバイス</em></strong> :
      Todoアプリとしての「<span class="masked">機能</span>」や「<span
      class="masked">UI/UX</span>」を中心とした完成度の他、リポジトリの
      <code>README.md</code> の内容を評価します。<code>README.md</code>
      に、以下の内容を含めると高評価です。
      <ul>
      <li>アプリの機能。これを書いておかないと<strong>頑張って実装した機能に気付いてもらえないこと</strong>があります。スクリーンショットがあると分かりやすいです。</li>
      <li><strong>特に工夫や注力 (チャレンジ)
      したところ、オリジナリティを持たせているところ</strong>。それらの「着想」や「経緯」についても書かれていると
      (就活のポートフォリオとして) 高評価・好印象です👍</li>
      <li>使用技術
      (技術スタック、主要ライブラリ)、開発に要した時間や期間など。</li>
      </ul></li>
      </ul>
      <p><br />
      </p>
      <p>提出された課題 (URL) は、知能情報コースの学生
      (知能情報コースを志望する1年生を含む)、本校教員に共有します。また、この課題は、<strong>インターンシップや就職の選考にポートフォリオとして使えるもの</strong>
      (=<span class="masked">自分のスキルをや経験を証明するもの</span>)
      なので、注力して取り組んで欲しいと考えています。</p>
      <!-- ---------------------------------------- -->
    </main>

    <footer class="markdown-body">
      <p><a href="https://takeshiwada1980.github.io/Programming3-2024/">講義資料のIndexに移動</a></p>
    </footer>

    <script>
      window.onload = function () {
        // ナビゲーション関連
        let openBtn = document.getElementsByClassName("openbtn")[0];
        let navPnl = document.getElementById("g-nav");
        openBtn.onclick = () => {
          openBtn.classList.toggle("active");
          navPnl.classList.toggle("panelactive");
        };

        let items = navPnl.getElementsByTagName("a");
        Array.from(items).forEach((item) => {
          item.onclick = () => {
            openBtn.classList.toggle("active");
            navPnl.classList.toggle("panelactive");
          };
        });

        // マスク処理
        let maskedSpans = document.getElementsByClassName("masked");
        Array.from(maskedSpans).forEach((span) => {
          span.onclick = () => {
            span.classList.toggle("open");
          };
        });

        // data-startfrom 属性の行番号カウンタのリセット
        document.querySelectorAll("div.sourceCode").forEach(function (div) {
          var startFrom = div.getAttribute("data-startfrom");
          if (startFrom != null) {
            div.style.counterReset = "pg-line " + (startFrom - 1);
          }
        });

        // 画像にリンクを付与
        // let images = document.querySelectorAll("figure img");
        // Array.from(images).forEach((img) => {
        //   img.onclick = () => {
        //     location.href = img.getAttribute("src");
        //   };
        // });
      };
    </script>
  </body>
</html>

<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <meta name="robots" content="noindex,nofollow,noarchive" />
    <meta name="referrer" content="no-referrer" />

    <script>
      MathJax = {
        chtml: {
          displayAlign: "left",
          displayIndent: "1em",
        },
      };
    </script>

     <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
type="text/javascript"></script> 

    <link rel="icon" href="favicon.ico" sizes="any" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
      integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c"
    />
    <link rel="stylesheet" href="style.css" />

    <title>第12回 3I-プログラミング3</title>
  </head>

  <body>
    <div class="openbtn"><span></span><span></span><span></span></div>
    <nav id="g-nav">
      <div id="g-nav-list">
        <!-- ---------------------------------------- -->
         <ul>
<li><a href="#連絡概要" id="toc-連絡概要"><span class="toc-section-number">1</span> 連絡・概要</a>
<ul>
<li><a href="#大学入学共通テスト情報" id="toc-大学入学共通テスト情報"><span
class="toc-section-number">1.1</span> 大学入学共通テスト「情報」</a></li>
<li><a href="#課題3-最終課題の案内" id="toc-課題3-最終課題の案内"><span
class="toc-section-number">1.2</span> 課題3 (最終課題の案内)</a></li>
<li><a href="#ゲームtimesit業界フォーラム" id="toc-ゲームtimesit業界フォーラム"><span
class="toc-section-number">1.3</span> ゲーム<span
class="math inline">\(\times\)</span>IT業界フォーラム</a></li>
<li><a href="#概要" id="toc-概要"><span class="toc-section-number">1.4</span> 概要</a></li>
</ul></li>
<li><a href="#デプロイ設定前の準備" id="toc-デプロイ設定前の準備"><span
class="toc-section-number">2</span> デプロイ設定前の準備</a>
<ul>
<li><a href="#キャッシュの制御" id="toc-キャッシュの制御"><span
class="toc-section-number">2.1</span> キャッシュの制御</a></li>
<li><a href="#ビルド" id="toc-ビルド"><span class="toc-section-number">2.2</span> ビルド</a></li>
<li><a href="#push" id="toc-push"><span class="toc-section-number">2.3</span> Push</a></li>
</ul></li>
<li><a href="#vercel-の利用登録と設定" id="toc-vercel-の利用登録と設定"><span
class="toc-section-number">3</span> Vercel の利用登録と設定</a>
<ul>
<li><a href="#サインアップ" id="toc-サインアップ"><span class="toc-section-number">3.1</span>
サインアップ</a></li>
<li><a href="#githubリポジトリとの連携とデプロイ" id="toc-githubリポジトリとの連携とデプロイ"><span
class="toc-section-number">3.2</span> GitHubリポジトリとの連携とデプロイ</a></li>
<li><a href="#ビルドスクリプトの編集" id="toc-ビルドスクリプトの編集"><span
class="toc-section-number">3.3</span> ビルドスクリプトの編集</a></li>
<li><a href="#環境変数の設定" id="toc-環境変数の設定"><span class="toc-section-number">3.4</span>
環境変数の設定</a></li>
<li><a href="#再デプロイ処理" id="toc-再デプロイ処理"><span class="toc-section-number">3.5</span>
再デプロイ処理</a></li>
<li><a href="#公開url-ドメインネーム-の変更" id="toc-公開url-ドメインネーム-の変更"><span
class="toc-section-number">3.6</span> 公開URL (ドメインネーム) の変更</a></li>
<li><a href="#cd-continuous-delivery" id="toc-cd-continuous-delivery"><span
class="toc-section-number">3.7</span> CD (Continuous Delivery)</a></li>
<li><a href="#リージョン設定" id="toc-リージョン設定"><span class="toc-section-number">3.8</span>
リージョン設定</a></li>
</ul></li>
<li><a href="#github-actions-による定期処理" id="toc-github-actions-による定期処理"><span
class="toc-section-number">4</span> GitHub Actions による定期処理</a>
<ul>
<li><a href="#ワークフローの設定ファイルの作成" id="toc-ワークフローの設定ファイルの作成"><span
class="toc-section-number">4.1</span> ワークフローの設定ファイルの作成</a></li>
<li><a href="#動作確認のための手動実行" id="toc-動作確認のための手動実行"><span
class="toc-section-number">4.2</span> 動作確認のための手動実行</a></li>
</ul></li>
<li><a href="#pwa機能の設定" id="toc-pwa機能の設定"><span class="toc-section-number">5</span>
PWA機能の設定</a>
<ul>
<li><a href="#manifest.json-の作成と配置" id="toc-manifest.json-の作成と配置"><span
class="toc-section-number">5.1</span> manifest.json の作成と配置</a></li>
<li><a href="#アイコン用の画像の配置" id="toc-アイコン用の画像の配置"><span
class="toc-section-number">5.2</span> アイコン用の画像の配置</a></li>
<li><a href="#アイコンの入手" id="toc-アイコンの入手"><span class="toc-section-number">5.3</span>
アイコンの入手</a></li>
</ul></li>
<li><a href="#最終課題-課題3" id="toc-最終課題-課題3"><span class="toc-section-number">6</span>
最終課題 (課題3)</a>
<ul>
<li><a href="#注意事項" id="toc-注意事項"><span class="toc-section-number">6.1</span>
注意事項</a></li>
<li><a href="#readmeの構成.mdについて" id="toc-readmeの構成.mdについて"><span
class="toc-section-number">6.2</span> READMEの構成.mdについて</a></li>
</ul></li>
</ul> 
        <!-- ---------------------------------------- -->
      </div>
    </nav>

    <header class="markdown-body">
      <p>2024-3I プログラミング3 第12回 講義資料</p>
      <p>2025年01月23日（木）1・2時限</p>
    </header>

    <main class="markdown-body">
      <!-- ---------------------------------------- -->
      <h1 data-number="1" id="連絡概要"><span class="header-section-number">1</span> 連絡・概要</h1>
      <h2 data-number="1.1" id="大学入学共通テスト情報"><span
      class="header-section-number">1.1</span> 大学入学共通テスト「情報」</h2>
      <p>2025/01/19 (日)
      に大学入学共通テスト「<strong>情報</strong>」が実施されました。以下のリンク先に「問題」と「解答例」を配置しています。60分・100点満点・マークシート式の試験です。高校
      (≠高専) の「<strong>情報Ⅰ</strong>（＝<span
      class="masked">主に高校1年で開講される2単位の必修科目</span>）」の範囲から出題されるものです。</p>
      <ul>
      <li><a
      href="https://classroom.google.com/c/NzA2ODk3OTU3MzYy/m/NzQ1ODg5MjUzMDIz/details">2025年度・大学入学共通テスト「情報」</a>
      @ Google Classroom</li>
      </ul>
      <h2 data-number="1.2" id="課題3-最終課題の案内"><span class="header-section-number">1.2</span>
      課題3 (最終課題の案内)</h2>
      <ul>
      <li><a href="lecture12.html#最終課題-課題3">ページの最後</a>
      に説明があります。確認しておいてください。</li>
      </ul>
      <h2 data-number="1.3" id="ゲームtimesit業界フォーラム"><span
      class="header-section-number">1.3</span> ゲーム<span
      class="math inline">\(\times\)</span>IT業界フォーラム</h2>
      <p><strong>業界研究&amp;インターンシップ</strong> 「<strong>ゲーム<span
      class="math inline">\(\times\)</span>IT業界フォーラム</strong>」の案内です。詳細は<a
      href="https://www.gakujo.ne.jp/2026/events/evt_dtl.aspx?p1=evt392&amp;area=online">こちら</a>から確認してください。</p>
      <p>2/13 (木) と 14 (金) の 10:40-18:00 にオンライン形式で実施されます (要・事前登録)。</p>
      <blockquote>
      <p>（１）「業界」や「会社」「仕事」について話が聞ける！<br />
      ゲーム・IT業界を代表する企業や急成長している企業から会社のことや仕事の話を聞き、理解を深められます。</p>
      <p>（２）このイベントでしか得られないインターンシップ情報をGETできる！<br />
      就業体験の場である<strong>インターンシップを行う企業から「実施内容」「スケジュール」「選考方法」などについて直接情報を得られます</strong>。（対応は企業により異なります）</p>
      </blockquote>
      <h2 data-number="1.4" id="概要"><span class="header-section-number">1.4</span> 概要</h2>
      <p><a href="lecture04.html">第04回講義</a>と<a
      href="lecture05.html">第05回講義</a>で作成した「ToDoアプリ」は、<strong>GitHub Pages</strong>
      に <strong>デプロイ (＝展開・配置)</strong> して、インターネット上で <strong>公開</strong>
      することができました。これは「ToDoアプリ」が <strong>フロントエンドプログラム</strong> (つまり
      <span class="masked">ウェブブラウザ上で実行される JavaScript プログラムのみ</span>)
      から構成されるため可能な手段でした。</p>
      <p>しかし、現在、Next.js
      フレームワークを使って開発している「ブログアプリ」は、サーバ側で動作する
      <strong>バックエンドプログラムを含んでおり</strong>、それを動かすためには「<strong>Node.js
      の実行環境</strong>」が必要とな ります。そのため、<strong>GitHub Pages</strong> (＝<span
      class="masked">Node.js 実行環境を持たない静的ホスティング環境</span>)
      を利用してデプロイや公開をすることは <strong>で・き・ま・せ・ん</strong>。</p>
      <p>以上のようなことから、この「ブログアプリ」については「<a
      href="https://vercel.com/">Vercel</a>」というクラウドプラットフォームにデプロイし、ウェブに公開しています。Vercel
      は「Next.js」や「<a href="https://v0.dev/">v0</a>」の開発元である <strong>Vercel社</strong>
      が提供する「<strong>クラウドホスティングプラットフォーム</strong> (＝<span
      class="masked">ホスティングサービス</span>)」になります。</p>
      <p>クラウドホスティングプラットフォームとは、ウェブアプリを実行するためのサーバインフラストラクチャ
      (サーバ環境)
      を提供し、<strong>インターネット上で公開できるようにしてくれるサービス</strong>のことです。同様のサービスは様々ありますが、<a
      href="https://vercel.com/">Vercel</a>の特徴として</p>
      <ol type="1">
      <li>Next.js に最適化された実行環境が提供されていること</li>
      <li><strong>GitHubリポジトリと連携した自動デプロイ (CI/CD パイプライン)</strong>
      が比較的簡単に構築できること</li>
      <li>クレジットカード登録不要のフリープランが存在すること</li>
      </ol>
      <p>…などが挙げられます。</p>
      <p><strong>(プロンプト例)</strong></p>
      <blockquote>
      <p>ウェブアプリ開発の文脈で「CI/CD」とは何ですか。Next.js
      でウェブアプリ開発をしている学習者向けに「概念」を解説してください。</p>
      </blockquote>
      <p>現在開発している「ブログアプリ」を Vercel にデプロイすれば、スマートフォン や PC から
      <strong>24時間どこからでも利用できるようになります</strong>。つまり、本格的なウェブアプリとして公開することができるようになります。</p>
      <p>この Vercel によるデプロイは、<strong>Vercel と GitHub リポジトリの連携設定</strong>
      をすることで「自動化」することができます。具体的には、Vercel
      にアカウントを作成して連携を設定すると、以降は <strong>GitHubリポジトリへの Push を Vercel
      が自動検知</strong>し、<span
      class="masked">最新コードの取得とビルドを実行して本番環境としてデプロイする</span>
      という「<strong>自動デプロイフロー</strong>」が構築されます。</p>
      <ol type="1">
      <li>Vercel でアカウントを作成し、GitHub リポジトリとの連携を設定</li>
      <li>GitHub リポジトリへの Push を Vercel が自動検知</li>
      <li>最新のコードを Vercel が取得</li>
      <li>Vercel の実行環境でビルド (<code>npm run build</code>) を実行</li>
      <li>本番環境へ自動デプロイ</li>
      </ol>
      <h3 data-number="1.4.1" id="定着確認"><span class="header-section-number">1.4.1</span>
      定着確認</h3>
      <ul>
      <li>ウェブアプリ開発の文脈で「CI/CD」とは何の略語か答えよ。
      <ul>
      <li>答え: <span class="masked">「CI」は Continuous Integration
      (継続的インテグレーション)、「CD」は Continuous Delivery (継続的デリバリー) または Deployment
      Continuous (継続デプロイメント) の略語。</span></li>
      </ul></li>
      </ul>
      <h1 data-number="2" id="デプロイ設定前の準備"><span class="header-section-number">2</span>
      デプロイ設定前の準備</h1>
      <p>準備として、次の3つを完了させておいてください。</p>
      <h2 data-number="2.1" id="キャッシュの制御"><span class="header-section-number">2.1</span>
      キャッシュの制御</h2>
      <p>Vercel
      にアプリをデプロイすると、特に「<strong>APIに対する「GET」リクエスト</strong>」において、意図せぬ
      <span class="masked">キャッシュ処理</span> が発生することがあります。例えば、<span
      class="masked">「記事を新規投稿したのに一覧に表示 (反映) されない」</span>
      といったことが発生します。これは、<strong>サーバサイドのキャッシュに起因する現象</strong>なので、ブラウザで
      <code>F5</code> や <code>Ctrl+F5</code> で再読込みをしても解消されません。</p>
      <p>この問題を回避するために <code>src/app/api/admin/posts</code> や
      <code>src/app/api/posts</code> などの <strong>GETリクエスト</strong> を処理する
      <code>route.ts</code>
      に、以下のような1文を追加してください。カテゴリ関連のGETリクエストを受付けるAPIについても、同様に追加してください。</p>
      <p>これにより、バックエンドにおけるキャッシュが無効化できます。</p>
      <div class="sourceCode" id="cb1" data-caption="src/app/api/posts/route.ts (抜粋)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> prisma <span class="im">from</span> <span class="st">&quot;@/lib/prisma&quot;</span><span class="op">;</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> { NextResponse<span class="op">,</span> NextRequest } <span class="im">from</span> <span class="st">&quot;next/server&quot;</span><span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">export</span> <span class="kw">const</span> revalidate <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="co">// ◀ サーバサイドのキャッシュを無効化する設定</span></span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">export</span> <span class="kw">const</span> GET <span class="op">=</span> <span class="kw">async</span> (req<span class="op">:</span> NextRequest) <span class="kw">=&gt;</span> {</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">// 以下省略</span></span></code></pre></div>
      <p><strong>(プロンプト例)</strong></p>
      <blockquote>
      <p>Next.js の Route Handlers において、export const revalidate=0;
      は、どのような意味を持ちますか？</p>
      </blockquote>
      <h2 data-number="2.2" id="ビルド"><span class="header-section-number">2.2</span> ビルド</h2>
      <p>次のコマンドを使って本番環境用（プロダクション環境用）にアプリをビルドして「<strong>エラーが発生しないこと</strong>」を確認してください。また「警告
      (ワーニング)」についても、可能な限り潰しておいてください。</p>
      <pre><code>npm run build</code></pre>
      <p>自分のPCのローカル環境でビルドに失敗している状況では、<strong>Vercel
      でのビルドもほぼ確実に失敗します</strong> (ここから先の解説に従って作業しても失敗します)。</p>
      <h2 data-number="2.3" id="push"><span class="header-section-number">2.3</span> Push</h2>
      <p>プロジェクトを GitHubリポジトリ (<code>main</code> ブランチ) に発行しておいてください。</p>
      <h1 data-number="3" id="vercel-の利用登録と設定"><span class="header-section-number">3</span>
      Vercel の利用登録と設定</h1>
      <p>Vercel を利用するためには、はじめに <strong>登録 (サインアップ)</strong>
      が必要となります。登録には「GitHubアカウント」と「携帯電話 (SMS
      による認証に使用)」が必要になります。クレジットカードなどは不要です。</p>
      <h2 data-number="3.1" id="サインアップ"><span class="header-section-number">3.1</span>
      サインアップ</h2>
      <p>Vercel のトップページ(<a
      href="https://vercel.com/">https://vercel.com/</a>)にアクセスして「<strong>Sign
      Up</strong>」ボタンを押下してください。ウェブブラウザのウィンドウ幅が狭い場合はボタンが隠れているので注意してください。</p>
      <figure>
      <img src="figs/12/vercel_01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>「<strong>I’m working on personal projects (Hobby)</strong>」を選択してください。</p>
      <figure>
      <img src="figs/12/vercel_02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>「Your
      Name」のテキストボックスに名前を入力して「<strong>Continue</strong>」ボタンを押下して選択してください。ここで設定した「<strong>名前</strong>」はプレビューモードでデプロイしたときに
      <span class="masked">URLに含まれる文字列</span>
      になります。プロダクションモードでデプロイした場合のURL (本番環境用のURL)
      には含まれません。</p>
      <figure>
      <img src="figs/12/vercel_03.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>GitHub連携でログイン (ソーシャルログイン) をしたいので「<strong>Continue with
      GitHub</strong>」を選択してください。</p>
      <figure>
      <img src="figs/12/vercel_04.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>GitHub
      にログインするための認証情報を入力してください。状況に応じて2段階認証や2要素認証が要求されることがあります。</p>
      <figure>
      <img src="figs/12/vercel_05.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>内容を確認して「<strong>Authorize Vercel</strong>」ボタンを押下してください。</p>
      <figure>
      <img src="figs/12/vercel_06.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>つづいて、Vercel 側で <strong>SMS (携帯電話) を使った本人認証</strong>
      が必要になります。手持ちの携帯電話の番号を入力してください。例えば、自分の携帯番号が「<strong>090-XXXX-YYYY</strong>」のときは「<strong>+81
      90 XXXX YYYY</strong>」のように入力してください (<code>+81</code> を付けるときは、先頭の
      <code>0</code> は不要になります)。</p>
      <figure>
      <img src="figs/12/vercel_07.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>携帯電話に SMS
      で「認証コード」が届くので、それを入力して「<strong>Verify</strong>」ボタンを押下してください。</p>
      <figure>
      <img src="figs/12/vercel_08.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>利用目的等のアンケート画面が表示されるので適当に入力して「<strong>Continue</strong>」ボタンを押下してください。</p>
      <figure>
      <img src="figs/12/vercel_10.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>以上で Vercel のサインアップが「完了」しました🎉</p>
      <p>つづいて、ブログアプリの「GitHubリポジトリ」と「Vercel」の連携を設定して、<strong>CD</strong>
      (＝継続デプロイメント) を構築していきます。</p>
      <h2 data-number="3.2" id="githubリポジトリとの連携とデプロイ"><span
      class="header-section-number">3.2</span> GitHubリポジトリとの連携とデプロイ</h2>
      <p>現在、ウェブブラウザは、次のような画面に移動しているはずです。ここからは「<strong>Vercel
      にデプロイする GitHub リポジトリ</strong>」を設定していきます。画面内「<strong>Import Git
      Repository</strong>」のなかの ❶ をクリックして「<strong>＋Add GitHub
      Account</strong>」を選択してください。</p>
      <figure>
      <img src="figs/12/vercel_11.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>Vercel にデプロイしたい「GiuHubリポジトリ」を選択していきます。</p>
      <p>いまは、任意のリポジトリだけをデプロイしたいので「<strong>Only select
      repositories</strong>」を選んで、❷ で <strong>ブログアプリのリポジトリ</strong>
      (<code>next-blog-app</code>)
      を選択してください。そして「<strong>Install</strong>」ボタンを押下してください。</p>
      <figure>
      <img src="figs/12/vercel_12.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>先ほどの画面に戻ってくるので、上記で選択したブログアプリのリポジトリの右隣の「<strong>Import</strong>」ボタンを押下してください。</p>
      <figure>
      <img src="figs/12/vercel_13.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>「<strong>Project
      Name</strong>」と「<strong>Framework</strong>」を確認して「<strong>Deploy</strong>」ボタンを選択してください。なお「<strong>Framework</strong>」としては「Next.js」のほかに、「Vue.js」「Angular」「Vite」のような
      <strong>様々なJavaScriptフレームワーク</strong> が利用可能です
      (例えば、先に作成した「ToDoアプリ」も Vecel にデプロイ可能です)。</p>
      <figure>
      <img src="figs/12/vercel_14.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>「<strong>Deploy</strong>」ボタンを押下すると、実際に GitHubリポジトリからデータ
      (プログラムのソースコード) が取得され、Vercel
      のサーバ環境のなかで「ビルド処理」と「デプロイ処理」が実行されます。これらの処理には数十秒から十数分かかります。</p>
      <p>しばらくすると、次のようにビルド処理で「<strong>失敗</strong>」することが確認できます。これは、<span
      class="masked">Vercel が提供するビルド環境を想定した設定ができていないため</span>
      です。一旦、「<strong>Go to
      Project</strong>」ボタンを押下して「プロジェクト画面」に戻ってください
      (あとで戻ってくるのでプロジェクト画面は閉じないでおいてください)。</p>
      <figure>
      <img src="figs/12/vercel_15.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>ウェブブラウザで、別タブを立ち上げて「ブログアプリの
      <strong>GitHubリポジトリ</strong>」を確認してください。</p>
      <p>こちらでも、デプロイ (Deployments) に「失敗」していることが確認できます。なお、Vercel
      のデフォルト設定では <code>main</code> ブランチが <strong>本番環境
      (プロダクションモードでビルドとデプロイをする対象)</strong> として取り扱われます。</p>
      <figure>
      <img src="figs/12/vercel_16.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="3.3" id="ビルドスクリプトの編集"><span
      class="header-section-number">3.3</span> ビルドスクリプトの編集</h2>
      <p>VSCode に戻って作業します。</p>
      <p>プロジェクトフォルダの直下の <code>package.json</code> を開いて、以下に示す
      <strong>第08行目</strong> のように <code>"vercel-build"</code>
      というカスタムスクリプトを追加してください。</p>
      <div class="sourceCode" id="cb3"
      data-caption="package.json &quot;vercel-build&quot; の追加"><pre
      class="sourceCode numberSource json numberLines"><code class="sourceCode json"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">{</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;next-blog-app&quot;</span><span class="fu">,</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="dt">&quot;version&quot;</span><span class="fu">:</span> <span class="st">&quot;0.1.0&quot;</span><span class="fu">,</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="dt">&quot;private&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="dt">&quot;scripts&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>    <span class="dt">&quot;dev&quot;</span><span class="fu">:</span> <span class="st">&quot;next dev&quot;</span><span class="fu">,</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="dt">&quot;build&quot;</span><span class="fu">:</span> <span class="st">&quot;next build&quot;</span><span class="fu">,</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="dt">&quot;vercel-build&quot;</span><span class="fu">:</span> <span class="st">&quot;prisma generate &amp;&amp; next build&quot;</span><span class="fu">,</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="dt">&quot;start&quot;</span><span class="fu">:</span> <span class="st">&quot;next start&quot;</span><span class="fu">,</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>    <span class="dt">&quot;lint&quot;</span><span class="fu">:</span> <span class="st">&quot;next lint&quot;</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>  <span class="fu">},</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="er">//</span> <span class="er">以下、省略</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="fu">}</span></span></code></pre></div>
      <p>以上のように <code>package.json</code> の <code>scripts</code> セクションに
      <code>"vercel-build"</code> というカスタムスクリプトを定義しておくと、Vercelでは <span
      class="masked"><code>"build"</code> スクリプトに代わって <code>"vercel-build"</code>
      がビルド処理に使われる</span> ようになります。</p>
      <p><code>"vercel-build"</code> の <code>prisma generate &amp;&amp; next build</code>
      というコマンドは、以下の2つのコマンドを順番に実行することを意味します。</p>
      <ol type="1">
      <li><code>prisma generate</code> : Prisma
      クライアントを生成します。これにより、データベーススキーマの型定義が TypeScript
      で利用可能になります。このコマンドの詳細は<a
      href="lecture08.html#データベースの作成と確認">第08回講義</a>を参照してください。</li>
      <li><code>next build</code> : Next.js アプリの本番用ビルド (プロダクションモードのビルド)
      を実行します。</li>
      </ol>
      <p>複数のコマンドを <code>&amp;&amp;</code> で連結することで <span
      class="masked">最初のコマンドが成功した場合にのみ、次のコマンドが実行される</span>
      ように処理されます。つまり、<code>prisma generate</code> が失敗すると <span
      class="masked"><code>next build</code> は実行されず、ビルド全体が「失敗」</span>
      として扱われます。</p>
      <div class="note type-senior">
      <p><strong>prisma generateの実行が必要な理由</strong></p>
      <p><code>prisma generate</code> を実行すると、デフォルトでは
      <code>node_modules/.prisma/client</code> に PrismaClient
      が生成されます。しかし、<code>.gitignore</code> の設定によって <code>node_modules</code>
      配下については <strong>GitHub に Push されません</strong>。</p>
      <p>その結果、Vercel などのデプロイ環境では <span class="masked">ビルド時に Prisma Client
      が存在しない状態</span> となります。このため、ビルド処理として <code>prisma generate</code>
      を実行し、PrismaClient を生成する必要があります。</p>
      </div>
      <p><code>package.json</code> を編集したら、再度、プロジェクトを <span class="masked">GitHub に
      Push</span> してください。</p>
      <h2 data-number="3.4" id="環境変数の設定"><span class="header-section-number">3.4</span>
      環境変数の設定</h2>
      <p>再び、ウェブブラウザで Vercel の「next-blog-app」のページ (プロジェクトのトップページ)
      に戻ってください。タイミングによりますが、以下のように GitHubへの Push
      を検知して、再度、ビルド処理が実行されています。</p>
      <figure>
      <img src="figs/12/vercel_17.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>しばらくすると、次のようにビルド処理に「<strong>失敗した</strong>」という表示に切り替わります。クリックして詳細を確認してください。</p>
      <figure>
      <img src="figs/12/vercel_18.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>ログを確認するとビルド処理の失敗原因は <span
      class="masked">「Supabaseの接続情報が取得できないこと」</span> だと分かります
      (少しずつ、ログを読み解けるようになってくださいね)。</p>
      <figure>
      <img src="figs/12/vercel_19.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p><strong>Supabase の接続情報</strong> は <code>prisma/schema.prisma</code> や
      <code>src/utils/supabase.ts</code> において、以下のように <code>env()</code> や
      <code>process.env</code> を使用して <span class="masked">「.env」で設定した環境変数</span>
      から取得するように実装していました。これは、接続情報をソースコードに直接記述すると GitHub に
      Push した際に情報が流出してしまうのを防ぐための措置でした。</p>
      <div class="sourceCode" id="cb4" data-caption="prisma/schema.prisma (抜粋)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb4-1"><a href="#cb4-1"></a>datasource db {</span>
<span id="cb4-2"><a href="#cb4-2"></a>  provider  <span class="op">=</span> <span class="st">&quot;postgresql&quot;</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>  url       <span class="op">=</span> <span class="fu">env</span>(<span class="st">&quot;DATABASE_URL&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>  directUrl <span class="op">=</span> <span class="fu">env</span>(<span class="st">&quot;DIRECT_URL&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>}</span></code></pre></div>
      <div class="sourceCode" id="cb5" data-caption="src/utils/supabase.ts (抜粋)"><pre
      class="sourceCode numberSource ts numberLines"><code class="sourceCode typescript"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">import</span> { createClient } <span class="im">from</span> <span class="st">&quot;@supabase/supabase-js&quot;</span><span class="op">;</span></span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="im">export</span> <span class="kw">const</span> supabase <span class="op">=</span> <span class="fu">createClient</span>(</span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">NEXT_PUBLIC_SUPABASE_URL</span><span class="op">!,</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">NEXT_PUBLIC_SUPABASE_ANON_KEY</span><span class="op">!</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>)<span class="op">;</span></span></code></pre></div>
      <p>環境変数を設定した <code>.env</code> は、<code>.gitignore</code> の設定により、GitHub に
      Push されないようになっています。この結果、Vercel のビルド環境 (デプロイ環境)
      で「環境変数」が参照できず、上記のように処理に失敗しました。</p>
      <p>以上のことから <span class="masked">ビルド環境 (デプロイ環境)
      で環境変数が参照できれば問題解決</span>
      となります。Vercelの環境変数は、プロジェクトの設定画面から設定することができます。</p>
      <p>以下のように「<strong>Settings</strong>」から「<strong>Environment
      Variables</strong>」を選択してください。</p>
      <figure>
      <img src="figs/12/vercel_20.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>次のように <code>.env</code>
      で設定していた環境変数を設定してください。なお、この際、いずれの設定値も <span
      class="masked">ダブルクォーテーションで囲まない</span>
      ように注意してください。また、<strong>設定値の前後にスペースなどを含まないように注意</strong>
      してください。その他にも、独自の環境変数を追加している場合は、それも同様に設定してください。</p>
      <figure>
      <img src="figs/12/vercel_21.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>以上で、環境変数の設定が完了しました。</p>
      <h2 data-number="3.5" id="再デプロイ処理"><span class="header-section-number">3.5</span>
      再デプロイ処理</h2>
      <p>環境変数が設定できたので、再度、デプロイ処理を実行してみます。以下のように「<strong>Deployments</strong>」から、最新のコミット
      (<code>package.json</code>を更新したコミット)
      の三点リーダをクリックして、「<strong>Redeploy</strong> (再デプロイ)」を選択してください。</p>
      <figure>
      <img src="figs/12/vercel_22.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>次のような確認画面が表示されるので「<strong>Redeploy</strong>」を選択してください。</p>
      <figure>
      <img src="figs/12/vercel_23.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>デプロイ処理 (ビルド処理を含む)
      が再度実行されます。ここまでの設定に問題がなければ、しらばく待った後、次のような画面
      (Statusが「<strong>Ready</strong>」の状態)になれば成功です🎉</p>
      <p>❷の「URL」をクリックすると、Vercelにデプロイされ、全世界に公開された「ブログアプリ」にアクセスすることができます
      (「<strong>Visit</strong>」のボタンでもOKです)。スマートフォンからもアクセスすることができます。</p>
      <figure>
      <img src="figs/12/vercel_24.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="3.6" id="公開url-ドメインネーム-の変更"><span
      class="header-section-number">3.6</span> 公開URL (ドメインネーム) の変更</h2>
      <p>現在、ウェブアプリの公開アドレスは <code>https://next-blog-app-*****.vercel.app/</code>
      のようになっていると思います。これは、次の手順で<strong>任意のものに変更することができます</strong>。ただし、既に誰かが使用している場合や、使用中ではないものの最近まで使用されていたドメインを使うことはできません
      (例えば <code>https://next-blog-app.vercel.app/</code> は使用できません)。</p>
      <p>以下のように「<strong>Settings</strong>」から「<strong>Domains</strong>」を選択して、「<strong>Edit</strong>」ボタンを押下してください。</p>
      <figure>
      <img src="figs/12/vercel_25.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>次のように任意のドメインネームを設定して、「<strong>Save</strong>」ボタンを押下してください。</p>
      <figure>
      <img src="figs/12/vercel_26.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="3.7" id="cd-continuous-delivery"><span
      class="header-section-number">3.7</span> CD (Continuous Delivery)</h2>
      <p>ここまでの設定により、CD (Continuous Delivery: 継続的デリバリ)
      が構築できました。以降は、GitHub の <code>main</code> ブランチに対する Push
      がトリガーとなって、自動的に Vercel でビルドとデプロイが実行されます。</p>
      <p>実際に Push
      してから、<strong>デプロイ完了までは数分から数十分ほどかかりま</strong>す。ビルドやデプロイの状況は、Vecelのウェブサイトからプロジェクトを選択して確認することができます。</p>
      <h2 data-number="3.8" id="リージョン設定"><span class="header-section-number">3.8</span>
      リージョン設定</h2>
      <figure>
      <img src="figs/12/vercel_28.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>リージョンの変更は、再デプロイを実行すると反映されます。</p>
      <h1 data-number="4" id="github-actions-による定期処理"><span
      class="header-section-number">4</span> GitHub Actions による定期処理</h1>
      <p>前々回の講義で解説したように Supabase で作成したプロジェクトは <span
      class="masked">約7日間放置</span> すると (Supabase のウェブサイトからプロジェクトの DB
      を参照したり、アプリからウェブAPIにアクセスしないと)、<strong>停止状態 (Paused)</strong>
      になってしまいます。</p>
      <p>開発中は (デバッグのために頻繁にウェブAPIにアクセスするため)
      停止状態になることは稀です。しかし、開発が一段落すると、気付いたときには停止状態になっていることがよくあります
      (＝<span
      class="masked">就活のポートフォリオとしては致命的です</span>)。この「ブログアプリ」については、1日1回、トップページにアクセスすれば
      <code>GET /api/posts</code> リクエストが発生して、内部で <code>prisma.post.findMany()</code>
      が実行されるため、Supabase が停止状態になることを回避できます。</p>
      <p>この定期的なアクセス処理は<a
      href="https://www.google.com/search?q=GitHub+Actions+とは">GitHub Actions</a>を使って <span
      class="masked">自動化すること</span> ができます。GitHub Actions は <strong>CI/CD</strong>
      のための機能で <span class="masked">時間指定による処理の定期実行</span> が可能です
      (その他、GitHub Actions には様々な機能があります)。</p>
      <p>ここでは1日1回、日本時間の10時15分 (＝<span class="masked">UTC: Coordinated Universal Time
      (協定世界時) の 01時15分</span>) に <code>https://hoge.vercel.app/</code>
      にGETリクエストを送信するような処理を GitHub Actions で構築してみたいと思います。</p>
      <h2 data-number="4.1" id="ワークフローの設定ファイルの作成"><span
      class="header-section-number">4.1</span> ワークフローの設定ファイルの作成</h2>
      <p>VSCode で作業します。プロジェクトフォルダの直下に <code>.github</code>
      というフォルダを作成し、そのなかに <code>workflows</code> というフォルダを作成し、そのなかに
      <code>daily-ping.yaml</code> というファイルを新規作成してください。</p>
      <p>ここで <code>.github</code> と <code>workflows</code> というのは GitHub Actions
      で指定された <strong>特別な名前</strong> なのでスペルミスに注意してください。</p>
      <figure>
      <img src="figs/12/vscode_01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>作成した <code>daily-ping.yaml</code>
      に、以下の内容を貼り付けてください。<strong>第06行目</strong>
      は「定期実行時刻」を設定します。UTC で設定することに注意してください。指定の書式は Linux の<a
      href="https://www.google.com/search?q=linux+cron">cron</a>と同じです。また、<strong>第18行目</strong>
      の URL は各自のデプロイ先にあわせて変更してください。</p>
      <div class="sourceCode" id="cb6" data-caption=".github/workflows/daily-ping.yaml"><pre
      class="sourceCode numberSource yaml numberLines"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> Prevent Supabase Sleep (Daily Ping)</span></span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="at">  </span><span class="fu">schedule</span><span class="kw">:</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">    # UTC 01:15 AM に実行 (JST 10:15 AM)</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">cron</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;15 1 * * *&quot;</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="at">  </span><span class="fu">workflow_dispatch</span><span class="kw">:</span></span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="at">  </span><span class="fu">make_request</span><span class="kw">:</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="at">    </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="at">      </span><span class="fu">TZ</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Asia/Tokyo&quot;</span></span>
<span id="cb6-14"><a href="#cb6-14"></a></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Send HTTP GET request</span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="fu">        run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb6-18"><a href="#cb6-18"></a>          curl -X GET &quot;https://next-blog-app-demo.vercel.app/&quot; -v --fail || exit 1</span>
<span id="cb6-19"><a href="#cb6-19"></a></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Log request time</span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="fu">        run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb6-22"><a href="#cb6-22"></a>          echo &quot;Keep-alive ping completed at $(date)&quot;</span></code></pre></div>
      <p>ファイルの編集と保存が完了したら、<span class="masked">コミットして GitHub に Push</span>
      してください。</p>
      <h2 data-number="4.2" id="動作確認のための手動実行"><span
      class="header-section-number">4.2</span> 動作確認のための手動実行</h2>
      <p>ワークフローの設定が適切にできたかを確認していきます。</p>
      <p>ウェブブラウザから GitHub
      リポジトリにアクセスして「<strong>Actions</strong>」のタブに移動してください。さらに、<strong>Prevent
      Supabase Sleep (Daily Ping)</strong> (＝ <code>daily-ping.yaml</code> の
      <strong>第01行目</strong>で設定した名前が表示されています) を選択してください。</p>
      <figure>
      <img src="figs/12/github_01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>このワークフローは、スケジュール実行を想定したものですが <code>daily-ping.yaml</code> の
      <strong>第07行目</strong> で <code>workflow_dispatch:</code> を記述しているので <span
      class="masked">ユーザ操作による手動実行</span> も可能になっています。</p>
      <p>手動実行するために「❸ <strong>Run workflow</strong>」から「❹ <strong>Run
      workflow</strong>」を押下してください。❹ を押下すると、GitHub の裏側で
      <code>daily-ping.yaml</code> の <strong>第11行目</strong> で指定した環境 (最新版 Ubuntu Linux)
      の仮想マシンが起動し、<strong>第18行目</strong> と <strong>第22行目</strong>
      のコマンドが実行されます。※
      仮想マシンが起動するまでに十数秒かかることがあります、反応がないからといって「<strong>Run
      workflow</strong>」ボタンを連打しないようにしてください。</p>
      <p>ワークフローの実行中は以下のような表示になります。</p>
      <figure>
      <img src="figs/12/github_02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>正常完了すると、次のような「<strong>緑のチェックマーク</strong>」になります。</p>
      <figure>
      <img src="figs/12/github_03.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>後日、同画面を再確認して、以下のように <code>Scheduled</code>
      で「緑チェックマーク」がついていれば、スケジュール実行が正常に動作していると言えます。なお、<strong>スケジュール実行の時刻には5分程度の誤差が生じることもあるので注意</strong>してください。</p>
      <figure>
      <img src="figs/12/github_04.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>GitHub Actions のスケジュールワークフローは、当該リポジトリに <span
      class="masked">60日間、何も Push しないと無効化 (停止)</span> するので注意してください。</p>
      <h1 data-number="5" id="pwa機能の設定"><span class="header-section-number">5</span>
      PWA機能の設定</h1>
      <p>Next.js 14 には、基本的な <strong>PWA機能</strong> がデフォルトで組み込まれています。PWA
      とは <span class="masked">Progressive Web App</span>
      の略語で、<strong>「ウェブアプリ」を「ネイティブアプリ」のように利用 (インストールや起動)
      できる技術</strong> になります。なお、基本的な機能に加えて <span
      class="masked">オフライン環境での実行</span> といった高度なPWA機能を使用したい場合は
      <code>next-pwa</code> というパッケージのインストールが必要になります。</p>
      <p>ここでは、Next.js
      にデフォルトで組み込まれている基本的なPWAの利用方法について解説します。</p>
      <p>PWAを有効化するためには、プロジェクトフォルダの所定の位置に<strong>設定ファイル</strong>
      (<code>manifest.json</code>) と<strong>画像ファイル</strong> (アイコン用)
      を配置します。PWAが有効化されると、ユーザは <span
      class="masked">ウェブアプリを「ネイティブアプリ」のようにデバイスにインストール＆起動</span>
      できるようになります。</p>
      <p>ユーザが、ウェブアプリを PWA としてインストールする方法はOSやブラウザにより異なります。</p>
      <p>例えば、<strong>PC版の Chrome</strong>
      では、アドレスバー右側に表示されるアイコンを押下して、インストールすることができます。インストールすると、デスクトップにアイコンが作成されます。</p>
      <figure>
      <img src="figs/12/pwa_02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p><strong>Android版 の Chrome</strong>
      では、ブラウザ右上の3点メニューから「<strong>ホーム画面に追加</strong>」を選択してインストールすることができます。</p>
      <figure>
      <img src="figs/12/pwa_03.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p><strong>iOS の Safari</strong> では、次のようにインストールすることができます。</p>
      <figure>
      <img src="figs/12/pwa_04.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>以下に、PWAを有効化するための具体的な手順を示します。</p>
      <h2 data-number="5.1" id="manifest.json-の作成と配置"><span
      class="header-section-number">5.1</span> manifest.json の作成と配置</h2>
      <p>プロジェクトフォルダの <code>src/app</code> の直下に <code>manifest.json</code>
      を新規作成してください。</p>
      <pre><code>📂 src/
└─ 📂 app/
    └─ manifest.json</code></pre>
      <p>ファイルには以下の内容を貼付けてください。設定 (<code>name</code> や <code>***_color</code>
      など) は、各自のアプリにあわせて変更してください。項目の詳細については<a
      href="https://qiita.com/Coa3/items/c81c8c7984bd5fc4ec69#3-manifestファイルの作成">Next.js14でPWA構築してみた</a>や<a
      href="https://triple-underscore.github.io/appmanifest-ja.html">Web Application Manifest
      (日本語訳)</a>を参照してください。</p>
      <div class="sourceCode" id="cb8" data-caption="src/app/manifest.json"><pre
      class="sourceCode numberSource json numberLines"><code class="sourceCode json"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">{</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Next-Blog-App&quot;</span><span class="fu">,</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="dt">&quot;short_name&quot;</span><span class="fu">:</span> <span class="st">&quot;BlogApp&quot;</span><span class="fu">,</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;&quot;</span><span class="fu">,</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="dt">&quot;start_url&quot;</span><span class="fu">:</span> <span class="st">&quot;/&quot;</span><span class="fu">,</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="dt">&quot;display&quot;</span><span class="fu">:</span> <span class="st">&quot;standalone&quot;</span><span class="fu">,</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>  <span class="dt">&quot;background_color&quot;</span><span class="fu">:</span> <span class="st">&quot;#fff&quot;</span><span class="fu">,</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="dt">&quot;theme_color&quot;</span><span class="fu">:</span> <span class="st">&quot;#fff&quot;</span><span class="fu">,</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="dt">&quot;icons&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="fu">{</span> <span class="dt">&quot;src&quot;</span><span class="fu">:</span> <span class="st">&quot;/android-chrome-192x192.png&quot;</span><span class="fu">,</span> <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;image/png&quot;</span><span class="fu">,</span> <span class="dt">&quot;sizes&quot;</span><span class="fu">:</span> <span class="st">&quot;192x192&quot;</span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>    <span class="fu">{</span> <span class="dt">&quot;src&quot;</span><span class="fu">:</span> <span class="st">&quot;/android-chrome-512x512.png&quot;</span><span class="fu">,</span> <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;image/png&quot;</span><span class="fu">,</span> <span class="dt">&quot;sizes&quot;</span><span class="fu">:</span> <span class="st">&quot;512x512&quot;</span> <span class="fu">}</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="ot">]</span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="fu">}</span></span></code></pre></div>
      <h2 data-number="5.2" id="アイコン用の画像の配置"><span
      class="header-section-number">5.2</span> アイコン用の画像の配置</h2>
      <p>各種OSに対応させるために、次の4つのアイコン用の「画像」を用意します。</p>
      <ul>
      <li><code>favicon.ico</code> (このファイル名にすること)</li>
      <li><code>apple-icon.png</code> (180x180px。このファイル名にすること)</li>
      <li><code>android-chrome-192x192.png</code> (<code>manifest.json</code>
      で指定した名前にすること)</li>
      <li><code>android-chrome-512x512.png</code> ( 〃 )</li>
      </ul>
      <p>これらのファイルは、<a href="https://favicon.io/">https://favicon.io/</a>
      を利用して一括作成することができます。サイトにアクセスして「<strong>Favicon
      Generators</strong>」の「<strong>PNG→ICO</strong>」を選択して、<span class="masked">縦横比 1:1
      の画像 (512x512のPNGを推奨)</span>
      をドラッグアンドドロップして、「Download」のボタンを押下してください。</p>
      <p><code>favicon_io.zip</code>
      というファイルがダウンロードされるので、それを解凍してください。次のようなファイルが得られます。</p>
      <figure>
      <img src="figs/12/pwa_01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p><code>apple-touch-icon.png</code> は <code>apple-icon.png</code>
      にリネームしてください。</p>
      <p>そして、以下のようにプロジェクトフォルダに配置してください。<code>favicon-16x16.png</code>、<code>favicon-32x32.png</code>、<code>site.webmanifest</code>
      については使用しません。</p>
      <pre><code>📂 src/
├─ 📂 public/
│   ├─ android-chrome-192x192.png
│   └─ android-chrome-512x512.png
└─ 📂 app/
    ├─ favicon.ico
    ├─ apple-icon.png
    └─ manifest.json</code></pre>
      <p>あとは、Vercel にデプロイ (GitHubリポジトリにPush) すれば完了です。</p>
      <p>なお、開発モード (<code>npm run dev</code>)
      で起動したときや、ウェブブラウザのシークレットモードやゲストモードを使用しているときには、PWA
      としてインストールできないので注意してください。</p>
      <h2 data-number="5.3" id="アイコンの入手"><span class="header-section-number">5.3</span>
      アイコンの入手</h2>
      <p>アイコンは自作するか、生成AIや<a
      href="https://www.flaticon.com/">FLATICON</a>などを利用して入手してください。</p>
      <figure>
      <img src="figs/12/pwa_05.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h1 data-number="6" id="最終課題-課題3"><span class="header-section-number">6</span> 最終課題
      (課題3)</h1>
      <p><strong><em>最終課題 (課題3)</em></strong> として、Next.js
      をフレームワークとした「<strong>オリジナルのウェブアプリ</strong>」を開発してください。また、Vercel
      に <strong>デプロイ/公開</strong>
      してください。オリジナルアプリは<strong>完全な新規開発</strong>でも、<strong>ここまで開発してきたブログアプリをベースに独自機能やカスタマイズをくわえたもの</strong>でも結構です。後者の場合は、現在のブログアプリのリポジトリをそのまま使用する形でもOKです。</p>
      <div class="note type-tips">
      <p>この「課題」は、ソフトウェア系 (特に<strong>ウェブ系</strong>)
      のインターンシップや就職の「選考」で、<strong>非常に強力な武器
      (自己PRの素材、技術や意欲を証明するもの)</strong> になります。<strong>書類選考</strong> でも
      <strong>面接選考</strong>
      でも使える素材になります。将来を切り開くための準備・投資としても頑張ってみてください。</p>
      </div>
      <p>具体的には以下の内容に取り組んでください。</p>
      <ol type="1">
      <li>GitHub をリモートリポジトリに設定して「オリジナルウェブアプリ」を開発する。</li>
      <li>オリジナルウェブアプリを<a
      href="https://vercel.com/">Vercel</a>にデプロイ・公開する。</li>
      <li>Supabase が停止モードにならないように GitHub Actions を利用して<a
      href="lecture12.html#github-actions-による定期処理">定期的に Ping を飛ばす処理</a>を設定する
      (ログから正常動作することも確認する)。</li>
      <li>2年次に作成した作品置き場としての <strong>ポートフォリオ</strong> (GitHubPagse)
      のなかに、開発したウェブアプリの「<strong>タイトル</strong>」「<strong>概要（スクリーンショット2枚以上）</strong>」「<strong>リポジトリ
      (URL)</strong>」「<strong>公開URL</strong>」を掲載する。
      <ul>
      <li>注意 : <span class="masked">学校の授業の課題として開発した
      (単位取得のために開発した)</span>
      というニュアンスを持った記述は、就活用のポートフォリオとしてはマイナス印象です。</li>
      </ul></li>
      </ol>
      <ul>
      <li><strong><em>評価</em></strong> : GitHubリポジトリの <strong>README</strong>
      の内容を「<strong>5点満点</strong>」、アプリ本体やソースコードを「<strong>5点満点</strong>」で、「<strong>合計10点満点</strong>」で評価します。「7.6点」を標準とします。
      <ul>
      <li>ゼロベースの新規開発に取り組んだ場合は、上記の合計に加点します (10点が上限)。</li>
      <li>「Vercel にデプロイ・公開されていない」「提出上の不備がある
      (提出遅れやURLの記述ミスを含む)」「作品集としてのポートフォリオに記載がない」などは、上記の合計から減点します
      (0点が下限)。</li>
      </ul></li>
      <li><strong><em>提出先</em></strong> : <a
      href="https://forms.office.com/r/Y6zmvsvT8V">Microsoft Forms</a>
      <ul>
      <li>OMUIDによるログインが必要、期間内は再編集可、期限後は回答不可</li>
      </ul></li>
      <li><strong><em>提出期限</em></strong> : <strong>2025年02月19日 (水) 13時</strong>
      (時刻に注意)
      <ul>
      <li>実際の内容評価 (採点) は、早ければ <strong>02月22日 (土)</strong> から開始予定です。</li>
      </ul></li>
      <li>提出された課題は、教員と知能情報コースの学生に公開します。</li>
      </ul>
      <h2 data-number="6.1" id="注意事項"><span class="header-section-number">6.1</span>
      注意事項</h2>
      <ul>
      <li>開発したウェブアプリは、少なくとも <strong>2025年3月31日</strong>
      までは稼働している状態にしてください。</li>
      <li>Supabase
      は7日間アクセスがないと「停止モード」になります。課題評価時に「停止モード」になっていると、適切に評価できません。停止モードにならないるように
      GitHub Action で Ping を飛ばすようにしてください。</li>
      <li>アプリのなかで <strong>ログイン (認証) が必要なページや機能</strong>
      について、実際に動作を見て欲しいものがあれば TeamsChat で認証情報を送ってください。
      <ul>
      <li><span class="masked">ゲストログイン機能
      (IDやパスワードを入力しなくとも、押下するだけでログインできる機能)</span>
      を実装することもありです。</li>
      </ul></li>
      </ul>
      <h2 data-number="6.2" id="readmeの構成.mdについて"><span
      class="header-section-number">6.2</span> READMEの構成.mdについて</h2>
      <p>次のような内容を記載すること推奨します (あくまでも「<strong>例</strong>」です)。</p>
      <p><strong>基本的には情報量が多いほど「高評価」です</strong>。</p>
      <div class="sourceCode" id="cb10" data-caption="README.md"><pre
      class="sourceCode numberSource md numberLines"><code class="sourceCode markdown"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu"># アプリの名前</span></span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="ss">- </span>概要。どのような利用者を想定した、どのようなアプリなのかを記述する。</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="ss">- </span>開発の背景・経緯</span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="ss">  - </span>特に完全オリジナルのアプリ開発の場合は、記載しないともったいない。</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="ss">  - </span>課題発見能力、課題解決能力、人となりなどを見てもらえます。</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="ss">- </span>公開URL</span>
<span id="cb10-8"><a href="#cb10-8"></a></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="fu">## 特徴と機能の説明</span></span>
<span id="cb10-10"><a href="#cb10-10"></a></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="ss">- </span>スクリーンショットや動画 (アニメ) を添えながら基本機能や工夫点を解説する。</span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="ss">- </span>最低でも3個ぐらいは、特徴を箇条書きしましょう。</span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="ss">- </span>この項目の情報量が評価に大きく関係します。</span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="ss">    - </span>特に認証をログインを必要とする画面や機能は、ここで記述しないと評価者に伝わらない。</span>
<span id="cb10-15"><a href="#cb10-15"></a></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="fu">## 使用技術 (技術スタック)</span></span>
<span id="cb10-17"><a href="#cb10-17"></a></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="ss">- </span>使用した言語やフレームワーク</span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="ss">    - </span>少なくとも TypeScript と Next.js、Prisma は書いておくべき。</span>
<span id="cb10-20"><a href="#cb10-20"></a><span class="ss">    - </span>その他、アプリを構成する主要なライブラリなどを記載する。</span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="ss">    - </span>ReReact Hook Form や zod、SWR を使っている場合は明示する。</span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="ss">- </span>開発に使用したツールやウェブサービス</span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="ss">    - </span>VSCode、Supabase、Vercel は書いておくべき。</span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="ss">- </span>システム構成図</span>
<span id="cb10-25"><a href="#cb10-25"></a></span>
<span id="cb10-26"><a href="#cb10-26"></a><span class="fu">## 開発期間・体制</span></span>
<span id="cb10-27"><a href="#cb10-27"></a></span>
<span id="cb10-28"><a href="#cb10-28"></a><span class="ss">- </span>開発体制: 個人開発</span>
<span id="cb10-29"><a href="#cb10-29"></a><span class="ss">- </span>開発期間: 2024.12 ~ 2025.2 (約XXX時間)</span>
<span id="cb10-30"><a href="#cb10-30"></a></span>
<span id="cb10-31"><a href="#cb10-31"></a><span class="fu">## 工夫した点・苦労した点</span></span>
<span id="cb10-32"><a href="#cb10-32"></a></span>
<span id="cb10-33"><a href="#cb10-33"></a><span class="ss">- </span>特に、技術的な目標や挑戦を持って取り組んだ場合は記載すると良いです。</span>
<span id="cb10-34"><a href="#cb10-34"></a></span>
<span id="cb10-35"><a href="#cb10-35"></a><span class="fu">## 既知の課題と今後の展望</span></span>
<span id="cb10-36"><a href="#cb10-36"></a></span>
<span id="cb10-37"><a href="#cb10-37"></a><span class="ss">- </span>改良・改善したいこと。</span>
<span id="cb10-38"><a href="#cb10-38"></a><span class="ss">- </span>機能拡張のロードマップなど。</span>
<span id="cb10-39"><a href="#cb10-39"></a></span>
<span id="cb10-40"><a href="#cb10-40"></a><span class="fu">## 連絡先 (任意)</span></span>
<span id="cb10-41"><a href="#cb10-41"></a></span>
<span id="cb10-42"><a href="#cb10-42"></a><span class="ss">- </span>作品集としてのポートフォリオのURL</span>
<span id="cb10-43"><a href="#cb10-43"></a><span class="ss">- </span>SNSアカウント</span>
<span id="cb10-44"><a href="#cb10-44"></a><span class="ss">- </span>所属など</span></code></pre></div>
      <ul>
      <li>システム構成図の例
      <ul>
      <li><a href="https://qiita.com/matorel/items/c6dc3236c3c80bc7627e#システム構成">例1</a></li>
      <li><a href="https://www.arfes.jp/article/lb1nprwauz0f#システム構成図">例2</a></li>
      <li><a
      href="https://qiita.com/Nag729/items/16995edd91e8c11323db#nextjs--prisma-で作ったアプリケーションの構成">例3</a></li>
      </ul></li>
      </ul>
      <div class="note type-senior">
      <p><strong>README については、生成AIにチェックしてもらうことをお勧めします。</strong></p>
      <div class="sourceCode" id="cb11" data-caption="プロンプト例 (READMEの添削)"><pre
      class="sourceCode numberSource md numberLines"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1"></a>以下の私のポートフォリオサイトの README.md を、新卒採用向けに添削してください：</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a>目的：</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="ss">- </span>技術力と学習意欲が伝わる内容にしたい</span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="ss">- </span>採用担当者が読みやすい文章にしたい</span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="ss">- </span>自分の特徴や強みが伝わるようにしたい</span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a>依頼事項：</span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="ss">1. </span>採用担当者目線で不足している情報はありますか？</span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="ss">2. </span>より分かりやすい表現や構成はありますか？</span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="ss">3. </span>技術スタックの書き方は適切ですか？</span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="ss">4. </span>コードの品質や開発プロセスをより効果的にアピールするには？</span>
<span id="cb11-13"><a href="#cb11-13"></a></span>
<span id="cb11-14"><a href="#cb11-14"></a>添削の際は以下の点も意識して修正をお願いします：</span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="ss">- </span>文章の簡潔さと分かりやすさ</span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="ss">- </span>技術的な深さと学習姿勢の表現</span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="ss">- </span>実装の工夫点や課題解決プロセスの見せ方</span>
<span id="cb11-18"><a href="#cb11-18"></a></span>
<span id="cb11-19"><a href="#cb11-19"></a>現在のREADME：</span>
<span id="cb11-20"><a href="#cb11-20"></a></span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="in">```</span></span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="in">現在のREADMEの内容をここに貼り付け</span></span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="in">```</span></span></code></pre></div>
      </div>
      <!-- ---------------------------------------- -->
    </main>

    <footer class="markdown-body">
      <p><a href="https://takeshiwada1980.github.io/Programming3-2024/">講義資料のIndexに移動</a></p>
    </footer>

    <script>
      window.onload = function () {
        // ナビゲーション関連
        let openBtn = document.getElementsByClassName("openbtn")[0];
        let navPnl = document.getElementById("g-nav");
        openBtn.onclick = () => {
          openBtn.classList.toggle("active");
          navPnl.classList.toggle("panelactive");
        };

        let items = navPnl.getElementsByTagName("a");
        Array.from(items).forEach((item) => {
          item.onclick = () => {
            openBtn.classList.toggle("active");
            navPnl.classList.toggle("panelactive");
          };
        });

        // マスク処理
        let maskedSpans = document.getElementsByClassName("masked");
        Array.from(maskedSpans).forEach((span) => {
          span.onclick = () => {
            span.classList.toggle("open");
          };
        });

        // data-startfrom 属性の行番号カウンタのリセット
        document.querySelectorAll("div.sourceCode").forEach(function (div) {
          var startFrom = div.getAttribute("data-startfrom");
          if (startFrom != null) {
            div.style.counterReset = "pg-line " + (startFrom - 1);
          }
        });

        // 画像にリンクを付与
        // let images = document.querySelectorAll("figure img");
        // Array.from(images).forEach((img) => {
        //   img.onclick = () => {
        //     location.href = img.getAttribute("src");
        //   };
        // });
      };
    </script>
  </body>
</html>
